<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Jianrui Zhang" />

<meta name="date" content="2020-01-03" />

<title>All Homework</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' || rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#header {
text-align: center;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; }  code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">All Homework</h1>
<h4 class="author">Jianrui Zhang</h4>
<h4 class="date">2020-01-03</h4>



<div id="homework-1" class="section level1">
<h1>Homework 1</h1>
<div id="question" class="section level2">
<h2>Question</h2>
<p>Use knitr to produce at least 3 examples (texts, ﬁgures, tables).</p>
<hr />
</div>
<div id="answer" class="section level2">
<h2>Answer</h2>
<div id="example-1-text" class="section level3">
<h3>Example 1: text</h3>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1">ad_data =<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;advertising.csv&quot;</span>)  <span class="co">##Import the data</span></a>
<a class="sourceLine" id="cb1-2" title="2">lg =<span class="st"> </span><span class="kw">lm</span>(sales<span class="op">~</span>TV,<span class="dt">data =</span> ad_data)  <span class="co">## Linear Regression</span></a>
<a class="sourceLine" id="cb1-3" title="3"><span class="kw">summary</span>(lg)<span class="op">$</span>coef</a></code></pre></div>
<pre><code>##               Estimate  Std. Error  t value    Pr(&gt;|t|)
## (Intercept) 7.03259355 0.457842940 15.36028 1.40630e-35
## TV          0.04753664 0.002690607 17.66763 1.46739e-42</code></pre>
<p>The <span class="math inline">\(R^2\)</span> is 0.6118751</p>
<hr />
</div>
<div id="example-2-table" class="section level3">
<h3>Example 2: table</h3>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1">knitr<span class="op">::</span><span class="kw">kable</span>(<span class="kw">head</span>(ad_data))    <span class="co">##Transform to .Rmd</span></a></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">X</th>
<th align="right">TV</th>
<th align="right">radio</th>
<th align="right">newspaper</th>
<th align="right">sales</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="right">230.1</td>
<td align="right">37.8</td>
<td align="right">69.2</td>
<td align="right">22.1</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">44.5</td>
<td align="right">39.3</td>
<td align="right">45.1</td>
<td align="right">10.4</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="right">17.2</td>
<td align="right">45.9</td>
<td align="right">69.3</td>
<td align="right">9.3</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="right">151.5</td>
<td align="right">41.3</td>
<td align="right">58.5</td>
<td align="right">18.5</td>
</tr>
<tr class="odd">
<td align="right">5</td>
<td align="right">180.8</td>
<td align="right">10.8</td>
<td align="right">58.4</td>
<td align="right">12.9</td>
</tr>
<tr class="even">
<td align="right">6</td>
<td align="right">8.7</td>
<td align="right">48.9</td>
<td align="right">75.0</td>
<td align="right">7.2</td>
</tr>
</tbody>
</table>
<hr />
</div>
<div id="example-3-figure" class="section level3">
<h3>Example 3: figure</h3>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1"><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))   </a>
<a class="sourceLine" id="cb4-2" title="2"><span class="kw">plot</span>(lg)            </a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
<hr />
</div>
</div>
</div>
<div id="homework-2" class="section level1">
<h1>Homework 2</h1>
<div id="question-1" class="section level2">
<h2>Question</h2>
<ul>
<li>Exercises 3.4, 3.11, and 3.18 (pages 94-96, Statistical Computating with R).</li>
</ul>
<hr />
</div>
<div id="answer-1" class="section level2">
<h2>Answer</h2>
<div id="exercise-3.4" class="section level3">
<h3>Exercise 3.4</h3>
<p>The Rayleigh density is <span class="math display">\[
f(x)= \frac{x}{\sigma^2} e^{−x^2/(2\sigma^2)},x\ge0,σ&gt;0. 
\]</span> Develop an algorithm to generate random samples from a Rayleigh(<span class="math inline">\(\sigma\)</span>) distribution. Generate Rayleigh(<span class="math inline">\(\sigma\)</span>) samples for several choices of <span class="math inline">\(\sigma&gt;0\)</span> and check that the mode of the generated samples is close to the theoretical mode <span class="math inline">\(\sigma\)</span> (check the histogram).</p>
<p><span class="math inline">\(Sol.\)</span> To generate random samples from a Rayleigh(<span class="math inline">\(\sigma\)</span>) distribution, we apply the inverse transfrom method. Due to the probability density function of a Rayleigh(<span class="math inline">\(\sigma\)</span>) distribution, we obtain that its cumulative density function is <span class="math display">\[
F_X (x) = 1- e^{−x^2/(2\sigma^2)},x\ge0,σ&gt;0.
\]</span> If <span class="math inline">\(u\in (0,1)\)</span>, then <span class="math display">\[
F_X^{-1}(u) = \sigma\sqrt{-2\log (1-u)}.
\]</span> Notice that if <span class="math inline">\(U\sim U(0,1)\)</span>, then <span class="math inline">\(V=1-U \sim U(0,1)\)</span>. Hence applying the inverse transform method, we obtain <span class="math inline">\(-\sigma\sqrt{2\log V}\)</span> has the same distribution as <span class="math inline">\(X\)</span>.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1">ge_rayleigh =<span class="st"> </span><span class="cf">function</span>(n, sigma){ </a>
<a class="sourceLine" id="cb5-2" title="2">  <span class="co">#generate n random samples from Rayleigh(sigma)</span></a>
<a class="sourceLine" id="cb5-3" title="3">  </a>
<a class="sourceLine" id="cb5-4" title="4">  V =<span class="st"> </span><span class="kw">runif</span>(n)</a>
<a class="sourceLine" id="cb5-5" title="5">  <span class="kw">return</span>(sigma <span class="op">*</span><span class="st"> </span><span class="kw">sqrt</span>(<span class="op">-</span><span class="dv">2</span><span class="op">*</span><span class="kw">log</span>(V)) )</a>
<a class="sourceLine" id="cb5-6" title="6">}</a></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1"><span class="kw">set.seed</span>(<span class="dv">12</span>)</a>
<a class="sourceLine" id="cb6-2" title="2"></a>
<a class="sourceLine" id="cb6-3" title="3">hist_rayleigh =<span class="st"> </span><span class="cf">function</span>(n, sigma, y){</a>
<a class="sourceLine" id="cb6-4" title="4">  <span class="co"># Draw a histogram to check</span></a>
<a class="sourceLine" id="cb6-5" title="5">  <span class="co"># y is a sequence</span></a>
<a class="sourceLine" id="cb6-6" title="6">  </a>
<a class="sourceLine" id="cb6-7" title="7">  x =<span class="st"> </span><span class="kw">ge_rayleigh</span>(n, sigma)                      <span class="co"># Generate the random sample</span></a>
<a class="sourceLine" id="cb6-8" title="8">  </a>
<a class="sourceLine" id="cb6-9" title="9">  <span class="kw">hist</span>(x, <span class="dt">prob =</span> T,<span class="dt">main=</span><span class="st">&quot;Rayleigh Distribution&quot;</span>)</a>
<a class="sourceLine" id="cb6-10" title="10">  </a>
<a class="sourceLine" id="cb6-11" title="11">  <span class="kw">lines</span>(y, y<span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>y<span class="op">^</span><span class="dv">2</span><span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>sigma<span class="op">^</span><span class="dv">2</span>))<span class="op">/</span>(sigma<span class="op">^</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb6-12" title="12">}</a>
<a class="sourceLine" id="cb6-13" title="13"></a>
<a class="sourceLine" id="cb6-14" title="14"><span class="kw">hist_rayleigh</span>(<span class="dv">100000</span>,<span class="dv">1</span>,<span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">5</span>,<span class="fl">0.05</span>))         <span class="co"># Histogram when sigma = 1</span></a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1"><span class="kw">hist_rayleigh</span>(<span class="dv">100000</span>,<span class="dv">3</span>,<span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">15</span>,<span class="fl">0.15</span>))        <span class="co"># Histogram when sigma = 3</span></a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1"><span class="kw">hist_rayleigh</span>(<span class="dv">100000</span>,<span class="fl">0.2</span>,<span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">0.01</span>))       <span class="co"># Histogram when sigma = 0.2</span></a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<hr />
</div>
<div id="exercise-3.11" class="section level3">
<h3>Exercise 3.11</h3>
<p>Generate a random sample of size 1000 from a normal location mixture. The components of the mixture have <span class="math inline">\(N(0,1)\)</span> and <span class="math inline">\(N(3,1)\)</span> distributions with mixing probabilities <span class="math inline">\(p_1\)</span> and <span class="math inline">\(p_2 =1−p_1\)</span>. Graph the histogram of the sample with density superimposed, for <span class="math inline">\(p_1 =0 .75\)</span>. Repeat with different values for <span class="math inline">\(p_1\)</span> and observe whether the empirical distribution of the mixture appears to be bimodal. Make a conjecture about the values of <span class="math inline">\(p_1\)</span> that produce bimodal mixtures.</p>
<p><span class="math inline">\(Sol.\)</span> To generate the random sample, we applied the first algorithm on <span class="math inline">\(\textit{Statistical Computing with R}\)</span>, Page 78. From the 9 graphs, we can guess that it is likely to produce bimodal mixtures when <span class="math inline">\(p_1\)</span> is near <span class="math inline">\(0.5\)</span>.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" title="1"><span class="kw">set.seed</span>(<span class="dv">27</span>)</a>
<a class="sourceLine" id="cb9-2" title="2"></a>
<a class="sourceLine" id="cb9-3" title="3">ge_NLM =<span class="st"> </span><span class="cf">function</span>(n, p1){</a>
<a class="sourceLine" id="cb9-4" title="4">    <span class="co"># Generate a random smaple of size n from a normal location mixture, with p_1 = p1.  </span></a>
<a class="sourceLine" id="cb9-5" title="5">    <span class="co"># I applied the (first) algorithm on Statistical Computing with R, Page 78.</span></a>
<a class="sourceLine" id="cb9-6" title="6">  </a>
<a class="sourceLine" id="cb9-7" title="7">    U =<span class="st"> </span><span class="kw">runif</span>(n)                                     </a>
<a class="sourceLine" id="cb9-8" title="8">    </a>
<a class="sourceLine" id="cb9-9" title="9">    X =<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>,n)</a>
<a class="sourceLine" id="cb9-10" title="10">    </a>
<a class="sourceLine" id="cb9-11" title="11">    <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){</a>
<a class="sourceLine" id="cb9-12" title="12">      </a>
<a class="sourceLine" id="cb9-13" title="13">      <span class="cf">if</span>(U[i] <span class="op">&lt;=</span><span class="st"> </span>p1){</a>
<a class="sourceLine" id="cb9-14" title="14">        </a>
<a class="sourceLine" id="cb9-15" title="15">        X[i] =<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>)              <span class="co"># Generate X from N(0,1)</span></a>
<a class="sourceLine" id="cb9-16" title="16">      </a>
<a class="sourceLine" id="cb9-17" title="17">      }</a>
<a class="sourceLine" id="cb9-18" title="18">      <span class="cf">else</span>{</a>
<a class="sourceLine" id="cb9-19" title="19">        </a>
<a class="sourceLine" id="cb9-20" title="20">        X[i] =<span class="st"> </span><span class="dv">3</span> <span class="op">+</span><span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>)          <span class="co"># Generate X from N(3,1)</span></a>
<a class="sourceLine" id="cb9-21" title="21">      </a>
<a class="sourceLine" id="cb9-22" title="22">      }</a>
<a class="sourceLine" id="cb9-23" title="23">    }</a>
<a class="sourceLine" id="cb9-24" title="24">    <span class="kw">return</span>(X)</a>
<a class="sourceLine" id="cb9-25" title="25">}</a>
<a class="sourceLine" id="cb9-26" title="26"></a>
<a class="sourceLine" id="cb9-27" title="27">hist_NLM =<span class="st"> </span><span class="cf">function</span>(n, p1){</a>
<a class="sourceLine" id="cb9-28" title="28">  <span class="co"># Generate the sample and graph the histogram</span></a>
<a class="sourceLine" id="cb9-29" title="29">  </a>
<a class="sourceLine" id="cb9-30" title="30">  X =<span class="st"> </span><span class="kw">ge_NLM</span>(n, p1)</a>
<a class="sourceLine" id="cb9-31" title="31">  </a>
<a class="sourceLine" id="cb9-32" title="32">  <span class="kw">hist</span>(X, <span class="dt">probability =</span> T, <span class="dt">main =</span> <span class="st">&quot;Normal Location Mixture&quot;</span>)             <span class="co"># Graph the histogram    </span></a>
<a class="sourceLine" id="cb9-33" title="33">  </a>
<a class="sourceLine" id="cb9-34" title="34">  y =<span class="st"> </span><span class="kw">seq</span>(<span class="op">-</span><span class="dv">4</span>,<span class="dv">6</span>,<span class="fl">0.1</span>)</a>
<a class="sourceLine" id="cb9-35" title="35">  </a>
<a class="sourceLine" id="cb9-36" title="36">  <span class="kw">lines</span>(y, (p1<span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span><span class="op">/</span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span>y<span class="op">^</span><span class="dv">2</span>) <span class="op">+</span><span class="st"> </span>(<span class="dv">1</span><span class="op">-</span>p1)<span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span><span class="op">/</span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span>(y<span class="dv">-3</span>)<span class="op">^</span><span class="dv">2</span>))<span class="op">/</span><span class="kw">sqrt</span>(<span class="dv">2</span><span class="op">*</span>pi))      </a>
<a class="sourceLine" id="cb9-37" title="37">  <span class="co"># graph the probability density function</span></a>
<a class="sourceLine" id="cb9-38" title="38">  </a>
<a class="sourceLine" id="cb9-39" title="39">}</a>
<a class="sourceLine" id="cb9-40" title="40"></a>
<a class="sourceLine" id="cb9-41" title="41"><span class="kw">hist_NLM</span>(<span class="dv">1000</span>, <span class="fl">0.75</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAxlBMVEUAAAAAADoAAGYAOjoAOmYAOpAAZmYAZpAAZrY6AAA6ADo6OgA6Ojo6OmY6ZmY6ZpA6ZrY6kLY6kNtmAABmADpmOgBmOjpmZgBmkJBmkLZmkNtmtrZmtttmtv+QOgCQZgCQZjqQkDqQkLaQtpCQttuQ27aQ29uQ2/+2ZgC2Zjq2ZpC2kDq2kGa225C227a229u22/+2/7a2/9u2///bkDrbkGbbtmbbtpDb27bb29vb/7bb////tmb/25D/27b//7b//9v///9tn8k/AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAK9UlEQVR4nO2d6WLjthWFYddu7U7TSaROV1tJm6RWt8TtsJk0Q4/F93+pYiElkARwCBIkYfmcH7Zo8d4LfrpYRYOiooISaxcgdxEQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQ0AhAeyHu5a/nrbiJtj3sxPVH87IQFw8xln9/b1sHClefo17dOEyUowiNA6RiLgvo07vLwYC0X1k8JyDtKELjAKkUWhbQXgy7LlU4sZEvnm41oNGOGo0EJIM0gD78Voif/UFdtbzkr9+Jy+/kGx/eiIu76r+34kpD+PBO2nz2EAB08lJVP7yRr+9advq6L/9TW7dC/vVvoo5SF+5X+qRCnDJIwjL5d/neOHpvMMlL2ByL/VgdpKeLzzspOhKQdFwD0gURpzKJ65+25k/ijSlMVZXmWALxAbK8GP86DU52LUC9kOLkSp7461sd6PLPpypWKHeFSnwnIOPt2ZT7qp1gowBd/k76N4Dkh9MUQP28fqz+pwJtqh9krDvzhizkLz6qMzc+QLYXSeWLj5+2MoJlZ2qGse6EvHqsXzeA7nby6On2+h8nQPLnxdfarK5iHUCq2Opvj3W0yYD+Jd0YQHWV1r+KY/cmS2J+HuP9+M83nTbTBmR7Ma+Lt9/bdjagfkgZ5eboSdzv5Vml2BRWQN0i6XhOQHWxN7pY7TZqHCCZohffbq0L1ldbHPuPm+anAXT4ylQEHyDbi93tnOwsQI6QVn+hAJW6gPc2IF21NqfPotMGqYJohq3qOgWQ9PZzVaqmaKX6FHyAZCHF1V9+3HoB2V7kGc3FWnYWIEfIFqCLBxn0T9uLh9IGVN7W4WxA5uOrC1I3eIkAtTqJCmSQKcezH5Angyy7iAzSLoSuZaeA9Z9CgOTBveNqxwKqx2GdBsENqGwaCm8j3W+Dys++se38bZADUD2ItgEVuk/dHEMZu1JYgDzjurGAdAr1ejFvBl1//LTrtUGNNt1e7HOVJuLesjO+Xb2YC1DZOL2xTOToQ51b1D/lCcr1qdjK9K76tO2MvEcDUinUGwf52yBXI30C5BoH3dh2+pqd46AeIFm4J93gnACpXv7BZJRx9P7YIluA6nFQZ3w/GlAdrx7W/tFccqAXu/qmMEMbJyDLSz2SVq9PdnqUe/W9PZK2QnYB6TGzBahsapesstqRHO/IMfrb7+xeTE7TvpLY3j62r5bLHUAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEB5AhLeg8X1AgCtW8YsAYng4bIiIKCsAYm2Vi1LVhLO3wTUSHRfEFBbBAR0hoDSNqQ9QObFSwaU1h0BDXUiWn8ioJ4PAgI+CAj4IKCeuW9yQUCWuSuD1EsC6iUKAbnMCQiYExAwJ6CwuWgfet5ZTi8FkHxNQAQ0xJyAgDkBhc1F+9A+IKAzBpRqyfVsAaVyFwK0dhs0at9Iv7ux5vkCMvvVbPxnxrobZR5CsjqgKgGjcwdkEMVtdhp0F2ueOSC1fdV9ddh5ttx93m6qZo+rIe5GlCYIaBVCp6BqCy9DpvRcvwZUmK2SXTvqVQka6cDhyoCet3D3YgWoRlN4kuycAf3G8PGlT2UAPd3eh856BYCKMKA1M2iVZrqOuT9NFvzdvNlo8KZqmmu/u4mlcR+uCuiUQWE9b82WjT6K0y6hW4myApSDOwRoDUIEBGRCyjbludmJfsI4+nwBZeLupQM6Jpk/z2YGtAIhe6qhn6wQevTJYYfq3zkD2qsHdNxU+9Cy2WEHFtUmXUCvH88KkBoil3IuH5hqVJU+w+UlyZp0/oD2apf49XqxvAHJuvW8VQ9lmLQyPTeg5Qm11oPUExemrdyfM6Ao+SrilPL3xzkvGNAc7nIH1DykYbVGGgJa5f8PrUZ6Epmeu1G2OIOOf1sckHcNzBbMsgnFdvTiLkCdX7OrNQ5CKpqFMu+K2RkDGtDBH3ZHLDOsSecOyDeLsGQl2QzfagwF1GmL5pZVxeCC2awZ5OrEswI0REWTZDO0QcMBLTsgiovTpJl30eisAennWu6n3SG0CCDTXC00bLQa6YuHQs3mV7o/KBpQorhIVje/0U3vSutBzpbXC6E36F4AkOrDFaDwiuJgd+MMhwKqWpVqmSrWZNAePbB8mLvBBqGmJJAlzam10XyIum1QAYeLTi+jG8vg8DhUjdrx+hPdVGr3Yr1nRE5wF2UwAlDvaJ4kSux0TUDz5NC5AJptVNSZi01qoavRgNrTLI+3AUczzPQbX3vTOBcT77VfGdAME9naV9k0zvVNmhPdxRokA5S+MTK+rNWy4HfzA91FG2QPyJqBLTzVSA3IMU+bpgYQXCuMcRdr0P78fd4GHiUeMxIQUA6A2vXD623oUdrbhQkIqAEE7z6McRdpkBhQ2klZBlONdvvh90ZAqQDNMtVYyx0BYYMZACW8qvUBtTuggLeYo3SXRUBAaTxNWZOeBVA6QqtnULuDDnmLO0p1YQQEtDqgkPmkbj7RlREQUJyb5DdxBveimDhQTNT/xJyc/ibOOQGlIRTjJP0teN0BS7KRdLqvyWKM09/EOReg9ovFACXPoN6A7oUDSn0TZ3+4khpQgv4szjjFTZyh9iE5oOljxuXHQe38nxvQ5HnZeoBc7cMMgHodQaSWHygK1y+3eRJAE5fPlh8omprVziOPeRpA0wgt3823m81FAE1BtPxAsV3cZTJowrh66QzqlnCZDGoij+j00wwUOx9Pdy6Ul2YEhAeK56fE46DzEwEBjQQ07Ua9l6QlMmjdNrmnyMLPw2RwjGD8sYajnU4/fZReEaBxG6C8HkB4shod46wADZhqRMc4K0Bj74V9NYCYQUj4W43oGOcFaORk9RUBeoUiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgJaCJBvZzS9yO1eOin922EFrILR1N4tIvJ5u8sAKj0LJIedZFA4i6z2oyndhAJWwWjyHflG5HMfFgGk9/h0vWE243F9TWtWL91b0fitwtFqp3HfCi8CqLj+MrTE5koUAMFjBaI9/TJ+C7slAMlyBXdndO2mb64l9N2Abw/+QLTy8t/b2Gc1LwBIJXYIkHOB2+SHN0v8y+KhaIX6xjPy2SoLAAL7e5beNjoEyG0FohUXKC37mh+Qrix+QJ5MAFXM+7VKMJpp0uK2aZsVkH46e1HfdXLveM+/7V64kfZv1ueJZmR4xzXVKw8UvVvHhrp5vxWIZr4azq2KaXmK/HTr7VICA8WAVTCaaaCs74eHaF1AdYVwcii8U42QVShapecv+XXzL1sEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQHkDero137KPe35wEuUNqL5RCt7OMaMyB6Rv1Yy8qzCtcgekbvtedbur3AHJ6vX7aY9+najsAU1+ePBEZQ/osJv2UMGpyh7Q/vqnuP8+SazcAZVyBBS310xiZQ7o6VZlz95/v+bsyhvQYafbn+ftepvHZg1INtCmh/f+Z8b8yhpQDiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiIKD/A3T0HX44Z5xMAAAAAElFTkSuQmCC" /><!-- --></p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" title="1"><span class="cf">for</span>(p <span class="cf">in</span> <span class="kw">seq</span>(<span class="fl">0.1</span>,<span class="fl">0.9</span>,<span class="fl">0.1</span>)){</a>
<a class="sourceLine" id="cb10-2" title="2">  <span class="kw">hist_NLM</span>(<span class="dv">1000</span>,p)                       <span class="co"># Repeat with different values</span></a>
<a class="sourceLine" id="cb10-3" title="3">}</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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xN0VrhiD3FUk7PJ9FpSa2y+9gJ5/Gb+FXUVA7k3zVcHxjQCw7T43449B7fW/N7Hvaq4HyLOOrWoGqh9oJVw0ID+gRtzxjHy3SjVALYjRGJDPghDeR7S5CqupumoB8n77QU0M3UmRRgAg6SFum7bSgLoXtPt31wsJ0nB/vqZ7usVz9eoriAvVdWoQ2CEWd/PIQi9/DVK3hhfYxJ5X4NuHA0VooRMYSYswpd0fDlEVQF3t9xBowFQDW1BCU402aMKiiyarQAQIiAABESAgAgREgIAIEBABAiJAQAQIiAABESAgAgREgIAIEBABAiJAQAQIiAABESAgAgREgIAIEBABAiJAQAQIiAABLRvQ80rda098f3CKlg2oe2oq9NmOElo4IPncZuRThXm1dEDise9Zt7taOiDevH6f9urXRC0eUPLLgxO1eED7bdpLBVO1eEC725/i/vsks5YOqOUjoOi9ZnJq4YCeV6L27ODDm+W0bED7rYw/L5v5No9dNCAeoFUPj/5No6AWDWgJIkBABAiIAAERICACBESAgAgQEAECIkBABAiIAAERICACBESAgAgQEAECIkBABAiIAAERICACBESAgAgQ0P8BP+0fpmwy14sAAAAASUVORK5CYII=" /><!-- --><img src="data:image/png;base64,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fO5DX3kAyU09bV+qHXjMc7Nq0NK6A40rqIdrZT1sVjgPoOLuc7QAxJxMPAjYgnq4fv1t+FP4sgDiEXFuxyhk3kJf3QLYHsO1+77TdXnz723oQxxzABIpGQGyjGqrxOFMIs4BcbfrQsx4em293ioHILihp7hJexkNANmCerguVh7ps6MMgGQ2cQOyJgKcxZwTKsC1KtvCtmlLC0g+jr2ol5kYolE/rt2+1x4spN3b9DlcCynwYUX1FA1Fx36xoJp3BfVwraaGJ89iUg5Ar2tHInA3FJ1BPVyLIkqbH/bRBIDqfGChULi6Gu6g2LXoyMygml+UCBAQAQIiQEAECIgAAREgIAIERICACBAQAQIiQEAECIgAAREgIAIERICACBAQAQIiQEAECIgAAREgIAIERICACBAQAQKaN6DXtZpn91nUkUnzBlQvl/Ja1JFJMwckF2wGripMq7kDEsu+J93uau6AePb6c9yjXyM1e0Do4cG5NXtAx13cQwVjNXtA+7tfwv59klhzB1TyFhDYayavZg7odS1Sz969ajOr5g3ouJPlz2E73eaxswbEC2hVwzv/n5FXswY0BxEgIAIERICACBAQAQIiQEAECIgAAREgIAIERICACBAQAQIiQEAECIgAAREgIAIERICACBAQAQIiQEAECOj/Blzd5tV4jGgAAAAASUVORK5CYII=" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAxlBMVEUAAAAAADoAAGYAOjoAOmYAOpAAZmYAZpAAZrY6AAA6ADo6OgA6Ojo6OmY6ZmY6ZpA6ZrY6kLY6kNtmAABmADpmOgBmOjpmZgBmkJBmkLZmkNtmtrZmtttmtv+QOgCQZgCQZjqQkDqQkLaQtpCQttuQ27aQ29uQ2/+2ZgC2Zjq2ZpC2kDq2kGa225C227a229u22/+2/7a2/9u2///bkDrbkGbbtmbbtpDb27bb29vb/7bb////tmb/25D/27b//7b//9v///9tn8k/AAAACXBIWXMAAA7DAAAOwwHHb6hkAAALDElEQVR4nO2de2PbthXFac/erGVdWmnZ01a7tZ21V+stXNM1VCx9/y81PEgRJAEcAuDL9Dl/OBQFXIA/ARcXIANmZ8qrbO4KLF0EBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBBQB6JBlD+Kf5112F5z3tM9uP+rDPLt6DMn59/dmbk/lyjTy6M6SRRoKUBwgWea0gD69u+4NSNkV1bMCUoYCFAdINqFpAR2yftclK5dtxcFxowBFG6oUCUgUUgH68Nss+9kf5FWLS/76XXb9nfjiw5vs6v783012oyB8eCfyfPboAVRbOZ9/eCOO7xv51HVf/6fM3Sjyr3/LylLKyv1KJcqzugUJWLr9Xb/Xht5rTOIStpdqP51PwtLV560mGglIGC4BqYpkdZ2y2592+lT2RlfmfC70ZwHEBciwou2rZlDnawDqFJnVpkTCX29UQdd/rrtYLs3lsuFbAWlrz7reN80GFgXo+nfCvgYkfpyqAvLv7dP5f7Kg7fkHUda9/kJU8hcfZcqtC5BpRVD54uOnnSjByKd7hs7dKvLmqTyuAN3vxafj5vYfNSDx9+prla3sYi1Astry3FNZWjKgfwkzGlDZpdU/+WV4EzXRfy/l/fjPNy2faQIyrejj/O33Zj4TULdIUcrdxVL2cBCpimybGwUqj6TKswIqq71V1Wr6qDhAoolefbszLlhdbX4ZP+6qvxrQ6SvdEVyATCvmsFPnMwBZijTGCwmoUBV8MAGprrWtf4uWD5IVUQwb3TUFkLD2c1mrqmqF/BVcgEQls5u//LhzAjKtiBTVxRr5DECWIhuArh5FoX/aXT0WJqBiUxZnAtI/X1mR0uENBKgxSJxBC9L1eHYDcrQgI19AC1ImMtXL6gLLUz5A4sOD5WpjAZVxWMsh2AEVlaNwOumuDyo++8bM5/ZBFkBlEG0CytWYur0UpfMVmQHIEdfFAlJNqDOKOVvQ7cdP+44PqrRtj2Kfy2aSPRj5tG3bKGYDVFRG74wsIvqQafPyr0ggTdfVllnvz592rcg7GpBsQp04yO2DbE66BmSLg+7MfOqarXFQB5Co3FE5nBqQHOUfdYvSht5fPLIBqIyDWvF9NKCyvDKs/aO+ZM8odvNNrkMbKyDDShlJy+M6n4pyb743I2mjyDYgFTMbgIqqd4kuqwyJeEfE6G+/M0cxMU37SmB7+9S8Wi53ABEQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAS0AUOb5NL/mr0+7BvPXqKH5q/MqAF2epgs318mxSkAJ5i45so4GrVmsFgSofUBAzQydIwJqZiAgkIGAmgl9Pjkbo2qRmg1QJz0B2RISkD9h1jljHBMQAcGEBORPmHXOmB8IiIBQQjcg+YmACAglJCB/Qt9iNAF1EhNQJ6EPkPhIQK8IUPg68isDFG6u62MIqJ3QD+j8yu9qEBBOSED+hB0g0bZG1aUWUftGus3hhC8NkN6vZutOKRnKr/UGPNgcKvflATojRgpQrvdxtW331THnKxfzWIYTalci97QPCahEkzs2nV05INl7Hs6nvePqJaDjRgEqHBDXDEhu4aXJuK5+6ha0CC9kjGJw92K9C9rduXLXPnO9y3WfWRqg32g+ruZTptrp/eRcnvwVAMrD9qN2mQtPuGxAh3rBwhsK9TQXk9DmlBZAqNOCBjIXnnDpgKY1ZxnCVwDoeVd3xMQ46KUBEsP25eo9Tvq0Rx58YEALIBRWg9MezPhfOyARAVlnqcGL9n0BzU/InGqoNyugV5/0NQeSvUBAB/mCjrvzIWnZbMWA5CxUdiD/VKO3OZSsL6DZCTUAHeQu8b0AuVKtGJDoW887+VKGCbqYNcJxrX/MTKixHiTfuJC2cj8CoJkJzTLVWC+g6j0FaXc17BGge4lxVkJ14fDi5Yp+uRbiXDEbFNAi/gui4aTh8HXaX7AkrUmHtqBZ3bUxzMOVMuNuWMpdDUcAGApoojbViIOABmpB4YCqkMimHgUm6VJAnwE+r6aqST4oHlD1yXTfYxOq7Tsm6g1Vi0bOGW2P6roCZB+gBtQWuJEbkdHF8IJZgDmUJBCQwpBVB9DWgJo+UIwDdPFAtiRjEno5gDx5JgKk3mt5SLot1qOqzmuKAjT+oGY46avHXM7mR75xOCyg9sGIgGSQI6ObsW89v1hAMlCUgKJWFAOa+DiAxvNGnRZ0SFq1hxV0/9RpgEYb8ds+KO8RLvYy1zqPvWkiIFeAnqrmKNZ5R2SCOfv50VpQGVZ7axejieIgAgLmpgA0ztS1NRdLu6+KAXVAebIuC9BBO+c87QGzeQGdx3hor7RYVM65fA460ZzrfCdu8WVdEiBjtWyce/PTABpjbUhbNGZg40w1Xj4guBwfYs51vhP4erNGABqti60H0OCEpgTUmRj4sxIQyBrXxYYmVAGCD/iGmLOf78wLQNZIHzTR3GBgcwQEzHUqPuIoNuwlERDQCgENe02TAepMm2DWNQGCi/aTARr8TtkaWxAIuMI0FaD2F+POxbxzmjCtE5DxxUsBhBMOCshyEKm1ArK0pTiF5Y99TrrHPgurABT9nPQMgCz+Okoh+aOfcrUsQqwSUOxz0p15hjXh0IAsMVGMJmhBme38BICGmXcE+qCI56Tt1ZwCkP2nCVRY/pjnpGcEJAeHRcZBPaaM0wCyjZ+BGgdQ/dk1lkwFaJmB4iVIcwf80wFKJDRKoNhtNnO2oDREowzz2i93YxJvuSN2sRREowSKWadOc/ug+JXFcVoQXv6Z0AelrcEOEyhaxvXlakRAOFBcnwaOg9YnAgKKBJT2oN5L0kQtaF633FRgzccBElEMTjKIkdArJqBBk/fYACW6mDUAwpPVhGJWAKjHVCOhmBUASngW9nUAYgtCwnc1EopZA6D4yeprAfQKRUBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQENA0gtZbtWyEp0N5X0IIW2oHtuMkC37c7CaDTXlx97qmZ3Hym8BGCFko7YCGmEF8HvvdhEkB6zx333Vi9VOnbdwZZ0FJ7iXq+1+WE3RWe0Ae5m0i/y/dZ0Mpvv/QCOv4yfAu7CQG5N83XFcc3AsC2+8KM3wcV1//ehb7EcTpAnnVs3TJQ+0Ar4bID+QHl8o5n4LtVJgNUAB+NAfksSOF9RPOrfi3V1FSAvL9+ry6G7qQoIwCQKiFsm7axAZUvaPfvrtfHScP9+fLy6RbP1eufIMxVT9OCwA6xeJhHFir5W5C+NbzALnbcgF8fBorQQikQSUs3Zdwf7qNJAJWt30MgB1MNbEELTTWKXhMWU5ysAhEQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBLRvQcaPvtSe+PzhFywZUPjXV99mOMbRwQOq5zcCnCofV0gHJx75n3e5q6YBE9/p92qtfE7V4QMkvD07U4gGd9mkvFUzV4gEdbn8K+98nA2vpgAoRAQXvNTOkFg7ouJGt5wAf3hxPywZ02iv/87ybb/PYRQMSDlqP8Oi/aYyoRQNagggIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICOj/8/sWwzv+neQAAAAASUVORK5CYII=" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
<hr />
</div>
<div id="exercise-3.18" class="section level3">
<h3>Exercise 3.18</h3>
<p>Write a function to generate a random sample from a <span class="math inline">\(W_d (\Sigma,n)\)</span> (Wishart) distribution for <span class="math inline">\(n&gt;d+1 \ge 1\)</span>, based on Bartlett’s decomposition.</p>
<p><span class="math inline">\(Sol.\)</span> To generate a random sample from a <span class="math inline">\(W_d (\Sigma,n)\)</span> (Wishart) distribution, we apply the algorithm on <span class="math inline">\(\textit{Statistical Computing with R}\)</span>, Page 80.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" title="1"><span class="kw">library</span>(matrixcalc)</a>
<a class="sourceLine" id="cb11-2" title="2"></a>
<a class="sourceLine" id="cb11-3" title="3">ge_Wishart =<span class="st"> </span><span class="cf">function</span>(n, Sigma){</a>
<a class="sourceLine" id="cb11-4" title="4">  <span class="co"># Generate a random sample from a W_d(sigma,n) distribution.</span></a>
<a class="sourceLine" id="cb11-5" title="5">  </a>
<a class="sourceLine" id="cb11-6" title="6">  <span class="cf">if</span>(<span class="kw">is.numeric</span>(n) <span class="op">==</span><span class="st"> </span>F <span class="op">|</span><span class="st"> </span><span class="kw">length</span>(n) <span class="op">&gt;</span><span class="st"> </span><span class="dv">1</span>){      <span class="co"># Check that n and sigma satiesfy the assumptions needed.</span></a>
<a class="sourceLine" id="cb11-7" title="7">    <span class="kw">return</span>(<span class="st">&quot;n is not a number&quot;</span>)</a>
<a class="sourceLine" id="cb11-8" title="8">  }</a>
<a class="sourceLine" id="cb11-9" title="9">  </a>
<a class="sourceLine" id="cb11-10" title="10">  n =<span class="st"> </span><span class="kw">as.integer</span>(n)</a>
<a class="sourceLine" id="cb11-11" title="11">  </a>
<a class="sourceLine" id="cb11-12" title="12">  <span class="cf">if</span>(<span class="kw">is.matrix</span>(Sigma) <span class="op">==</span><span class="st"> </span>F){</a>
<a class="sourceLine" id="cb11-13" title="13">    <span class="kw">return</span>(<span class="st">&quot;Sigma is not a matrix&quot;</span>)</a>
<a class="sourceLine" id="cb11-14" title="14">  }</a>
<a class="sourceLine" id="cb11-15" title="15">  <span class="cf">if</span>(<span class="kw">isSymmetric</span>(Sigma) <span class="op">==</span><span class="st"> </span>F){</a>
<a class="sourceLine" id="cb11-16" title="16">    <span class="kw">return</span>(<span class="st">&quot;Sigma is not symmetric&quot;</span>)</a>
<a class="sourceLine" id="cb11-17" title="17">  }</a>
<a class="sourceLine" id="cb11-18" title="18">  <span class="cf">if</span>(matrixcalc<span class="op">::</span><span class="kw">is.positive.definite</span>(Sigma) <span class="op">==</span><span class="st"> </span>F){</a>
<a class="sourceLine" id="cb11-19" title="19">    <span class="kw">return</span>(<span class="st">&quot;Sigma is not positive definite&quot;</span>)</a>
<a class="sourceLine" id="cb11-20" title="20">  }</a>
<a class="sourceLine" id="cb11-21" title="21">  </a>
<a class="sourceLine" id="cb11-22" title="22">  d =<span class="st"> </span><span class="kw">nrow</span>(Sigma)</a>
<a class="sourceLine" id="cb11-23" title="23">  </a>
<a class="sourceLine" id="cb11-24" title="24">  <span class="cf">if</span>(n <span class="op">&lt;=</span><span class="st"> </span>d<span class="op">+</span><span class="dv">1</span>){</a>
<a class="sourceLine" id="cb11-25" title="25">    <span class="kw">return</span>(<span class="st">&quot;error in dimension&quot;</span>)                <span class="co"># Check the assumption mentioned in the question.</span></a>
<a class="sourceLine" id="cb11-26" title="26">  }</a>
<a class="sourceLine" id="cb11-27" title="27">  </a>
<a class="sourceLine" id="cb11-28" title="28">  L =<span class="st"> </span><span class="kw">chol</span>(Sigma)                  </a>
<a class="sourceLine" id="cb11-29" title="29">  <span class="co"># Obtain the Choleski factorization. Note that L is upper triangular.</span></a>
<a class="sourceLine" id="cb11-30" title="30">  </a>
<a class="sourceLine" id="cb11-31" title="31">  TT =<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>, <span class="dt">nrow =</span> d, <span class="dt">ncol =</span> d)</a>
<a class="sourceLine" id="cb11-32" title="32">  <span class="co"># Create the matrix</span></a>
<a class="sourceLine" id="cb11-33" title="33">  </a>
<a class="sourceLine" id="cb11-34" title="34">  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>d){                                </a>
<a class="sourceLine" id="cb11-35" title="35">  <span class="co">#applied the algorithm on Statistical Computing with R, Page 80</span></a>
<a class="sourceLine" id="cb11-36" title="36">    </a>
<a class="sourceLine" id="cb11-37" title="37">    TT[i,i] =<span class="st"> </span><span class="kw">sqrt</span>(<span class="kw">rchisq</span>(<span class="dv">1</span>, n<span class="op">-</span>i<span class="op">+</span><span class="dv">1</span>))</a>
<a class="sourceLine" id="cb11-38" title="38">    </a>
<a class="sourceLine" id="cb11-39" title="39">    <span class="cf">if</span>(i <span class="op">&gt;</span><span class="st"> </span><span class="dv">1</span>){</a>
<a class="sourceLine" id="cb11-40" title="40">      </a>
<a class="sourceLine" id="cb11-41" title="41">      <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>(i<span class="dv">-1</span>)){</a>
<a class="sourceLine" id="cb11-42" title="42">        </a>
<a class="sourceLine" id="cb11-43" title="43">        TT[i,j] =<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb11-44" title="44">      } </a>
<a class="sourceLine" id="cb11-45" title="45">    }</a>
<a class="sourceLine" id="cb11-46" title="46">  }</a>
<a class="sourceLine" id="cb11-47" title="47">  </a>
<a class="sourceLine" id="cb11-48" title="48">  <span class="kw">return</span>(<span class="kw">t</span>(L) <span class="op">%*%</span><span class="st"> </span>TT <span class="op">%*%</span><span class="st"> </span><span class="kw">t</span>(TT) <span class="op">%*%</span><span class="st"> </span>L)</a>
<a class="sourceLine" id="cb11-49" title="49">}</a></code></pre></div>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" title="1">Sigma =<span class="st"> </span><span class="kw">cbind</span>(<span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">12</span>,<span class="op">-</span><span class="dv">16</span>),<span class="kw">c</span>(<span class="dv">12</span>,<span class="dv">37</span>,<span class="op">-</span><span class="dv">43</span>),<span class="kw">c</span>(<span class="op">-</span><span class="dv">16</span>,<span class="op">-</span><span class="dv">43</span>,<span class="dv">98</span>))       <span class="co"># An example of Sigma</span></a>
<a class="sourceLine" id="cb12-2" title="2"></a>
<a class="sourceLine" id="cb12-3" title="3"><span class="kw">ge_Wishart</span>(<span class="dv">5</span>,Sigma)       <span class="co"># Generate a random sample</span></a></code></pre></div>
<pre><code>##            [,1]      [,2]      [,3]
## [1,]   5.690078  15.44144 -32.72751
## [2,]  15.441438  56.85114 -21.52167
## [3,] -32.727514 -21.52167 505.60884</code></pre>
<hr />
<p>#Homework 3</p>
</div>
</div>
<div id="question-2" class="section level2">
<h2>Question</h2>
<p>Exercises 5.1, 5.10, 5.15 (pages 149-151, Statistical Computating with R).</p>
<hr />
</div>
<div id="answer-2" class="section level2">
<h2>Answer</h2>
<div id="exercise-5.1" class="section level3">
<h3>Exercise 5.1</h3>
<p>Compute a Monte Carlo estimate of <span class="math display">\[ 
\int_0^{\pi /3} \sin t\text{ d}t
\]</span> and compare your estimate with the exact value of the integral.</p>
<p><span class="math inline">\(Sol.\)</span> First of all, we calculate the exact value of the integral. <span class="math display">\[
\int_0^{\pi /3} \sin t\text{ d}t = -\cos t|_{t=0}^{\pi /3} = \frac{1}{2}
\]</span> Then we compute a Monte Carlo estimate. Suppose <span class="math inline">\(U \sim (0,\pi /3)\)</span>. Then its probability density function will be <span class="math inline">\(\frac{3}{\pi}\)</span> on <span class="math inline">\((0,\pi /3)\)</span> and <span class="math inline">\(0\)</span> elsewhere. Hence, we have <span class="math display">\[
E(\sin U) = \int_0^{\pi /3} \frac{3}{\pi} \sin t\text{ d}t = \frac{3}{\pi}\int_0^{\pi /3} \sin t\text{ d}t
\]</span> Namely, to estimate the original integral, it suffice to estimate <span class="math inline">\(\frac{\pi}{3}E(\sin U)\)</span>, where <span class="math inline">\(U \sim (0,\pi /3)\)</span>.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" title="1"><span class="kw">set.seed</span>(<span class="dv">1011</span>)</a>
<a class="sourceLine" id="cb14-2" title="2"></a>
<a class="sourceLine" id="cb14-3" title="3">U =<span class="st"> </span><span class="kw">runif</span>(<span class="dv">10000</span>, <span class="dt">min =</span> <span class="dv">0</span>, <span class="dt">max =</span> pi<span class="op">/</span><span class="dv">3</span>)     <span class="co"># generate 10000 random samples of U</span></a>
<a class="sourceLine" id="cb14-4" title="4"></a>
<a class="sourceLine" id="cb14-5" title="5">pi <span class="op">/</span><span class="st"> </span><span class="dv">3</span> <span class="op">*</span><span class="st"> </span><span class="kw">mean</span>(<span class="kw">sin</span>(U))                     <span class="co"># Calculate the estimation of the integral</span></a></code></pre></div>
<pre><code>## [1] 0.5003469</code></pre>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" title="1">pi <span class="op">/</span><span class="st"> </span><span class="dv">3</span> <span class="op">*</span><span class="st"> </span><span class="kw">mean</span>(<span class="kw">sin</span>(U)) <span class="op">-</span><span class="st"> </span><span class="dv">1</span><span class="op">/</span><span class="dv">2</span>               <span class="co"># calculate the bias</span></a></code></pre></div>
<pre><code>## [1] 0.0003468655</code></pre>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" title="1"><span class="kw">var</span>(pi <span class="op">/</span><span class="dv">3</span> <span class="op">*</span><span class="st"> </span><span class="kw">sin</span>(U))                       <span class="co"># Calculate the sample variance</span></a></code></pre></div>
<pre><code>## [1] 0.07068294</code></pre>
<hr />
</div>
<div id="exercise-5.10" class="section level3">
<h3>Exercise 5.10</h3>
<p>Use Monte Carlo integration with antithetic variables to estimate <span class="math display">\[
\int_0^1 \frac{e^{-x}}{1+x^2} \text{d} x
\]</span> and ﬁnd the approximate reduction in variance as a percentage of the variance without variance reduction.</p>
<p><span class="math inline">\(Sol.\)</span> Similar to the exercise above, we suppose <span class="math inline">\(U \sim (0,1)\)</span>. Then we have <span class="math display">\[
E(\frac{e^{-U}}{1+U^2}) = \int_0^1 \frac{e^{-x}}{1+x^2} \text{d}x
\]</span> Hence it suffice to estimate the expectation in the right-hand side of the equation above. Following the codes on <span class="math inline">\(\textit{Statistical Computing with R}\)</span>, Page 131, we construct a function that can optionally compute the estimate with or without antithetic sampling.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" title="1">MC.antithetic =<span class="st"> </span><span class="cf">function</span>(<span class="dt">R =</span> <span class="dv">1000</span>, <span class="dt">antithetic =</span> T){   </a>
<a class="sourceLine" id="cb20-2" title="2">  <span class="co"># Modified from the codes on page 131</span></a>
<a class="sourceLine" id="cb20-3" title="3">  </a>
<a class="sourceLine" id="cb20-4" title="4">  u =<span class="st"> </span><span class="kw">runif</span>(R<span class="op">/</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb20-5" title="5">  </a>
<a class="sourceLine" id="cb20-6" title="6">  <span class="cf">if</span>(<span class="op">!</span>antithetic){</a>
<a class="sourceLine" id="cb20-7" title="7">    v =<span class="st"> </span><span class="kw">runif</span>(R<span class="op">/</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb20-8" title="8">  }</a>
<a class="sourceLine" id="cb20-9" title="9">    <span class="cf">else</span>{</a>
<a class="sourceLine" id="cb20-10" title="10">    v =<span class="st"> </span><span class="dv">1</span> <span class="op">-</span><span class="st"> </span>u  </a>
<a class="sourceLine" id="cb20-11" title="11">  } </a>
<a class="sourceLine" id="cb20-12" title="12">  </a>
<a class="sourceLine" id="cb20-13" title="13">  u =<span class="st"> </span><span class="kw">c</span>(u,v)</a>
<a class="sourceLine" id="cb20-14" title="14">  </a>
<a class="sourceLine" id="cb20-15" title="15">  E =<span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span>u)<span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>u<span class="op">^</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb20-16" title="16">  </a>
<a class="sourceLine" id="cb20-17" title="17">  <span class="kw">return</span>(<span class="kw">mean</span>(E))</a>
<a class="sourceLine" id="cb20-18" title="18">}</a>
<a class="sourceLine" id="cb20-19" title="19"></a>
<a class="sourceLine" id="cb20-20" title="20"></a>
<a class="sourceLine" id="cb20-21" title="21"><span class="kw">MC.antithetic</span>(<span class="dt">antithetic =</span> T)   <span class="co"># estimate with antithetic sampling</span></a></code></pre></div>
<pre><code>## [1] 0.5235421</code></pre>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" title="1">m=<span class="dv">1000</span></a>
<a class="sourceLine" id="cb22-2" title="2"></a>
<a class="sourceLine" id="cb22-3" title="3">MC1 =<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>,<span class="dv">1000</span>)</a>
<a class="sourceLine" id="cb22-4" title="4">MC2 =<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>,<span class="dv">1000</span>)</a>
<a class="sourceLine" id="cb22-5" title="5"></a>
<a class="sourceLine" id="cb22-6" title="6"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">1000</span>){</a>
<a class="sourceLine" id="cb22-7" title="7">  MC1[i] =<span class="st"> </span><span class="kw">MC.antithetic</span>(<span class="dt">antithetic =</span> F)</a>
<a class="sourceLine" id="cb22-8" title="8">  MC2[i] =<span class="st"> </span><span class="kw">MC.antithetic</span>(<span class="dt">antithetic =</span> T)</a>
<a class="sourceLine" id="cb22-9" title="9">}</a>
<a class="sourceLine" id="cb22-10" title="10"></a>
<a class="sourceLine" id="cb22-11" title="11"><span class="kw">sd</span>(MC1)                         <span class="co"># sample variance without antithetic sampling</span></a></code></pre></div>
<pre><code>## [1] 0.007723496</code></pre>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" title="1"><span class="kw">sd</span>(MC2)                         <span class="co"># sample variance with antithetic sampling</span></a></code></pre></div>
<pre><code>## [1] 0.001491442</code></pre>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" title="1">(<span class="kw">var</span>(MC1)<span class="op">-</span><span class="kw">var</span>(MC2))<span class="op">/</span><span class="kw">var</span>(MC1)    <span class="co"># reduction in variance</span></a></code></pre></div>
<pre><code>## [1] 0.9627106</code></pre>
<p>Hence the approximated reduction in variance is 0.9627106.</p>
<hr />
</div>
<div id="exercise-5.15" class="section level3">
<h3>Exercise 5.15</h3>
<p>Obtain the stratiﬁed importance sampling estimate in Example 5.13 and compare it with the result of Example 5.10.</p>
<p><span class="math inline">\(Sol.\)</span> First of all, we recall what we did in Example 5.10. We used importance sampling to estimate <span class="math display">\[
\int_0^1 \frac{e^{-x}}{1+x^2} \text{d}x
\]</span> Our best result was obtained with importance function <span class="math display">\[
f_3(x)= \ \frac{e^{-x}}{1-e^{-1}},\quad 0&lt;x&lt;1
\]</span></p>
<p>And the integrand is <span class="math display">\[
g(x) = \frac{e^{-x}}{1+x^2} 1_{0&lt;x&lt;1}
\]</span> Then we copy the code ( of <span class="math inline">\(f_3\)</span>) from Example 5.10.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb28-1" title="1">m &lt;-<span class="st"> </span><span class="dv">10000</span> </a>
<a class="sourceLine" id="cb28-2" title="2"></a>
<a class="sourceLine" id="cb28-3" title="3">g &lt;-<span class="st"> </span><span class="cf">function</span>(x){ </a>
<a class="sourceLine" id="cb28-4" title="4">  <span class="kw">exp</span>(<span class="op">-</span>x <span class="op">-</span><span class="st"> </span><span class="kw">log</span>(<span class="dv">1</span><span class="op">+</span>x<span class="op">^</span><span class="dv">2</span>)) <span class="op">*</span><span class="st"> </span>(x <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>) <span class="op">*</span><span class="st"> </span>(x <span class="op">&lt;</span><span class="st"> </span><span class="dv">1</span>) </a>
<a class="sourceLine" id="cb28-5" title="5">}</a>
<a class="sourceLine" id="cb28-6" title="6"></a>
<a class="sourceLine" id="cb28-7" title="7">u &lt;-<span class="st"> </span><span class="kw">runif</span>(m)                            <span class="co">#f3, inverse transform method </span></a>
<a class="sourceLine" id="cb28-8" title="8">x &lt;-<span class="st"> </span><span class="op">-</span><span class="st"> </span><span class="kw">log</span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>u <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span>))) </a>
<a class="sourceLine" id="cb28-9" title="9">fg &lt;-<span class="st"> </span><span class="kw">g</span>(x) <span class="op">/</span><span class="st"> </span>(<span class="kw">exp</span>(<span class="op">-</span>x) <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span>))) </a>
<a class="sourceLine" id="cb28-10" title="10"></a>
<a class="sourceLine" id="cb28-11" title="11">theta.hat &lt;-<span class="st"> </span><span class="kw">mean</span>(fg)                    <span class="co">#estimate of importance sampling</span></a>
<a class="sourceLine" id="cb28-12" title="12">se &lt;-<span class="st"> </span><span class="kw">sd</span>(fg)                             <span class="co">#estimated standard error</span></a></code></pre></div>
<p>To carry out stratified importance sampling, we need to calculate the quantiles first. The cumulative distribution function of <span class="math inline">\(f_3\)</span> on <span class="math inline">\((0,1)\)</span> is <span class="math display">\[
F_3 (x) = \ \frac{1-e^{-x}}{1-e^{-1}},\quad 0&lt;x&lt;1 
\]</span> Following the instructions of Examples 5.13, we divide the interval <span class="math inline">\((0,1)\)</span> into five subintervals, <span class="math inline">\((\frac{j}{5},\frac{j+1}{5})\)</span>, <span class="math inline">\(j=0,1,2,3,4\)</span>. Then we can take <span class="math display">\[
F_3^{-1} (0) = 0, \ F_3^{-1} (1)=1
\]</span> and <span class="math display">\[
F_3^{-1} (\frac{j}{5}) = -\log  (1-\frac{(1-e^{-1})j}{5})
\]</span> This equation also holds for <span class="math inline">\(j=0\)</span> and <span class="math inline">\(j=6\)</span>.</p>
<p>Then we carry out the implementation. To compare with the result above, we replicate <span class="math inline">\(10000/5 = 2000\)</span> times on each of the 5 strata.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb29-1" title="1">m =<span class="st"> </span><span class="dv">2000</span>                                  <span class="co">#replicate 2000 times on each strata </span></a>
<a class="sourceLine" id="cb29-2" title="2"></a>
<a class="sourceLine" id="cb29-3" title="3">Quantile=<span class="kw">c</span>(<span class="dv">0</span>,<span class="fl">0.1</span>,<span class="fl">0.2</span>,<span class="fl">0.3</span>,<span class="fl">0.4</span>,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb29-4" title="4"></a>
<a class="sourceLine" id="cb29-5" title="5"><span class="co"># the following codes are modified from Example 5.12</span></a>
<a class="sourceLine" id="cb29-6" title="6"></a>
<a class="sourceLine" id="cb29-7" title="7">fg_im =<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>,<span class="dt">nrow =</span> <span class="dv">5</span>, <span class="dt">ncol =</span> m)              <span class="co">#initialization</span></a>
<a class="sourceLine" id="cb29-8" title="8"></a>
<a class="sourceLine" id="cb29-9" title="9"><span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>){</a>
<a class="sourceLine" id="cb29-10" title="10">  u =<span class="st"> </span><span class="kw">runif</span>(m,(j<span class="dv">-1</span>)<span class="op">/</span><span class="dv">5</span>,j<span class="op">/</span><span class="dv">5</span>)       <span class="co">#f3, inverse transform method</span></a>
<a class="sourceLine" id="cb29-11" title="11">  x =<span class="st"> </span><span class="op">-</span><span class="st"> </span><span class="kw">log</span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>u <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span>))) </a>
<a class="sourceLine" id="cb29-12" title="12">  fg_im[j,] =<span class="st"> </span><span class="kw">g</span>(x) <span class="op">/</span><span class="st"> </span>(<span class="kw">exp</span>(<span class="op">-</span>x) <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span>))) </a>
<a class="sourceLine" id="cb29-13" title="13">}</a>
<a class="sourceLine" id="cb29-14" title="14">  </a>
<a class="sourceLine" id="cb29-15" title="15">fg2 =<span class="st"> </span><span class="kw">colMeans</span>(fg_im)</a>
<a class="sourceLine" id="cb29-16" title="16"></a>
<a class="sourceLine" id="cb29-17" title="17">theta.hat2 =<span class="st"> </span><span class="kw">mean</span>(fg2) </a>
<a class="sourceLine" id="cb29-18" title="18">se2 =<span class="st"> </span><span class="kw">sd</span>(fg2)</a>
<a class="sourceLine" id="cb29-19" title="19"></a>
<a class="sourceLine" id="cb29-20" title="20">result =<span class="st"> </span><span class="kw">rbind</span>(<span class="kw">c</span>(theta.hat,se),<span class="kw">c</span>(theta.hat2,se2))</a>
<a class="sourceLine" id="cb29-21" title="21"><span class="kw">rownames</span>(result) =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Importance Sampling&quot;</span>,<span class="st">&quot;Stratified Importance Sampling&quot;</span>)</a>
<a class="sourceLine" id="cb29-22" title="22"><span class="kw">colnames</span>(result) =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;estimate&quot;</span>,<span class="st">&quot;estimated standard error&quot;</span>)</a>
<a class="sourceLine" id="cb29-23" title="23"></a>
<a class="sourceLine" id="cb29-24" title="24">result</a></code></pre></div>
<pre><code>##                                 estimate estimated standard error
## Importance Sampling            0.5241865              0.098061932
## Stratified Importance Sampling 0.5244072              0.009612695</code></pre>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb31-1" title="1">(<span class="kw">var</span>(fg)<span class="op">-</span><span class="kw">var</span>(fg2))<span class="op">/</span><span class="kw">var</span>(fg)          <span class="co"># reduction in variance</span></a></code></pre></div>
<pre><code>## [1] 0.9903908</code></pre>
<p>Hence the approximated reduction in variance is 0.9903908.</p>
<p>Remark: Notice that if <span class="math inline">\(U \sim (\frac{j-1}{5},\frac{j}{5})\)</span> (<span class="math inline">\(j=0,\dots,4\)</span>) and <span class="math inline">\(X\)</span> is generated from <span class="math inline">\(X=F_X^{-1}(U)\)</span>, then the density of <span class="math inline">\(X\)</span> will be <span class="math inline">\(5f_X(x) , \ \frac{j-1}{5}&lt;x&lt;\frac{j}{5}\)</span>, our desired result in Example 5.13.</p>
<hr />
</div>
</div>
</div>
<div id="homework-4" class="section level1">
<h1>Homework 4</h1>
<div id="question-3" class="section level2">
<h2>Question</h2>
<p>Exercise 6.5,6.6 (page 180, <span class="math inline">\(\textit{Statistical Computing With R}\)</span>).</p>
<hr />
</div>
<div id="answer-3" class="section level2">
<h2>Answer</h2>
<div id="exercise-6.5" class="section level3">
<h3>Exercise 6.5</h3>
<p>Suppose a <span class="math inline">\(95\%\)</span> symmetric <span class="math inline">\(t\)</span>-interval is applied to estimate a mean, but the sample data are non-normal. Then the probability that the confidence interval covers the mean is not necessarily equal to 0.95. Use a Monte Carlo experiment to estimate the coverage probability of the <span class="math inline">\(t\)</span>-interval for random samples of <span class="math inline">\(\chi^2(2)\)</span> data with sample size <span class="math inline">\(n = 20\)</span>. Compare your <span class="math inline">\(t\)</span>-interval results with the simulation results in Example 6.4. (The <span class="math inline">\(t\)</span>-interval should be more robust to departures from normality than the interval for variance.)</p>
<p><span class="math inline">\(Sol.\)</span> First of all, let us recall that the <span class="math inline">\(t\)</span>-interval used to estimate a mean is <span class="math inline">\([\overline{X}-T_{\alpha/2}\frac{S}{\sqrt{n}},\overline{X}+T_{\alpha/2}\frac{S}{\sqrt{n}}]\)</span>. Meanwhile, the confidence interval for the variance in Example 6.4 is <span class="math inline">\((0,\frac{(n-1)S^2}{\chi_{.05}^2 (n-1)})\)</span>.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb33-1" title="1"><span class="kw">set.seed</span>(<span class="dv">1018</span>)</a>
<a class="sourceLine" id="cb33-2" title="2"></a>
<a class="sourceLine" id="cb33-3" title="3">m =<span class="st"> </span><span class="fl">1e5</span>                    <span class="co">#repeat 1e5 times</span></a>
<a class="sourceLine" id="cb33-4" title="4">n =<span class="st"> </span><span class="dv">20</span>                     <span class="co">#sample size</span></a>
<a class="sourceLine" id="cb33-5" title="5"></a>
<a class="sourceLine" id="cb33-6" title="6">estimate =<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>,m)</a>
<a class="sourceLine" id="cb33-7" title="7">estimate_<span class="dv">2</span> =<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>,m)</a>
<a class="sourceLine" id="cb33-8" title="8"></a>
<a class="sourceLine" id="cb33-9" title="9"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</a>
<a class="sourceLine" id="cb33-10" title="10">  </a>
<a class="sourceLine" id="cb33-11" title="11">  X =<span class="st"> </span><span class="kw">rchisq</span>(n, <span class="dt">df =</span> <span class="dv">2</span>)       <span class="co"># generate random samples from  chi_2^2 </span></a>
<a class="sourceLine" id="cb33-12" title="12">  </a>
<a class="sourceLine" id="cb33-13" title="13">  estimate[i] =<span class="st"> </span><span class="kw">mean</span>(X)<span class="op">-</span><span class="st"> </span><span class="kw">qt</span>(<span class="fl">0.975</span>,n<span class="dv">-1</span>)<span class="op">*</span><span class="kw">var</span>(X)<span class="op">/</span><span class="kw">sqrt</span>(n) <span class="op">&lt;=</span><span class="st"> </span><span class="dv">2</span> <span class="op">&amp;</span><span class="st"> </span><span class="kw">mean</span>(X) <span class="op">+</span><span class="st"> </span><span class="kw">qt</span>(<span class="fl">0.975</span>,n<span class="dv">-1</span>)<span class="op">*</span><span class="kw">var</span>(X)<span class="op">/</span><span class="kw">sqrt</span>(n) <span class="op">&gt;=</span><span class="st"> </span><span class="dv">2</span></a>
<a class="sourceLine" id="cb33-14" title="14">  <span class="co"># notice that the mean of the chi_2^2 is 2</span></a>
<a class="sourceLine" id="cb33-15" title="15">  <span class="co"># calculate whether the mean of chi_2^2 is 2 is covered by the t-interval in the ith simulation</span></a>
<a class="sourceLine" id="cb33-16" title="16">  </a>
<a class="sourceLine" id="cb33-17" title="17">  estimate_<span class="dv">2</span>[i] =<span class="st"> </span>(n<span class="dv">-1</span>)<span class="op">*</span><span class="kw">var</span>(X)<span class="op">/</span><span class="kw">qchisq</span>(<span class="fl">0.05</span>, <span class="dt">df =</span> n<span class="dv">-1</span>) <span class="op">&gt;=</span><span class="st"> </span><span class="dv">4</span></a>
<a class="sourceLine" id="cb33-18" title="18">  <span class="co"># the variance of the chi_2^2 is 4</span></a>
<a class="sourceLine" id="cb33-19" title="19">  <span class="co"># calculate whether the variance of chi_2^2 is covered by the confidence interval in Example 6.4</span></a>
<a class="sourceLine" id="cb33-20" title="20">  </a>
<a class="sourceLine" id="cb33-21" title="21">  }</a>
<a class="sourceLine" id="cb33-22" title="22"></a>
<a class="sourceLine" id="cb33-23" title="23"><span class="kw">mean</span>(estimate)              <span class="co"># estimated coverage probability of the t-interval for mean</span></a></code></pre></div>
<pre><code>## [1] 0.94878</code></pre>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb35-1" title="1"><span class="kw">mean</span>(estimate_<span class="dv">2</span>)            <span class="co"># estimated coverage probability of the confidence interval for variance in Example 6.4</span></a></code></pre></div>
<pre><code>## [1] 0.78388</code></pre>
<p>If the samples are from a normal distributon, then both of the two estimations should be close to <span class="math inline">\(0.95\)</span>. However, here the samples are taken from a <span class="math inline">\(\chi^2(2)\)</span> distribution, and we see that, same as the hint in the Exercise, the <span class="math inline">\(t\)</span>-interval is more robust to departures from normality than the interval for variance.</p>
<hr />
</div>
<div id="exercise-6.6" class="section level3">
<h3>Exercise 6.6</h3>
<p>Estimate the 0.025, 0.05, 0.95, and 0.975 quantiles of the skewness <span class="math inline">\(\sqrt{b_1}\)</span> under normality by a Monte Carlo experiment. Compute the standard error of the estimates from (2.14) using the normal approximation for the density (with exact variance formula). Compare the estimated quantiles with the quantiles of the large sample approximation <span class="math inline">\(\sqrt{b_1} \approx N(0,6/n)\)</span>.</p>
<p><span class="math inline">\(Sol.\)</span> Recall that on page 165, the author stated that if <span class="math inline">\(X\)</span> is normal, then the sample coefficient of skewness (denoted by <span class="math inline">\(\sqrt{b_1}\)</span>) is asymptotically normal with mean <span class="math inline">\(0\)</span> and variance <span class="math inline">\(6/n\)</span>. However, on page 167, the author pointed out that for finite samples, one should use <span class="math display">\[
Var(\sqrt{b_1}) = \frac{6(n-2)}{(n+1)(n+3)}
\]</span> Here we give computations of both of the variances.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb37-1" title="1">q =<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.025</span>,<span class="fl">0.05</span>,<span class="fl">0.95</span>,<span class="fl">0.975</span>)</a>
<a class="sourceLine" id="cb37-2" title="2"></a>
<a class="sourceLine" id="cb37-3" title="3">sk =<span class="st"> </span><span class="cf">function</span>(x){ </a>
<a class="sourceLine" id="cb37-4" title="4">  <span class="co">#computes the sample skewness coeff. </span></a>
<a class="sourceLine" id="cb37-5" title="5">  xbar =<span class="st"> </span><span class="kw">mean</span>(x) </a>
<a class="sourceLine" id="cb37-6" title="6">  m3 =<span class="st"> </span><span class="kw">mean</span>((x <span class="op">-</span><span class="st"> </span>xbar)<span class="op">^</span><span class="dv">3</span>) </a>
<a class="sourceLine" id="cb37-7" title="7">  m2 =<span class="st"> </span><span class="kw">mean</span>((x <span class="op">-</span><span class="st"> </span>xbar)<span class="op">^</span><span class="dv">2</span>) </a>
<a class="sourceLine" id="cb37-8" title="8">  <span class="kw">return</span>( m3 <span class="op">/</span><span class="st"> </span>m2<span class="op">^</span><span class="fl">1.5</span> ) </a>
<a class="sourceLine" id="cb37-9" title="9">} </a>
<a class="sourceLine" id="cb37-10" title="10"></a>
<a class="sourceLine" id="cb37-11" title="11"></a>
<a class="sourceLine" id="cb37-12" title="12">Quantile_skew =<span class="st"> </span><span class="cf">function</span>(<span class="dt">mean =</span> <span class="dv">0</span>, <span class="dt">sd =</span> <span class="dv">1</span>, <span class="dt">n =</span> <span class="dv">500</span>, <span class="dt">m =</span> <span class="fl">1e4</span>, q){</a>
<a class="sourceLine" id="cb37-13" title="13">  <span class="co"># Generate the table of the answer</span></a>
<a class="sourceLine" id="cb37-14" title="14">  </a>
<a class="sourceLine" id="cb37-15" title="15">  <span class="co"># Input: mean and sd are mean and standard error of the normal distribution.</span></a>
<a class="sourceLine" id="cb37-16" title="16">  <span class="co"># n is the sample size. m is the repeating times.</span></a>
<a class="sourceLine" id="cb37-17" title="17">  <span class="co"># q is the sequence of the quantiles.</span></a>
<a class="sourceLine" id="cb37-18" title="18">  </a>
<a class="sourceLine" id="cb37-19" title="19">  skew =<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>,m)</a>
<a class="sourceLine" id="cb37-20" title="20">  </a>
<a class="sourceLine" id="cb37-21" title="21">  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</a>
<a class="sourceLine" id="cb37-22" title="22">  X =<span class="st"> </span><span class="kw">rnorm</span>(n, <span class="dt">mean =</span> mean, <span class="dt">sd =</span> sd)          </a>
<a class="sourceLine" id="cb37-23" title="23">  skew[i] =<span class="st"> </span><span class="kw">sk</span>(X)                         <span class="co"># Calculating the sample skewness coefficients</span></a>
<a class="sourceLine" id="cb37-24" title="24">  }</a>
<a class="sourceLine" id="cb37-25" title="25">  </a>
<a class="sourceLine" id="cb37-26" title="26">  a =<span class="st"> </span><span class="kw">quantile</span>(skew, <span class="dt">probs =</span> q)           </a>
<a class="sourceLine" id="cb37-27" title="27">  <span class="co"># the samples quantiles of the sample skewness coefficients          </span></a>
<a class="sourceLine" id="cb37-28" title="28">  </a>
<a class="sourceLine" id="cb37-29" title="29">  b_<span class="dv">1</span> =<span class="st"> </span><span class="kw">qnorm</span>(q, <span class="dt">sd =</span> <span class="kw">sqrt</span>(<span class="dv">6</span><span class="op">/</span>n) )         </a>
<a class="sourceLine" id="cb37-30" title="30">  <span class="co"># theoretical quantiles of the sample skewness coefficients, with the first variance sqrt{6/n} applied</span></a>
<a class="sourceLine" id="cb37-31" title="31">  </a>
<a class="sourceLine" id="cb37-32" title="32">  b_<span class="dv">2</span> =<span class="st"> </span><span class="kw">qnorm</span>(<span class="kw">c</span>(<span class="fl">0.025</span>,<span class="fl">0.05</span>,<span class="fl">0.95</span>,<span class="fl">0.975</span>), <span class="dt">sd =</span> <span class="kw">sqrt</span>(<span class="dv">6</span><span class="op">*</span>(n<span class="dv">-2</span>)<span class="op">/</span>(n<span class="op">+</span><span class="dv">1</span>)<span class="op">/</span>(n<span class="op">+</span><span class="dv">3</span>)))</a>
<a class="sourceLine" id="cb37-33" title="33">  <span class="co"># theoretical quantiles of the sample skewness coefficients, with the second variance applied</span></a>
<a class="sourceLine" id="cb37-34" title="34">  </a>
<a class="sourceLine" id="cb37-35" title="35">  c_<span class="dv">1</span> =<span class="st"> </span><span class="kw">sqrt</span>( q<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>q)<span class="op">/</span>n<span class="op">/</span>( <span class="kw">pnorm</span>(b_<span class="dv">1</span>, <span class="dt">sd =</span> <span class="kw">sqrt</span>(<span class="dv">6</span><span class="op">/</span>n)) )<span class="op">^</span><span class="dv">2</span> )</a>
<a class="sourceLine" id="cb37-36" title="36">  <span class="co"># the standard error of estimates, with the first variance sqrt{6/n} applied</span></a>
<a class="sourceLine" id="cb37-37" title="37">  </a>
<a class="sourceLine" id="cb37-38" title="38">  c_<span class="dv">2</span> =<span class="st"> </span><span class="kw">sqrt</span>( q<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>q)<span class="op">/</span>n<span class="op">/</span>( <span class="kw">pnorm</span>(b_<span class="dv">2</span>, <span class="dt">sd =</span> <span class="kw">sqrt</span>(<span class="dv">6</span><span class="op">/</span>n)) )<span class="op">^</span><span class="dv">2</span> )</a>
<a class="sourceLine" id="cb37-39" title="39">  <span class="co"># the standard error of estimates, with the second variance applied</span></a>
<a class="sourceLine" id="cb37-40" title="40">  </a>
<a class="sourceLine" id="cb37-41" title="41">  result =<span class="st"> </span><span class="kw">cbind</span>(a,b_<span class="dv">1</span>,b_<span class="dv">2</span>,c_<span class="dv">1</span>,c_<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb37-42" title="42">  <span class="kw">colnames</span>(result) =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;sample quantile&quot;</span>,<span class="st">&quot;theoretical quantile 1&quot;</span>,<span class="st">&quot;theoretical quantile 2&quot;</span>,<span class="st">&quot;standard error 1&quot;</span>, <span class="st">&quot;standard error 2&quot;</span>)</a>
<a class="sourceLine" id="cb37-43" title="43">  </a>
<a class="sourceLine" id="cb37-44" title="44">  knitr<span class="op">::</span><span class="kw">kable</span>(result)</a>
<a class="sourceLine" id="cb37-45" title="45">  </a>
<a class="sourceLine" id="cb37-46" title="46">}</a>
<a class="sourceLine" id="cb37-47" title="47"></a>
<a class="sourceLine" id="cb37-48" title="48"><span class="kw">set.seed</span>(<span class="dv">123</span>)</a>
<a class="sourceLine" id="cb37-49" title="49"><span class="kw">Quantile_skew</span>(<span class="dt">q =</span> q)</a></code></pre></div>
<table>
<thead>
<tr class="header">
<th></th>
<th align="right">sample quantile</th>
<th align="right">theoretical quantile 1</th>
<th align="right">theoretical quantile 2</th>
<th align="right">standard error 1</th>
<th align="right">standard error 2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>2.5%</td>
<td align="right">-0.2125752</td>
<td align="right">-0.2147033</td>
<td align="right">-0.2134202</td>
<td align="right">0.2792848</td>
<td align="right">0.2717575</td>
</tr>
<tr class="even">
<td>5%</td>
<td align="right">-0.1805957</td>
<td align="right">-0.1801847</td>
<td align="right">-0.1791079</td>
<td align="right">0.1949359</td>
<td align="right">0.1910311</td>
</tr>
<tr class="odd">
<td>95%</td>
<td align="right">0.1815447</td>
<td align="right">0.1801847</td>
<td align="right">0.1791079</td>
<td align="right">0.0102598</td>
<td align="right">0.0102708</td>
</tr>
<tr class="even">
<td>97.5%</td>
<td align="right">0.2164123</td>
<td align="right">0.2147033</td>
<td align="right">0.2134202</td>
<td align="right">0.0071611</td>
<td align="right">0.0071662</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb38-1" title="1"><span class="kw">Quantile_skew</span>(<span class="dt">n =</span> <span class="dv">20</span>, <span class="dt">q=</span>q)</a></code></pre></div>
<table>
<thead>
<tr class="header">
<th></th>
<th align="right">sample quantile</th>
<th align="right">theoretical quantile 1</th>
<th align="right">theoretical quantile 2</th>
<th align="right">standard error 1</th>
<th align="right">standard error 2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>2.5%</td>
<td align="right">-0.9711067</td>
<td align="right">-1.0735165</td>
<td align="right">-0.9268008</td>
<td align="right">1.3964240</td>
<td align="right">0.7704230</td>
</tr>
<tr class="even">
<td>5%</td>
<td align="right">-0.7822625</td>
<td align="right">-0.9009234</td>
<td align="right">-0.7777958</td>
<td align="right">0.9746794</td>
<td align="right">0.6264333</td>
</tr>
<tr class="odd">
<td>95%</td>
<td align="right">0.7682024</td>
<td align="right">0.9009234</td>
<td align="right">0.7777958</td>
<td align="right">0.0512989</td>
<td align="right">0.0528451</td>
</tr>
<tr class="even">
<td>97.5%</td>
<td align="right">0.9486314</td>
<td align="right">1.0735165</td>
<td align="right">0.9268008</td>
<td align="right">0.0358057</td>
<td align="right">0.0365676</td>
</tr>
</tbody>
</table>
<p>We see that, when the sample size <span class="math inline">\(n=500\)</span>, both of the variances give good results in calculating the quantiles. However, when <span class="math inline">\(n\)</span> is small, it is usually better to use <span class="math display">\[
Var(\sqrt{b_1}) = \frac{6(n-2)}{(n+1)(n+3)},
\]</span> which has been suggested on Page 167.</p>
<hr />
</div>
</div>
</div>
<div id="homework-5" class="section level1">
<h1>Homework 5</h1>
<div id="question-4" class="section level2">
<h2>Question</h2>
<p>Exercises 6.7, 6.A, slides page 22 (pages 180-181, Statistical Computating with R).</p>
<hr />
</div>
<div id="answer-4" class="section level2">
<h2>Answer</h2>
<div id="exercise-6.7" class="section level3">
<h3>Exercise 6.7</h3>
<p>Estimate the power of the skewness test of normality against symmetric <span class="math inline">\(\text{Beta} (\alpha,\alpha)\)</span> distributions and comment on the results. Are the results different for heavy-tailed symmetric alternatives such as <span class="math inline">\(\text{}t(\nu)\)</span>?</p>
<p><span class="math inline">\(Sol.\)</span> This is similar to what we did in Example 6.10 (Page 169). We just need to copy the code from Example 6.10 and do some modifications.</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb39-1" title="1">sk =<span class="st"> </span><span class="cf">function</span>(x) { </a>
<a class="sourceLine" id="cb39-2" title="2">  <span class="co">#computes the sample skewness coeff. </span></a>
<a class="sourceLine" id="cb39-3" title="3">  xbar =<span class="st"> </span><span class="kw">mean</span>(x) </a>
<a class="sourceLine" id="cb39-4" title="4">  m3 =<span class="st"> </span><span class="kw">mean</span>((x <span class="op">-</span><span class="st"> </span>xbar)<span class="op">^</span><span class="dv">3</span>) </a>
<a class="sourceLine" id="cb39-5" title="5">  m2 =<span class="st"> </span><span class="kw">mean</span>((x <span class="op">-</span><span class="st"> </span>xbar)<span class="op">^</span><span class="dv">2</span>) </a>
<a class="sourceLine" id="cb39-6" title="6">  <span class="kw">return</span>( m3 <span class="op">/</span><span class="st"> </span>m2<span class="op">^</span><span class="fl">1.5</span> ) </a>
<a class="sourceLine" id="cb39-7" title="7">} </a>
<a class="sourceLine" id="cb39-8" title="8"></a>
<a class="sourceLine" id="cb39-9" title="9"></a>
<a class="sourceLine" id="cb39-10" title="10">Pwr_Skew_NB =<span class="st"> </span><span class="cf">function</span>(alpha, <span class="dt">sl =</span> <span class="fl">0.1</span>, <span class="dt">n =</span> <span class="dv">30</span>, <span class="dt">m =</span> <span class="dv">2500</span>  ){</a>
<a class="sourceLine" id="cb39-11" title="11">  <span class="co"># return the estimated power</span></a>
<a class="sourceLine" id="cb39-12" title="12">  <span class="co"># alpha is the parameter in Beta distribution</span></a>
<a class="sourceLine" id="cb39-13" title="13">  <span class="co"># sl is the significance level</span></a>
<a class="sourceLine" id="cb39-14" title="14">  <span class="co"># n is the sample size</span></a>
<a class="sourceLine" id="cb39-15" title="15">  <span class="co"># m is the replication times</span></a>
<a class="sourceLine" id="cb39-16" title="16">  </a>
<a class="sourceLine" id="cb39-17" title="17">  N =<span class="st"> </span><span class="kw">length</span>(alpha) </a>
<a class="sourceLine" id="cb39-18" title="18"></a>
<a class="sourceLine" id="cb39-19" title="19">  pwr =<span class="st"> </span><span class="kw">numeric</span>(N) </a>
<a class="sourceLine" id="cb39-20" title="20"> </a>
<a class="sourceLine" id="cb39-21" title="21">  cv =<span class="st"> </span><span class="kw">qnorm</span>(<span class="dv">1</span><span class="op">-</span>sl<span class="op">/</span><span class="dv">2</span>, <span class="dv">0</span>, <span class="kw">sqrt</span>(<span class="dv">6</span><span class="op">*</span>(n<span class="dv">-2</span>) <span class="op">/</span><span class="st"> </span>((n<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span>(n<span class="op">+</span><span class="dv">3</span>))))      </a>
<a class="sourceLine" id="cb39-22" title="22">  <span class="co">#critical value for the skewness test</span></a>
<a class="sourceLine" id="cb39-23" title="23"></a>
<a class="sourceLine" id="cb39-24" title="24">  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N) {              <span class="co">#for each epsilon </span></a>
<a class="sourceLine" id="cb39-25" title="25">  </a>
<a class="sourceLine" id="cb39-26" title="26">    shape =<span class="st"> </span>alpha[j] </a>
<a class="sourceLine" id="cb39-27" title="27">  </a>
<a class="sourceLine" id="cb39-28" title="28">    sktests=<span class="st"> </span><span class="kw">numeric</span>(m) </a>
<a class="sourceLine" id="cb39-29" title="29">  </a>
<a class="sourceLine" id="cb39-30" title="30">    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) {            <span class="co">#for each replicate </span></a>
<a class="sourceLine" id="cb39-31" title="31">    </a>
<a class="sourceLine" id="cb39-32" title="32">      x =<span class="st"> </span><span class="kw">rbeta</span>(n, <span class="dt">shape1 =</span> shape, <span class="dt">shape2 =</span> shape) </a>
<a class="sourceLine" id="cb39-33" title="33">    </a>
<a class="sourceLine" id="cb39-34" title="34">      sktests[i] =<span class="st"> </span><span class="kw">as.integer</span>(<span class="kw">abs</span>(<span class="kw">sk</span>(x)) <span class="op">&gt;=</span><span class="st"> </span>cv) </a>
<a class="sourceLine" id="cb39-35" title="35">    </a>
<a class="sourceLine" id="cb39-36" title="36">    } </a>
<a class="sourceLine" id="cb39-37" title="37">  </a>
<a class="sourceLine" id="cb39-38" title="38">  pwr[j] =<span class="st"> </span><span class="kw">mean</span>(sktests) </a>
<a class="sourceLine" id="cb39-39" title="39">  }</a>
<a class="sourceLine" id="cb39-40" title="40">  </a>
<a class="sourceLine" id="cb39-41" title="41">  <span class="kw">return</span>(pwr)</a>
<a class="sourceLine" id="cb39-42" title="42">}</a>
<a class="sourceLine" id="cb39-43" title="43"></a>
<a class="sourceLine" id="cb39-44" title="44">alpha =<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">2</span>,<span class="fl">0.1</span>)</a>
<a class="sourceLine" id="cb39-45" title="45"><span class="co">#plot power vs alpha</span></a>
<a class="sourceLine" id="cb39-46" title="46"><span class="kw">plot</span>(alpha, <span class="kw">Pwr_Skew_NB</span>(<span class="dt">alpha =</span> alpha), <span class="dt">type =</span> <span class="st">&quot;b&quot;</span>, <span class="dt">xlab =</span> <span class="kw">bquote</span>(alpha), <span class="dt">ylab =</span> <span class="st">&quot;power&quot;</span>, <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="fl">0.1</span>)) </a>
<a class="sourceLine" id="cb39-47" title="47"><span class="kw">abline</span>(<span class="dt">h =</span> <span class="fl">.1</span>, <span class="dt">lty =</span> <span class="dv">3</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb40-1" title="1">alpha =<span class="st"> </span><span class="kw">seq</span>(<span class="dv">2</span>,<span class="dv">20</span>,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb40-2" title="2"><span class="co">#plot power vs alpha</span></a>
<a class="sourceLine" id="cb40-3" title="3"><span class="kw">plot</span>(alpha, <span class="kw">Pwr_Skew_NB</span>(<span class="dt">alpha =</span> alpha), <span class="dt">type =</span> <span class="st">&quot;b&quot;</span>, <span class="dt">xlab =</span> <span class="kw">bquote</span>(alpha), <span class="dt">ylab =</span> <span class="st">&quot;power&quot;</span>, <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="fl">0.1</span>)) </a>
<a class="sourceLine" id="cb40-4" title="4"><span class="kw">abline</span>(<span class="dt">h =</span> <span class="fl">.1</span>, <span class="dt">lty =</span> <span class="dv">3</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>We found that the power of the tests are really small. Using this test, it is unlikely for us to reject the hypothesis that the distribution is normal, even when a Beta distribution is used.</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb41-1" title="1">Pwr_Skew_NT =<span class="st"> </span><span class="cf">function</span>(alpha, <span class="dt">sl =</span> <span class="fl">0.1</span>, <span class="dt">n =</span> <span class="dv">30</span>, <span class="dt">m =</span> <span class="dv">2500</span>  ){</a>
<a class="sourceLine" id="cb41-2" title="2">  <span class="co"># return the estimated power</span></a>
<a class="sourceLine" id="cb41-3" title="3">  <span class="co"># alpha is the parameter in t distribution</span></a>
<a class="sourceLine" id="cb41-4" title="4">  <span class="co"># sl is the significance level</span></a>
<a class="sourceLine" id="cb41-5" title="5">  <span class="co"># n is the sample size</span></a>
<a class="sourceLine" id="cb41-6" title="6">  <span class="co"># m is the replication times</span></a>
<a class="sourceLine" id="cb41-7" title="7">  </a>
<a class="sourceLine" id="cb41-8" title="8">  N =<span class="st"> </span><span class="kw">length</span>(alpha) </a>
<a class="sourceLine" id="cb41-9" title="9"></a>
<a class="sourceLine" id="cb41-10" title="10">  pwr =<span class="st"> </span><span class="kw">numeric</span>(N) </a>
<a class="sourceLine" id="cb41-11" title="11"> </a>
<a class="sourceLine" id="cb41-12" title="12">  cv =<span class="st"> </span><span class="kw">qnorm</span>(<span class="dv">1</span><span class="op">-</span>sl<span class="op">/</span><span class="dv">2</span>, <span class="dv">0</span>, <span class="kw">sqrt</span>(<span class="dv">6</span><span class="op">*</span>(n<span class="dv">-2</span>) <span class="op">/</span><span class="st"> </span>((n<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span>(n<span class="op">+</span><span class="dv">3</span>))))      </a>
<a class="sourceLine" id="cb41-13" title="13">  <span class="co">#critical value for the skewness test</span></a>
<a class="sourceLine" id="cb41-14" title="14"></a>
<a class="sourceLine" id="cb41-15" title="15">  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N) {              <span class="co">#for each epsilon </span></a>
<a class="sourceLine" id="cb41-16" title="16">  </a>
<a class="sourceLine" id="cb41-17" title="17">    freedom =<span class="st"> </span>alpha[j] </a>
<a class="sourceLine" id="cb41-18" title="18">  </a>
<a class="sourceLine" id="cb41-19" title="19">    sktests=<span class="st"> </span><span class="kw">numeric</span>(m) </a>
<a class="sourceLine" id="cb41-20" title="20">  </a>
<a class="sourceLine" id="cb41-21" title="21">    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) {            <span class="co">#for each replicate </span></a>
<a class="sourceLine" id="cb41-22" title="22">    </a>
<a class="sourceLine" id="cb41-23" title="23">      x =<span class="st"> </span><span class="kw">rt</span>(n, <span class="dt">df =</span> freedom) </a>
<a class="sourceLine" id="cb41-24" title="24">    </a>
<a class="sourceLine" id="cb41-25" title="25">      sktests[i] =<span class="st"> </span><span class="kw">as.integer</span>(<span class="kw">abs</span>(<span class="kw">sk</span>(x)) <span class="op">&gt;=</span><span class="st"> </span>cv) </a>
<a class="sourceLine" id="cb41-26" title="26">    </a>
<a class="sourceLine" id="cb41-27" title="27">    } </a>
<a class="sourceLine" id="cb41-28" title="28">  </a>
<a class="sourceLine" id="cb41-29" title="29">  pwr[j] =<span class="st"> </span><span class="kw">mean</span>(sktests) </a>
<a class="sourceLine" id="cb41-30" title="30">  }</a>
<a class="sourceLine" id="cb41-31" title="31">  </a>
<a class="sourceLine" id="cb41-32" title="32">  <span class="kw">return</span>(pwr)</a>
<a class="sourceLine" id="cb41-33" title="33">}</a>
<a class="sourceLine" id="cb41-34" title="34"></a>
<a class="sourceLine" id="cb41-35" title="35">alpha=<span class="dv">1</span><span class="op">:</span><span class="dv">20</span></a>
<a class="sourceLine" id="cb41-36" title="36"><span class="co">#plot power vs alpha</span></a>
<a class="sourceLine" id="cb41-37" title="37"><span class="kw">plot</span>(alpha, <span class="kw">Pwr_Skew_NT</span>(<span class="dt">alpha =</span> alpha), <span class="dt">type =</span> <span class="st">&quot;b&quot;</span>, <span class="dt">xlab =</span> <span class="kw">bquote</span>(alpha), <span class="dt">ylab =</span> <span class="st">&quot;power&quot;</span>, <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>)) </a>
<a class="sourceLine" id="cb41-38" title="38"><span class="kw">abline</span>(<span class="dt">h =</span> <span class="fl">.1</span>, <span class="dt">lty =</span> <span class="dv">3</span>) </a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>For heavy-tailed distribution <span class="math inline">\(\text{}t(\nu)\)</span>, the power is big when <span class="math inline">\(\alpha\)</span> is small. However, when <span class="math inline">\(\alpha\)</span> gets large, <span class="math inline">\(\text{}t(\nu)\)</span> converges to standard normal random variable in distribution, and accordingly, the power gets smaller.</p>
<hr />
</div>
<div id="projects-6.a" class="section level3">
<h3>Projects 6.A</h3>
<p>Use Monte Carlo simulation to investigate whether the empirical Type I error rate of the <span class="math inline">\(t\)</span>-test is approximately equal to the nominal significance level <span class="math inline">\(\alpha\)</span>, when the sampled population is non-normal. The <span class="math inline">\(t\)</span>-test is robust to mild departures from normality. Discuss the simulation results for the cases where the sampled population is: (i) <span class="math inline">\(\chi^2 (1)\)</span>, (ii) Uniform<span class="math inline">\((0,2)\)</span>, and (iii) Exponential(rate<span class="math inline">\(=1\)</span>). In each case, test <span class="math inline">\(H_0 : \mu = \mu_0\)</span> vs <span class="math inline">\(H_1 : \mu\neq \mu_0\)</span>, whereµ0 is the mean of <span class="math inline">\(\chi^2 (1)\)</span>, Uniform<span class="math inline">\((0,2)\)</span>, and Exponential(<span class="math inline">\(1\)</span>), respectively.</p>
<p><span class="math inline">\(Sol.\)</span> (i) <span class="math inline">\(\chi^2 (1)\)</span></p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb42-1" title="1">Type_<span class="dv">1</span>_chisq =<span class="st"> </span><span class="cf">function</span>(sl, <span class="dt">df =</span> <span class="dv">1</span>, <span class="dt">m =</span> <span class="fl">1e4</span>, <span class="dt">n =</span> <span class="dv">50</span>){</a>
<a class="sourceLine" id="cb42-2" title="2">  <span class="co"># reutrn the empirical Type I error rate of chi square distribution</span></a>
<a class="sourceLine" id="cb42-3" title="3">  <span class="co"># sl is the significance level(sl can be a sequence)</span></a>
<a class="sourceLine" id="cb42-4" title="4">  <span class="co"># df is the degree of freedom</span></a>
<a class="sourceLine" id="cb42-5" title="5">  <span class="co"># m is the number of the replication times</span></a>
<a class="sourceLine" id="cb42-6" title="6">  <span class="co"># n is the sample size</span></a>
<a class="sourceLine" id="cb42-7" title="7">  </a>
<a class="sourceLine" id="cb42-8" title="8">  N =<span class="st"> </span><span class="kw">length</span>(sl)</a>
<a class="sourceLine" id="cb42-9" title="9">  result =<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>,N)</a>
<a class="sourceLine" id="cb42-10" title="10">  </a>
<a class="sourceLine" id="cb42-11" title="11">  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N){</a>
<a class="sourceLine" id="cb42-12" title="12">    </a>
<a class="sourceLine" id="cb42-13" title="13">    esl =<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>,n) </a>
<a class="sourceLine" id="cb42-14" title="14"></a>
<a class="sourceLine" id="cb42-15" title="15">    <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</a>
<a class="sourceLine" id="cb42-16" title="16">      x =<span class="st"> </span><span class="kw">rchisq</span>(n, <span class="dt">df =</span> <span class="dv">1</span>)                                               <span class="co"># generate the random sample</span></a>
<a class="sourceLine" id="cb42-17" title="17">      xbar =<span class="st"> </span><span class="kw">mean</span>(x)</a>
<a class="sourceLine" id="cb42-18" title="18">      q =<span class="st"> </span><span class="kw">qt</span>(<span class="dv">1</span><span class="op">-</span>sl[j]<span class="op">/</span><span class="dv">2</span>, <span class="dt">df =</span> n<span class="dv">-1</span>)                                       <span class="co"># calculate the quantile</span></a>
<a class="sourceLine" id="cb42-19" title="19">      S =<span class="st"> </span><span class="kw">var</span>(x)</a>
<a class="sourceLine" id="cb42-20" title="20">      esl[i] =<span class="st"> </span><span class="kw">mean</span>(xbar<span class="op">-</span>q<span class="op">*</span>S<span class="op">/</span><span class="kw">sqrt</span>(n) <span class="op">&gt;</span><span class="st"> </span><span class="dv">1</span> <span class="op">||</span><span class="st"> </span>xbar<span class="op">+</span>q<span class="op">*</span>S<span class="op">/</span><span class="kw">sqrt</span>(n) <span class="op">&lt;</span><span class="st"> </span><span class="dv">1</span> )        </a>
<a class="sourceLine" id="cb42-21" title="21">      <span class="co"># calculate empirical Type I error rate</span></a>
<a class="sourceLine" id="cb42-22" title="22">      <span class="co"># the mean of chi^2(1) is 1</span></a>
<a class="sourceLine" id="cb42-23" title="23">    }</a>
<a class="sourceLine" id="cb42-24" title="24">    result[j] =<span class="st"> </span><span class="kw">mean</span>(esl)</a>
<a class="sourceLine" id="cb42-25" title="25">  }</a>
<a class="sourceLine" id="cb42-26" title="26">  <span class="kw">return</span>(result)</a>
<a class="sourceLine" id="cb42-27" title="27">}</a>
<a class="sourceLine" id="cb42-28" title="28"></a>
<a class="sourceLine" id="cb42-29" title="29">sl =<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.05</span>,<span class="fl">0.1</span>,<span class="fl">0.5</span>)</a>
<a class="sourceLine" id="cb42-30" title="30">M =<span class="st"> </span><span class="kw">rbind</span>(sl, <span class="kw">Type_1_chisq</span>(sl))</a>
<a class="sourceLine" id="cb42-31" title="31"><span class="kw">rownames</span>(M) =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;significance level&quot;</span>,<span class="st">&quot;empirical type I error rate&quot;</span>)</a>
<a class="sourceLine" id="cb42-32" title="32">M</a></code></pre></div>
<pre><code>##                               [,1]   [,2]   [,3]
## significance level          0.0500 0.1000 0.5000
## empirical type I error rate 0.0783 0.0982 0.3566</code></pre>
<p>We found that empirical type I error rate is rather different from the significance level.</p>
<ol start="2" style="list-style-type: lower-roman">
<li>Uniform<span class="math inline">\((0,2)\)</span></li>
</ol>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb44-1" title="1">Type_<span class="dv">1</span>_unif =<span class="st"> </span><span class="cf">function</span>(sl, <span class="dt">minimum =</span> <span class="dv">0</span>, <span class="dt">maximum =</span> <span class="dv">2</span>, <span class="dt">m =</span> <span class="fl">1e4</span>, <span class="dt">n =</span> <span class="dv">30</span>){</a>
<a class="sourceLine" id="cb44-2" title="2">  <span class="co"># reutrn the empirical Type I error rate of uniform distribution</span></a>
<a class="sourceLine" id="cb44-3" title="3">  <span class="co"># sl is the significance level(sl can be a sequence)</span></a>
<a class="sourceLine" id="cb44-4" title="4">  <span class="co"># minimum and maximum is the minimum and maximum of the uniform distribution</span></a>
<a class="sourceLine" id="cb44-5" title="5">  <span class="co"># m is the number of the replication times</span></a>
<a class="sourceLine" id="cb44-6" title="6">  <span class="co"># n is the sample size</span></a>
<a class="sourceLine" id="cb44-7" title="7">  </a>
<a class="sourceLine" id="cb44-8" title="8">  N =<span class="st"> </span><span class="kw">length</span>(sl)</a>
<a class="sourceLine" id="cb44-9" title="9">  result =<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>,N)</a>
<a class="sourceLine" id="cb44-10" title="10">  </a>
<a class="sourceLine" id="cb44-11" title="11">  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N){</a>
<a class="sourceLine" id="cb44-12" title="12">    </a>
<a class="sourceLine" id="cb44-13" title="13">    esl =<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>,n) </a>
<a class="sourceLine" id="cb44-14" title="14"></a>
<a class="sourceLine" id="cb44-15" title="15">    <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</a>
<a class="sourceLine" id="cb44-16" title="16">      x =<span class="st"> </span><span class="kw">runif</span>(n, <span class="dt">min =</span> minimum, <span class="dt">max =</span> maximum)                                  <span class="co"># generate the random sample</span></a>
<a class="sourceLine" id="cb44-17" title="17">      xbar =<span class="st"> </span><span class="kw">mean</span>(x)</a>
<a class="sourceLine" id="cb44-18" title="18">      q =<span class="st"> </span><span class="kw">qt</span>(<span class="dv">1</span><span class="op">-</span>sl[j]<span class="op">/</span><span class="dv">2</span>, <span class="dt">df =</span> n<span class="dv">-1</span>)                                       <span class="co"># calculate the quantile</span></a>
<a class="sourceLine" id="cb44-19" title="19">      S =<span class="st"> </span><span class="kw">var</span>(x)</a>
<a class="sourceLine" id="cb44-20" title="20">      esl[i] =<span class="st"> </span><span class="kw">mean</span>(xbar<span class="op">-</span>q<span class="op">*</span>S<span class="op">/</span><span class="kw">sqrt</span>(n) <span class="op">&gt;</span><span class="st"> </span><span class="dv">1</span> <span class="op">||</span><span class="st"> </span>xbar<span class="op">+</span>q<span class="op">*</span>S<span class="op">/</span><span class="kw">sqrt</span>(n) <span class="op">&lt;</span><span class="st"> </span><span class="dv">1</span> )        </a>
<a class="sourceLine" id="cb44-21" title="21">      <span class="co"># calculate empirical Type I error rate</span></a>
<a class="sourceLine" id="cb44-22" title="22">      <span class="co"># the mean of chi^2(1) is 1</span></a>
<a class="sourceLine" id="cb44-23" title="23">    }</a>
<a class="sourceLine" id="cb44-24" title="24">    result[j] =<span class="st"> </span><span class="kw">mean</span>(esl)</a>
<a class="sourceLine" id="cb44-25" title="25">  }</a>
<a class="sourceLine" id="cb44-26" title="26">  <span class="kw">return</span>(result)</a>
<a class="sourceLine" id="cb44-27" title="27">}</a>
<a class="sourceLine" id="cb44-28" title="28"></a>
<a class="sourceLine" id="cb44-29" title="29">sl =<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.05</span>,<span class="fl">0.1</span>,<span class="fl">0.5</span>)</a>
<a class="sourceLine" id="cb44-30" title="30">M =<span class="st"> </span><span class="kw">rbind</span>(sl, <span class="kw">Type_1_unif</span>(sl))</a>
<a class="sourceLine" id="cb44-31" title="31"><span class="kw">rownames</span>(M) =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;significance level&quot;</span>,<span class="st">&quot;empirical type I error rate&quot;</span>)</a>
<a class="sourceLine" id="cb44-32" title="32">M</a></code></pre></div>
<pre><code>##                               [,1]   [,2]   [,3]
## significance level          0.0500 0.1000 0.5000
## empirical type I error rate 0.2378 0.3316 0.6861</code></pre>
<p>We found that empirical type I error rate is apparently different from the significance level.</p>
<ol start="3" style="list-style-type: lower-roman">
<li>Exponential(<span class="math inline">\(1\)</span>)</li>
</ol>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb46-1" title="1">Type_<span class="dv">1</span>_exp =<span class="st"> </span><span class="cf">function</span>(sl, <span class="dt">rate =</span> <span class="dv">1</span>, <span class="dt">m =</span> <span class="fl">1e4</span>, <span class="dt">n =</span> <span class="dv">30</span>){</a>
<a class="sourceLine" id="cb46-2" title="2">  <span class="co"># reutrn the empirical Type I error rate of uniform distribution</span></a>
<a class="sourceLine" id="cb46-3" title="3">  <span class="co"># sl is the significance level(sl can be a sequence)</span></a>
<a class="sourceLine" id="cb46-4" title="4">  <span class="co"># rate is the parameter in exponential distribution</span></a>
<a class="sourceLine" id="cb46-5" title="5">  <span class="co"># m is the number of the replication times</span></a>
<a class="sourceLine" id="cb46-6" title="6">  <span class="co"># n is the sample size</span></a>
<a class="sourceLine" id="cb46-7" title="7">  </a>
<a class="sourceLine" id="cb46-8" title="8">  N =<span class="st"> </span><span class="kw">length</span>(sl)</a>
<a class="sourceLine" id="cb46-9" title="9">  result =<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>,N)</a>
<a class="sourceLine" id="cb46-10" title="10">  </a>
<a class="sourceLine" id="cb46-11" title="11">  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N){</a>
<a class="sourceLine" id="cb46-12" title="12">    </a>
<a class="sourceLine" id="cb46-13" title="13">    esl =<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>,n) </a>
<a class="sourceLine" id="cb46-14" title="14"></a>
<a class="sourceLine" id="cb46-15" title="15">    <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</a>
<a class="sourceLine" id="cb46-16" title="16">      x =<span class="st"> </span><span class="kw">rexp</span>(n, <span class="dt">rate =</span> rate)                                 <span class="co"># generate the random sample</span></a>
<a class="sourceLine" id="cb46-17" title="17">      xbar =<span class="st"> </span><span class="kw">mean</span>(x)</a>
<a class="sourceLine" id="cb46-18" title="18">      q =<span class="st"> </span><span class="kw">qt</span>(<span class="dv">1</span><span class="op">-</span>sl[j]<span class="op">/</span><span class="dv">2</span>, <span class="dt">df =</span> n<span class="dv">-1</span>)                                       <span class="co"># calculate the quantile</span></a>
<a class="sourceLine" id="cb46-19" title="19">      S =<span class="st"> </span><span class="kw">var</span>(x)</a>
<a class="sourceLine" id="cb46-20" title="20">      esl[i] =<span class="st"> </span><span class="kw">mean</span>(xbar<span class="op">-</span>q<span class="op">*</span>S<span class="op">/</span><span class="kw">sqrt</span>(n) <span class="op">&gt;</span><span class="st"> </span><span class="dv">1</span> <span class="op">||</span><span class="st"> </span>xbar<span class="op">+</span>q<span class="op">*</span>S<span class="op">/</span><span class="kw">sqrt</span>(n) <span class="op">&lt;</span><span class="st"> </span><span class="dv">1</span> )        </a>
<a class="sourceLine" id="cb46-21" title="21">      <span class="co"># calculate empirical Type I error rate</span></a>
<a class="sourceLine" id="cb46-22" title="22">      <span class="co"># the mean of chi^2(1) is 1</span></a>
<a class="sourceLine" id="cb46-23" title="23">    }</a>
<a class="sourceLine" id="cb46-24" title="24">    result[j] =<span class="st"> </span><span class="kw">mean</span>(esl)</a>
<a class="sourceLine" id="cb46-25" title="25">  }</a>
<a class="sourceLine" id="cb46-26" title="26">  <span class="kw">return</span>(result)</a>
<a class="sourceLine" id="cb46-27" title="27">}</a>
<a class="sourceLine" id="cb46-28" title="28"></a>
<a class="sourceLine" id="cb46-29" title="29">sl =<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.05</span>,<span class="fl">0.1</span>,<span class="fl">0.5</span>)</a>
<a class="sourceLine" id="cb46-30" title="30">M =<span class="st"> </span><span class="kw">rbind</span>(sl, <span class="kw">Type_1_exp</span>(sl))</a>
<a class="sourceLine" id="cb46-31" title="31"><span class="kw">rownames</span>(M) =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;significance level&quot;</span>,<span class="st">&quot;empirical type I error rate&quot;</span>)</a>
<a class="sourceLine" id="cb46-32" title="32">M</a></code></pre></div>
<pre><code>##                               [,1]   [,2]   [,3]
## significance level          0.0500 0.1000 0.5000
## empirical type I error rate 0.1249 0.1591 0.5088</code></pre>
<p>We found that empirical type I error rate is rather different from the significance level.</p>
<p>Based on the Monte Carlo estimates above, we can say the empirical type I error rate have large difference from the significance level in the case of uniform distribution. However, in the other two cases, the difference varies when the significance level changes.</p>
<hr />
</div>
<div id="discussion" class="section level3">
<h3>Discussion</h3>
<pre><code>+ If we obtain the powers for two methods under a particular simulation setting with 10,000 experiments: say, 0.651 for one method and 0.676 for another method. Can we say the powers are different at 0.05 level?
    
    - What is the corresponding hypothesis test problem?
    
    - What test should we use? Z-test,  two-sample t-test, paired-t test or McNemar test?
    
    - What information is needed to test your hypothesis?</code></pre>
<p><span class="math inline">\(Sol.\)</span> (i) For power functions <span class="math inline">\(\pi_1\)</span> and <span class="math inline">\(\pi_2\)</span>, we need to test hypothesis <span class="math inline">\(H_0 : \pi_1(\theta) = \pi_2 (\theta)\)</span> against $H_1 : _1() _2 () $.</p>
<ol start="2" style="list-style-type: lower-roman">
<li><p>I first exlude the McNemar test because we may not have the result in a contiency table. In this question we only know the estimated powers. Then I prefer a <span class="math inline">\(t\)</span>-test to a <span class="math inline">\(Z\)</span>-test since the distribution of the empirical power may be unable to be approximated by a normal distribution. Finally, the unpaired <span class="math inline">\(t\)</span> test is more practical because the two samples of the powers may not be paired. In this question maybe we only know information (mean, variance, etc.) about these two separate samples.</p></li>
<li><p>We just need the two sample variances to carry out a unpaired <span class="math inline">\(t\)</span>-test (Welch’s t-test).</p></li>
</ol>
<hr />
</div>
</div>
</div>
<div id="homework-6" class="section level1">
<h1>Homework 6</h1>
<div id="question-5" class="section level2">
<h2>Question</h2>
<p>Exercise 7.6 and Project 7.B(Statistical Computing with R, pages 212-213).</p>
<hr />
</div>
<div id="answer-5" class="section level2">
<h2>Answer</h2>
<div id="exercise-7.6" class="section level3">
<h3>Exercise 7.6</h3>
<p>Efron and Tibshirani discuss the <span class="math inline">\(scor (bootstrap)\)</span> test score data on 88 students who took examinations in ﬁvesubjects [84, Table 7.1], [188, Table 1.2.1]. The first two tests (mechanics, vectors) were closed book and the last three tests (algebra, analysis, statistics) were open book. Each row of the data frame is a set of scores <span class="math inline">\((x_{i1},\dots,x_{i5})\)</span> for the <span class="math inline">\(i\)</span>th student. Use a panel display to display the scatter plots for each pair of test scores. Compare the plot with the sample correlation matrix. Obtain bootstrap estimates of the standard errors for each of the following estimates: <span class="math inline">\(\hat{\rho}_{12}=\hat{\rho}(\text{mec, vec})\)</span>, <span class="math inline">\(\hat{\rho}_{34}=\hat{\rho}(\text{alg, ana})\)</span>, <span class="math inline">\(\hat{\rho}_{35}=\hat{\rho}(\text{alg, sta})\)</span>, <span class="math inline">\(\hat{\rho}_{45}=\hat{\rho}(\text{ana, sta})\)</span>.</p>
<p><span class="math inline">\(Sol.\)</span></p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb49-1" title="1"><span class="kw">library</span>(bootstrap)</a>
<a class="sourceLine" id="cb49-2" title="2">k =<span class="st"> </span><span class="kw">ncol</span>(bootstrap<span class="op">::</span>scor)</a>
<a class="sourceLine" id="cb49-3" title="3">names =<span class="st"> </span><span class="kw">colnames</span>(bootstrap<span class="op">::</span>scor)</a>
<a class="sourceLine" id="cb49-4" title="4"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">3</span>))</a>
<a class="sourceLine" id="cb49-5" title="5"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>(k<span class="dv">-1</span>)){</a>
<a class="sourceLine" id="cb49-6" title="6">  <span class="cf">for</span>(j <span class="cf">in</span> (i<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>k){</a>
<a class="sourceLine" id="cb49-7" title="7">    <span class="kw">plot</span>(bootstrap<span class="op">::</span>scor[,i],bootstrap<span class="op">::</span>scor[,j],<span class="dt">sub =</span> <span class="kw">paste</span>(<span class="st">&quot;correlation&quot;</span>,<span class="st">&quot;=&quot;</span>,<span class="kw">cor</span>(bootstrap<span class="op">::</span>scor[,i],bootstrap<span class="op">::</span>scor[,j])), <span class="dt">xlab=</span><span class="kw">paste</span>(names[i]),<span class="dt">ylab=</span><span class="kw">paste</span>(names[j]) )</a>
<a class="sourceLine" id="cb49-8" title="8">  }</a>
<a class="sourceLine" id="cb49-9" title="9">}</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
<p>When the correlation is closer to <span class="math inline">\(1\)</span>, the dots on the scatter plot is more similar to a line with slope<span class="math inline">\(=1\)</span>.</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb50-1" title="1"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))</a>
<a class="sourceLine" id="cb50-2" title="2"></a>
<a class="sourceLine" id="cb50-3" title="3"></a>
<a class="sourceLine" id="cb50-4" title="4">rho =<span class="st"> </span><span class="cf">function</span>(x,i){</a>
<a class="sourceLine" id="cb50-5" title="5">  <span class="kw">return</span>(<span class="kw">cor</span>(x[i,<span class="dv">1</span>],x[i,<span class="dv">2</span>]))</a>
<a class="sourceLine" id="cb50-6" title="6">}</a>
<a class="sourceLine" id="cb50-7" title="7"></a>
<a class="sourceLine" id="cb50-8" title="8"><span class="kw">library</span>(boot)</a>
<a class="sourceLine" id="cb50-9" title="9"></a>
<a class="sourceLine" id="cb50-10" title="10"><span class="co">#boostrap estimate of cor(mec,vec)</span></a>
<a class="sourceLine" id="cb50-11" title="11"><span class="kw">sd</span>(boot<span class="op">::</span><span class="kw">boot</span>(<span class="dt">data =</span> scor[,<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>)], <span class="dt">statistic =</span> rho, <span class="dt">R=</span><span class="dv">2000</span>)<span class="op">$</span>t)</a></code></pre></div>
<pre><code>## [1] 0.07680702</code></pre>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb52-1" title="1"><span class="co">#boostrap estimate of cor(alg,ana)            </span></a>
<a class="sourceLine" id="cb52-2" title="2"><span class="kw">sd</span>(boot<span class="op">::</span><span class="kw">boot</span>(<span class="dt">data =</span> scor[,<span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">4</span>)], <span class="dt">statistic =</span> rho, <span class="dt">R=</span><span class="dv">2000</span>)<span class="op">$</span>t)</a></code></pre></div>
<pre><code>## [1] 0.04977637</code></pre>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb54-1" title="1"><span class="co">#boostrap estimate of cor(alg,sta)</span></a>
<a class="sourceLine" id="cb54-2" title="2"><span class="kw">sd</span>(boot<span class="op">::</span><span class="kw">boot</span>(<span class="dt">data =</span> scor[,<span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">5</span>)], <span class="dt">statistic =</span> rho, <span class="dt">R=</span><span class="dv">2000</span>)<span class="op">$</span>t)</a></code></pre></div>
<pre><code>## [1] 0.06005615</code></pre>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb56-1" title="1"><span class="co">#boostrap estimate of cor(ana,sta)</span></a>
<a class="sourceLine" id="cb56-2" title="2"><span class="kw">sd</span>(boot<span class="op">::</span><span class="kw">boot</span>(<span class="dt">data =</span> scor[,<span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">5</span>)], <span class="dt">statistic =</span> rho, <span class="dt">R=</span><span class="dv">2000</span>)<span class="op">$</span>t)</a></code></pre></div>
<pre><code>## [1] 0.06946518</code></pre>
<hr />
</div>
<div id="project-7.b" class="section level3">
<h3>Project 7.B</h3>
<p>Repeat Project 7.A for the sample skewness statistic. Compare the coverage rates for normal populations (skewness <span class="math inline">\(0\)</span>) and <span class="math inline">\(\chi^2(5)\)</span> distributions (positive skewness). <span class="math inline">\(Sol.\)</span></p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb58-1" title="1">sk =<span class="st"> </span><span class="cf">function</span>(x) { </a>
<a class="sourceLine" id="cb58-2" title="2">  <span class="co">#computes the sample skewness coeff. </span></a>
<a class="sourceLine" id="cb58-3" title="3">  xbar =<span class="st"> </span><span class="kw">mean</span>(x) </a>
<a class="sourceLine" id="cb58-4" title="4">  m3 =<span class="st"> </span><span class="kw">mean</span>((x <span class="op">-</span><span class="st"> </span>xbar)<span class="op">^</span><span class="dv">3</span>) </a>
<a class="sourceLine" id="cb58-5" title="5">  m2 =<span class="st"> </span><span class="kw">mean</span>((x <span class="op">-</span><span class="st"> </span>xbar)<span class="op">^</span><span class="dv">2</span>) </a>
<a class="sourceLine" id="cb58-6" title="6">  <span class="kw">return</span>( m3 <span class="op">/</span><span class="st"> </span>m2<span class="op">^</span><span class="fl">1.5</span> ) </a>
<a class="sourceLine" id="cb58-7" title="7">}</a>
<a class="sourceLine" id="cb58-8" title="8"></a>
<a class="sourceLine" id="cb58-9" title="9">sk_boot=<span class="st"> </span><span class="cf">function</span>(x,i){</a>
<a class="sourceLine" id="cb58-10" title="10">  <span class="co">#function used for bootstrap </span></a>
<a class="sourceLine" id="cb58-11" title="11">  <span class="kw">return</span>( <span class="kw">sk</span>(x[i,]) )</a>
<a class="sourceLine" id="cb58-12" title="12">}</a>
<a class="sourceLine" id="cb58-13" title="13"></a>
<a class="sourceLine" id="cb58-14" title="14"></a>
<a class="sourceLine" id="cb58-15" title="15">sk_cp_norm =<span class="st"> </span><span class="cf">function</span>(<span class="dt">n =</span> <span class="dv">30</span>, <span class="dt">m =</span> <span class="dv">1000</span>, <span class="dt">R =</span> <span class="dv">200</span>, <span class="dt">conf =</span> <span class="fl">0.95</span>){</a>
<a class="sourceLine" id="cb58-16" title="16">  <span class="co"># return the four estimated coverage probabilities of the four intervals for nomal populations</span></a>
<a class="sourceLine" id="cb58-17" title="17">  <span class="co"># m is the repeating times of this estimation</span></a>
<a class="sourceLine" id="cb58-18" title="18">  <span class="co"># R is the number of bootstrap replicates</span></a>
<a class="sourceLine" id="cb58-19" title="19">  <span class="co"># conf is the confidence level</span></a>
<a class="sourceLine" id="cb58-20" title="20">  </a>
<a class="sourceLine" id="cb58-21" title="21">  cp_norm =<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>,m)</a>
<a class="sourceLine" id="cb58-22" title="22">  cp_perc =<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>,m)</a>
<a class="sourceLine" id="cb58-23" title="23">  cp_basic =<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>,m)</a>
<a class="sourceLine" id="cb58-24" title="24">  </a>
<a class="sourceLine" id="cb58-25" title="25">  </a>
<a class="sourceLine" id="cb58-26" title="26">  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</a>
<a class="sourceLine" id="cb58-27" title="27">    </a>
<a class="sourceLine" id="cb58-28" title="28">    x =<span class="st"> </span><span class="kw">as.matrix</span>(<span class="kw">rnorm</span>(n))</a>
<a class="sourceLine" id="cb58-29" title="29">    </a>
<a class="sourceLine" id="cb58-30" title="30">    obj =<span class="st"> </span><span class="kw">boot.ci</span>(<span class="kw">boot</span>(<span class="dt">data =</span> x, <span class="dt">statistic =</span> sk_boot, <span class="dt">R =</span>R), <span class="dt">conf =</span> conf, <span class="dt">type =</span> <span class="kw">c</span>(<span class="st">&quot;norm&quot;</span>, <span class="st">&quot;basic&quot;</span>, <span class="st">&quot;perc&quot;</span>))</a>
<a class="sourceLine" id="cb58-31" title="31">    </a>
<a class="sourceLine" id="cb58-32" title="32">    <span class="co"># the skewness of a normal distribution is 0</span></a>
<a class="sourceLine" id="cb58-33" title="33">    cp_norm[i] =<span class="st"> </span>obj<span class="op">$</span>norm[<span class="dv">2</span>] <span class="op">&lt;=</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;&amp;</span><span class="st"> </span>obj<span class="op">$</span>norm[<span class="dv">3</span>] <span class="op">&gt;=</span><span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb58-34" title="34">    cp_perc[i] =<span class="st"> </span>obj<span class="op">$</span>perc[<span class="dv">4</span>] <span class="op">&lt;=</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;&amp;</span><span class="st"> </span>obj<span class="op">$</span>perc[<span class="dv">5</span>] <span class="op">&gt;=</span><span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb58-35" title="35">    cp_basic[i] =<span class="st"> </span>obj<span class="op">$</span>basic[<span class="dv">4</span>] <span class="op">&lt;=</span><span class="st"> </span><span class="dv">0</span> <span class="op">&amp;&amp;</span><span class="st"> </span>obj<span class="op">$</span>basic[<span class="dv">5</span>] <span class="op">&gt;=</span><span class="st"> </span><span class="dv">0</span></a>
<a class="sourceLine" id="cb58-36" title="36">    </a>
<a class="sourceLine" id="cb58-37" title="37">  }</a>
<a class="sourceLine" id="cb58-38" title="38">  </a>
<a class="sourceLine" id="cb58-39" title="39">  result =<span class="kw">c</span>(<span class="kw">mean</span>(cp_norm),<span class="kw">mean</span>(cp_perc),<span class="kw">mean</span>(cp_basic))</a>
<a class="sourceLine" id="cb58-40" title="40">  <span class="kw">return</span>(result) </a>
<a class="sourceLine" id="cb58-41" title="41">}</a>
<a class="sourceLine" id="cb58-42" title="42"></a>
<a class="sourceLine" id="cb58-43" title="43">sk_cp_chisq =<span class="st"> </span><span class="cf">function</span>(<span class="dt">n =</span> <span class="dv">30</span>, <span class="dt">m =</span> <span class="dv">1000</span>, <span class="dt">R =</span> <span class="dv">200</span>, <span class="dt">conf =</span> <span class="fl">0.95</span>){</a>
<a class="sourceLine" id="cb58-44" title="44">  </a>
<a class="sourceLine" id="cb58-45" title="45">  cp_norm =<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>,m)</a>
<a class="sourceLine" id="cb58-46" title="46">  cp_perc =<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>,m)</a>
<a class="sourceLine" id="cb58-47" title="47">  cp_basic =<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>,m)</a>
<a class="sourceLine" id="cb58-48" title="48">  </a>
<a class="sourceLine" id="cb58-49" title="49">  </a>
<a class="sourceLine" id="cb58-50" title="50">  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</a>
<a class="sourceLine" id="cb58-51" title="51">    </a>
<a class="sourceLine" id="cb58-52" title="52">    x =<span class="st"> </span><span class="kw">as.matrix</span>(<span class="kw">rchisq</span>(n, <span class="dt">df =</span> <span class="dv">5</span>))</a>
<a class="sourceLine" id="cb58-53" title="53">    </a>
<a class="sourceLine" id="cb58-54" title="54">    obj =<span class="st"> </span><span class="kw">boot.ci</span>(<span class="kw">boot</span>(<span class="dt">data =</span> x, <span class="dt">statistic =</span> sk_boot, <span class="dt">R =</span>R), <span class="dt">conf =</span> conf, <span class="dt">type =</span> <span class="kw">c</span>(<span class="st">&quot;norm&quot;</span>, <span class="st">&quot;basic&quot;</span>, <span class="st">&quot;perc&quot;</span>))</a>
<a class="sourceLine" id="cb58-55" title="55">    </a>
<a class="sourceLine" id="cb58-56" title="56">    <span class="co"># the skewness of chi square distribution  is 2*sqrt(2/degrees of freedom)</span></a>
<a class="sourceLine" id="cb58-57" title="57">    cp_norm[i] =<span class="st"> </span>obj<span class="op">$</span>norm[<span class="dv">2</span>] <span class="op">&lt;=</span><span class="st"> </span><span class="dv">2</span><span class="op">*</span><span class="kw">sqrt</span>(<span class="dv">2</span><span class="op">/</span><span class="dv">5</span>) <span class="op">&amp;&amp;</span><span class="st"> </span>obj<span class="op">$</span>norm[<span class="dv">3</span>] <span class="op">&gt;=</span><span class="st"> </span><span class="dv">2</span><span class="op">*</span><span class="kw">sqrt</span>(<span class="dv">2</span><span class="op">/</span><span class="dv">5</span>)</a>
<a class="sourceLine" id="cb58-58" title="58">    cp_perc[i] =<span class="st"> </span>obj<span class="op">$</span>perc[<span class="dv">4</span>] <span class="op">&lt;=</span><span class="st"> </span><span class="dv">2</span><span class="op">*</span><span class="kw">sqrt</span>(<span class="dv">2</span><span class="op">/</span><span class="dv">5</span>) <span class="op">&amp;&amp;</span><span class="st"> </span>obj<span class="op">$</span>perc[<span class="dv">5</span>] <span class="op">&gt;=</span><span class="st"> </span><span class="dv">2</span><span class="op">*</span><span class="kw">sqrt</span>(<span class="dv">2</span><span class="op">/</span><span class="dv">5</span>)</a>
<a class="sourceLine" id="cb58-59" title="59">    cp_basic[i] =<span class="st"> </span>obj<span class="op">$</span>basic[<span class="dv">4</span>] <span class="op">&lt;=</span><span class="st"> </span><span class="dv">2</span><span class="op">*</span><span class="kw">sqrt</span>(<span class="dv">2</span><span class="op">/</span><span class="dv">5</span>) <span class="op">&amp;&amp;</span><span class="st"> </span>obj<span class="op">$</span>basic[<span class="dv">5</span>] <span class="op">&gt;=</span><span class="st"> </span><span class="dv">2</span><span class="op">*</span><span class="kw">sqrt</span>(<span class="dv">2</span><span class="op">/</span><span class="dv">5</span>)</a>
<a class="sourceLine" id="cb58-60" title="60">    </a>
<a class="sourceLine" id="cb58-61" title="61">  }</a>
<a class="sourceLine" id="cb58-62" title="62">  </a>
<a class="sourceLine" id="cb58-63" title="63">  result =<span class="st"> </span><span class="kw">c</span>(<span class="kw">mean</span>(cp_norm),<span class="kw">mean</span>(cp_perc),<span class="kw">mean</span>(cp_basic))</a>
<a class="sourceLine" id="cb58-64" title="64">  <span class="kw">return</span>(result) </a>
<a class="sourceLine" id="cb58-65" title="65">}</a>
<a class="sourceLine" id="cb58-66" title="66"></a>
<a class="sourceLine" id="cb58-67" title="67">compare =<span class="st"> </span><span class="cf">function</span>(<span class="dt">n =</span> <span class="dv">30</span>, <span class="dt">m =</span> <span class="dv">1000</span>, <span class="dt">R =</span> <span class="dv">200</span>, <span class="dt">conf =</span> <span class="fl">0.95</span>){</a>
<a class="sourceLine" id="cb58-68" title="68">  <span class="co"># compare the results and construct a table</span></a>
<a class="sourceLine" id="cb58-69" title="69">  r1 =<span class="st"> </span><span class="kw">sk_cp_norm</span>(<span class="dt">n=</span>n, <span class="dt">m=</span>m, <span class="dt">R=</span>R, <span class="dt">conf =</span> conf)</a>
<a class="sourceLine" id="cb58-70" title="70">  r2 =<span class="st"> </span><span class="kw">sk_cp_chisq</span>(<span class="dt">n=</span>n, <span class="dt">m=</span>m, <span class="dt">R=</span>R, <span class="dt">conf =</span> conf)</a>
<a class="sourceLine" id="cb58-71" title="71">  result =<span class="st"> </span><span class="kw">rbind</span>(r1,r2)</a>
<a class="sourceLine" id="cb58-72" title="72">  <span class="kw">rownames</span>(result) =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;normal&quot;</span>,<span class="st">&quot;chi sqaure&quot;</span>)</a>
<a class="sourceLine" id="cb58-73" title="73">  <span class="kw">colnames</span>(result) =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;normal&quot;</span>,<span class="st">&quot;precentile&quot;</span>,<span class="st">&quot;basic&quot;</span>)</a>
<a class="sourceLine" id="cb58-74" title="74">  knitr<span class="op">::</span><span class="kw">kable</span>(result)</a>
<a class="sourceLine" id="cb58-75" title="75">}</a>
<a class="sourceLine" id="cb58-76" title="76"></a>
<a class="sourceLine" id="cb58-77" title="77"><span class="kw">compare</span>(<span class="dt">n =</span> <span class="dv">30</span>, <span class="dt">m=</span><span class="dv">1000</span>, <span class="dt">R =</span> <span class="dv">200</span>, <span class="dt">conf =</span> <span class="fl">0.95</span>)</a></code></pre></div>
<table>
<thead>
<tr class="header">
<th></th>
<th align="right">normal</th>
<th align="right">precentile</th>
<th align="right">basic</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>normal</td>
<td align="right">0.895</td>
<td align="right">0.953</td>
<td align="right">0.876</td>
</tr>
<tr class="even">
<td>chi sqaure</td>
<td align="right">0.702</td>
<td align="right">0.686</td>
<td align="right">0.687</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb59-1" title="1"><span class="kw">compare</span>(<span class="dt">n =</span> <span class="dv">30</span>, <span class="dt">m=</span><span class="dv">1000</span>, <span class="dt">R =</span> <span class="dv">200</span>, <span class="dt">conf =</span> <span class="fl">0.9</span>)</a></code></pre></div>
<table>
<thead>
<tr class="header">
<th></th>
<th align="right">normal</th>
<th align="right">precentile</th>
<th align="right">basic</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>normal</td>
<td align="right">0.770</td>
<td align="right">0.885</td>
<td align="right">0.752</td>
</tr>
<tr class="even">
<td>chi sqaure</td>
<td align="right">0.688</td>
<td align="right">0.664</td>
<td align="right">0.669</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb60-1" title="1"><span class="kw">compare</span>(<span class="dt">n =</span> <span class="dv">30</span>, <span class="dt">m=</span><span class="dv">1000</span>, <span class="dt">R =</span> <span class="dv">200</span>, <span class="dt">conf =</span> <span class="fl">0.5</span>)</a></code></pre></div>
<table>
<thead>
<tr class="header">
<th></th>
<th align="right">normal</th>
<th align="right">precentile</th>
<th align="right">basic</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>normal</td>
<td align="right">0.377</td>
<td align="right">0.473</td>
<td align="right">0.372</td>
</tr>
<tr class="even">
<td>chi sqaure</td>
<td align="right">0.289</td>
<td align="right">0.320</td>
<td align="right">0.289</td>
</tr>
</tbody>
</table>
<p>We found that the coverage rates for the normal distribution is much closer to the confidence level we set, comparing to that for the chi square distribution.</p>
<hr />
</div>
</div>
</div>
<div id="homework-7" class="section level1">
<h1>Homework 7</h1>
<div id="question-6" class="section level2">
<h2>Question</h2>
<p>Exercise 7.8 and 7.10 (Statistical Computing with R, page 213).</p>
</div>
<div id="answer-6" class="section level2">
<h2>Answer</h2>
<div id="exercise-7.8" class="section level3">
<h3>Exercise 7.8</h3>
<p>Refer to Exercise 7.7. Obtain the jackknife estimates of bias and standard error of <span class="math inline">\(\hat{\theta}\)</span>.</p>
<p><span class="math inline">\(Sol.\)</span></p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb61-1" title="1">theta2 =<span class="st"> </span><span class="cf">function</span>(xdata){                     <span class="co"># function used to calculate theta.hat</span></a>
<a class="sourceLine" id="cb61-2" title="2">  vec =<span class="st"> </span><span class="kw">eigen</span>(<span class="kw">cov</span>(xdata))<span class="op">$</span>values</a>
<a class="sourceLine" id="cb61-3" title="3">  <span class="kw">return</span>(vec[<span class="dv">1</span>]<span class="op">/</span><span class="kw">sum</span>(vec))</a>
<a class="sourceLine" id="cb61-4" title="4">}</a>
<a class="sourceLine" id="cb61-5" title="5"></a>
<a class="sourceLine" id="cb61-6" title="6"><span class="kw">library</span>(bootstrap)</a>
<a class="sourceLine" id="cb61-7" title="7">xdata =<span class="st"> </span><span class="kw">as.matrix</span>(scor)</a>
<a class="sourceLine" id="cb61-8" title="8">n =<span class="st"> </span><span class="kw">nrow</span>(xdata)</a>
<a class="sourceLine" id="cb61-9" title="9"></a>
<a class="sourceLine" id="cb61-10" title="10">theta.hat =<span class="st"> </span><span class="kw">theta2</span>(xdata)</a>
<a class="sourceLine" id="cb61-11" title="11"></a>
<a class="sourceLine" id="cb61-12" title="12">theta.jack=<span class="kw">numeric</span>(n)</a>
<a class="sourceLine" id="cb61-13" title="13"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){</a>
<a class="sourceLine" id="cb61-14" title="14">  theta.jack[i] =<span class="st"> </span><span class="kw">theta2</span>(xdata[<span class="op">-</span>i,])         </a>
<a class="sourceLine" id="cb61-15" title="15">}</a>
<a class="sourceLine" id="cb61-16" title="16"></a>
<a class="sourceLine" id="cb61-17" title="17">(n<span class="dv">-1</span>) <span class="op">*</span><span class="st"> </span>(<span class="kw">mean</span>(theta.jack) <span class="op">-</span><span class="st"> </span>theta.hat)          <span class="co">#bias of Jacknife</span></a></code></pre></div>
<pre><code>## [1] 0.001069139</code></pre>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb63-1" title="1"><span class="kw">sqrt</span>((n<span class="dv">-1</span>)<span class="op">/</span>n <span class="op">*</span><span class="st"> </span><span class="kw">sum</span>((theta.jack <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(theta.jack))<span class="op">^</span><span class="dv">2</span>))        <span class="co">#standard error of Jacknife</span></a></code></pre></div>
<pre><code>## [1] 0.04955231</code></pre>
</div>
<div id="exercise-7.10" class="section level3">
<h3>Exercise 7.10</h3>
<p>In Example 7.18, leave-one-out (n-fold) cross validation was used to select the best fitting model. Repeat the analysis replacing the Log-Log model with a cubic polynomial model. Which of the four models is selected by the cross validation procedure? Which model is selected according to maximum adjusted <span class="math inline">\(R^2\)</span>?</p>
<p><span class="math inline">\(Sol.\)</span> We copy the code from Example 7.18 and replace the Log-log model with the cubic polynomial model.</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb65-1" title="1"><span class="kw">library</span>(lattice)</a></code></pre></div>
<pre><code>## 
## 载入程辑包：&#39;lattice&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:boot&#39;:
## 
##     melanoma</code></pre>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb68-1" title="1"><span class="kw">library</span>(DAAG) </a>
<a class="sourceLine" id="cb68-2" title="2"><span class="kw">attach</span>(ironslag)</a>
<a class="sourceLine" id="cb68-3" title="3"></a>
<a class="sourceLine" id="cb68-4" title="4">n =<span class="st"> </span><span class="kw">length</span>(magnetic) <span class="co">#in DAAG ironslag </span></a>
<a class="sourceLine" id="cb68-5" title="5">e1 =<span class="st"> </span>e2 =<span class="st"> </span>e3 =<span class="st"> </span>e4 =<span class="st"> </span><span class="kw">numeric</span>(n)</a>
<a class="sourceLine" id="cb68-6" title="6"></a>
<a class="sourceLine" id="cb68-7" title="7"><span class="co"># for n-fold cross validation # fit models on leave-one-out samples </span></a>
<a class="sourceLine" id="cb68-8" title="8"><span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n) { </a>
<a class="sourceLine" id="cb68-9" title="9">  y =<span class="st"> </span>magnetic[<span class="op">-</span>k] </a>
<a class="sourceLine" id="cb68-10" title="10">  x =<span class="st"> </span>chemical[<span class="op">-</span>k]</a>
<a class="sourceLine" id="cb68-11" title="11">  </a>
<a class="sourceLine" id="cb68-12" title="12">  J1 =<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x) </a>
<a class="sourceLine" id="cb68-13" title="13">  yhat1 =<span class="st"> </span>J1<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J1<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[k] </a>
<a class="sourceLine" id="cb68-14" title="14">  e1[k] =<span class="st"> </span>magnetic[k] <span class="op">-</span><span class="st"> </span>yhat1</a>
<a class="sourceLine" id="cb68-15" title="15"></a>
<a class="sourceLine" id="cb68-16" title="16">  J2 =<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(x<span class="op">^</span><span class="dv">2</span>)) </a>
<a class="sourceLine" id="cb68-17" title="17">  yhat2 =<span class="st"> </span>J2<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J2<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[k] <span class="op">+</span><span class="st"> </span>J2<span class="op">$</span>coef[<span class="dv">3</span>] <span class="op">*</span><span class="st"> </span>chemical[k]<span class="op">^</span><span class="dv">2</span> </a>
<a class="sourceLine" id="cb68-18" title="18">  e2[k] =<span class="st"> </span>magnetic[k] <span class="op">-</span><span class="st"> </span>yhat2</a>
<a class="sourceLine" id="cb68-19" title="19"></a>
<a class="sourceLine" id="cb68-20" title="20">  J3 =<span class="st"> </span><span class="kw">lm</span>(<span class="kw">log</span>(y) <span class="op">~</span><span class="st"> </span>x) </a>
<a class="sourceLine" id="cb68-21" title="21">  logyhat3 =<span class="st"> </span>J3<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J3<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[k] </a>
<a class="sourceLine" id="cb68-22" title="22">  yhat3 =<span class="st"> </span><span class="kw">exp</span>(logyhat3) </a>
<a class="sourceLine" id="cb68-23" title="23">  e3[k] =<span class="st"> </span>magnetic[k] <span class="op">-</span><span class="st"> </span>yhat3</a>
<a class="sourceLine" id="cb68-24" title="24">  </a>
<a class="sourceLine" id="cb68-25" title="25">  <span class="co"># cubic polynomial model</span></a>
<a class="sourceLine" id="cb68-26" title="26">  J4 =<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span><span class="kw">poly</span>(x,<span class="dv">3</span>,<span class="dt">raw=</span>T)) </a>
<a class="sourceLine" id="cb68-27" title="27">  yhat4 =<span class="st"> </span>J4<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J4<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[k] <span class="op">+</span><span class="st"> </span>J4<span class="op">$</span>coef[<span class="dv">3</span>] <span class="op">*</span><span class="st"> </span>chemical[k]<span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span>J4<span class="op">$</span>coef[<span class="dv">4</span>] <span class="op">*</span><span class="st"> </span>chemical[k]<span class="op">^</span><span class="dv">3</span></a>
<a class="sourceLine" id="cb68-28" title="28">  e4[k] =<span class="st"> </span>magnetic[k] <span class="op">-</span><span class="st"> </span>yhat4</a>
<a class="sourceLine" id="cb68-29" title="29"></a>
<a class="sourceLine" id="cb68-30" title="30">} </a>
<a class="sourceLine" id="cb68-31" title="31"></a>
<a class="sourceLine" id="cb68-32" title="32"><span class="kw">c</span>(<span class="kw">mean</span>(e1<span class="op">^</span><span class="dv">2</span>), <span class="kw">mean</span>(e2<span class="op">^</span><span class="dv">2</span>), <span class="kw">mean</span>(e3<span class="op">^</span><span class="dv">2</span>), <span class="kw">mean</span>(e4<span class="op">^</span><span class="dv">2</span>)) </a></code></pre></div>
<pre><code>## [1] 19.55644 17.85248 18.44188 18.17756</code></pre>
<p>By the cross-validation procedure, we should select the quadratic model.</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb70-1" title="1">y =<span class="st"> </span>magnetic</a>
<a class="sourceLine" id="cb70-2" title="2">x =<span class="st"> </span>chemical</a>
<a class="sourceLine" id="cb70-3" title="3">r =<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>,<span class="dv">4</span>)</a>
<a class="sourceLine" id="cb70-4" title="4"></a>
<a class="sourceLine" id="cb70-5" title="5">L1 =<span class="st"> </span><span class="kw">lm</span>(y<span class="op">~</span>x)</a>
<a class="sourceLine" id="cb70-6" title="6">r[<span class="dv">1</span>] =<span class="st"> </span><span class="kw">summary</span>(L1)<span class="op">$</span>adj.r.squared <span class="co"># extract adjusted R^2</span></a>
<a class="sourceLine" id="cb70-7" title="7"></a>
<a class="sourceLine" id="cb70-8" title="8">L2 =<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(x<span class="op">^</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb70-9" title="9">r[<span class="dv">2</span>] =<span class="st"> </span><span class="kw">summary</span>(L2)<span class="op">$</span>adj.r.squared</a>
<a class="sourceLine" id="cb70-10" title="10"></a>
<a class="sourceLine" id="cb70-11" title="11">L3 =<span class="st"> </span><span class="kw">lm</span>(<span class="kw">log</span>(y) <span class="op">~</span><span class="st"> </span>x) </a>
<a class="sourceLine" id="cb70-12" title="12">r[<span class="dv">3</span>] =<span class="st"> </span><span class="kw">summary</span>(L3)<span class="op">$</span>adj.r.squared</a>
<a class="sourceLine" id="cb70-13" title="13"></a>
<a class="sourceLine" id="cb70-14" title="14">L4 =<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span><span class="kw">poly</span>(x,<span class="dv">3</span>,<span class="dt">raw=</span>T)) </a>
<a class="sourceLine" id="cb70-15" title="15">r[<span class="dv">4</span>] =<span class="st"> </span><span class="kw">summary</span>(L4)<span class="op">$</span>adj.r.squared</a>
<a class="sourceLine" id="cb70-16" title="16"></a>
<a class="sourceLine" id="cb70-17" title="17">r</a></code></pre></div>
<pre><code>## [1] 0.5281545 0.5768151 0.5280556 0.5740396</code></pre>
<p>We also should choose the quadratic model according to maximum adjusted <span class="math inline">\(R^2\)</span>.</p>
<hr />
</div>
</div>
</div>
<div id="homework-8" class="section level1">
<h1>Homework 8</h1>
<div id="question-7" class="section level2">
<h2>Question</h2>
<p>Exercise 8.3 (Statistical Computing with R, page 243) and slides page 31.</p>
<hr />
</div>
<div id="answer-7" class="section level2">
<h2>Answer</h2>
<div id="exercise-8.3" class="section level3">
<h3>Exercise 8.3</h3>
<p>The Count 5 test for equal variances in Section 6.4 is based on the maximum number of extreme points. Example 6.15 shows that the Count 5 criterion is not applicable for unequal sample sizes. Implement a permutation test for equal variance based on the maximum number of extreme points that applies when sample sizes are not necessarily equal.</p>
<p><span class="math inline">\(Sol.\)</span> If <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> have unequal sample sizes, we assume the the sample size of <span class="math inline">\(X\)</span> is <span class="math inline">\(m\)</span>, the sample size of <span class="math inline">\(Y\)</span> is <span class="math inline">\(N\)</span>, and , without loss of generality, <span class="math inline">\(m&lt;n\)</span>. Then, for <span class="math inline">\(Z=c(X,Y)\)</span>, we let the statistic <span class="math display">\[
\hat{\theta}(Z,\nu) = maxout(Z[1:m],Z[(m+1):2m])
\]</span><br />
and do a permutation test. (See Page 177 on <span class="math inline">\(\textit{Statistical Computing with R}\)</span> for details of <span class="math inline">\(maxout\)</span>.) Notice that this statistic favours <span class="math inline">\(H_a\)</span> when <span class="math inline">\(\theta\)</span> is large.(See page 7 of Prof. Zhang’s ppt for details.) Then</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb72-1" title="1">maxout &lt;-<span class="st"> </span><span class="cf">function</span>(x, y) { </a>
<a class="sourceLine" id="cb72-2" title="2">  <span class="co"># copied from Page 177</span></a>
<a class="sourceLine" id="cb72-3" title="3">  X &lt;-<span class="st"> </span>x <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(x) </a>
<a class="sourceLine" id="cb72-4" title="4">  Y &lt;-<span class="st"> </span>y <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(y) </a>
<a class="sourceLine" id="cb72-5" title="5">  outx &lt;-<span class="st"> </span><span class="kw">sum</span>(X <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(Y)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(X <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(Y)) </a>
<a class="sourceLine" id="cb72-6" title="6">  outy &lt;-<span class="st"> </span><span class="kw">sum</span>(Y <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(X)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(Y <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(X)) </a>
<a class="sourceLine" id="cb72-7" title="7">  <span class="kw">return</span>(<span class="kw">max</span>(<span class="kw">c</span>(outx, outy))) </a>
<a class="sourceLine" id="cb72-8" title="8">}</a>
<a class="sourceLine" id="cb72-9" title="9"></a>
<a class="sourceLine" id="cb72-10" title="10">per_count5test =<span class="st"> </span><span class="cf">function</span>(x,y,<span class="dt">N=</span><span class="dv">999</span>, <span class="dt">alpha =</span> <span class="fl">0.05</span>){</a>
<a class="sourceLine" id="cb72-11" title="11">  <span class="co"># N is the number of the permutations</span></a>
<a class="sourceLine" id="cb72-12" title="12">  <span class="co"># alpha is the significance level</span></a>
<a class="sourceLine" id="cb72-13" title="13">  <span class="co"># return 0 if we accept that X and Y are from same distribution(accept H_0), and return 1 otherwise(reject H_0) </span></a>
<a class="sourceLine" id="cb72-14" title="14">  </a>
<a class="sourceLine" id="cb72-15" title="15">  <span class="cf">if</span>(<span class="kw">length</span>(x)<span class="op">&lt;=</span><span class="kw">length</span>(y)){</a>
<a class="sourceLine" id="cb72-16" title="16">    m =<span class="st"> </span><span class="kw">length</span>(x)</a>
<a class="sourceLine" id="cb72-17" title="17">    n =<span class="st"> </span><span class="kw">length</span>(y)</a>
<a class="sourceLine" id="cb72-18" title="18">    z =<span class="st"> </span><span class="kw">c</span>(x,y)</a>
<a class="sourceLine" id="cb72-19" title="19">    theta =<span class="st"> </span><span class="kw">maxout</span>(x,y)</a>
<a class="sourceLine" id="cb72-20" title="20">  }</a>
<a class="sourceLine" id="cb72-21" title="21">  <span class="cf">else</span>{     </a>
<a class="sourceLine" id="cb72-22" title="22">    <span class="co">#if X has more samples than Y, we exchange them</span></a>
<a class="sourceLine" id="cb72-23" title="23">    m =<span class="st"> </span><span class="kw">length</span>(y)</a>
<a class="sourceLine" id="cb72-24" title="24">    n =<span class="st"> </span><span class="kw">length</span>(x)</a>
<a class="sourceLine" id="cb72-25" title="25">    z =<span class="st"> </span><span class="kw">c</span>(y,x)</a>
<a class="sourceLine" id="cb72-26" title="26">    theta =<span class="st"> </span><span class="kw">maxout</span>(y,x)</a>
<a class="sourceLine" id="cb72-27" title="27">  }</a>
<a class="sourceLine" id="cb72-28" title="28">  </a>
<a class="sourceLine" id="cb72-29" title="29">  theta_hat =<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>,N)</a>
<a class="sourceLine" id="cb72-30" title="30">  </a>
<a class="sourceLine" id="cb72-31" title="31">  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N){</a>
<a class="sourceLine" id="cb72-32" title="32">    k =<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span>(m<span class="op">+</span>n), <span class="dt">size =</span> <span class="dv">2</span><span class="op">*</span>m, <span class="dt">replace =</span> F)</a>
<a class="sourceLine" id="cb72-33" title="33">    z1 =<span class="st"> </span>z[k]</a>
<a class="sourceLine" id="cb72-34" title="34">    x1 =<span class="st"> </span>z1[<span class="dv">1</span><span class="op">:</span>m]</a>
<a class="sourceLine" id="cb72-35" title="35">    y1 =<span class="st"> </span>z[(m<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>(<span class="dv">2</span><span class="op">*</span>m)]</a>
<a class="sourceLine" id="cb72-36" title="36">    </a>
<a class="sourceLine" id="cb72-37" title="37">    <span class="co"># Calculate the maxout for every permutation</span></a>
<a class="sourceLine" id="cb72-38" title="38">    theta_hat[i] =<span class="st"> </span><span class="kw">maxout</span>(x1, y1)</a>
<a class="sourceLine" id="cb72-39" title="39">  }</a>
<a class="sourceLine" id="cb72-40" title="40">  </a>
<a class="sourceLine" id="cb72-41" title="41">  <span class="co"># calculate the empirical p value, see Page 217 for details</span></a>
<a class="sourceLine" id="cb72-42" title="42">  p =<span class="st"> </span>(<span class="dv">1</span><span class="op">+</span><span class="kw">sum</span>(theta_hat<span class="op">&gt;=</span>theta))<span class="op">/</span>(N<span class="op">+</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb72-43" title="43">  </a>
<a class="sourceLine" id="cb72-44" title="44">  <span class="co"># alpha = 0.05 is the desired significance level</span></a>
<a class="sourceLine" id="cb72-45" title="45">  <span class="kw">return</span>(<span class="kw">as.integer</span>(p <span class="op">&lt;=</span><span class="st"> </span>alpha))</a>
<a class="sourceLine" id="cb72-46" title="46">}</a></code></pre></div>
<p>We then redo exmaple 6.15 and calculate the empirical I error.</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb73-1" title="1">n1 =<span class="st"> </span><span class="dv">20</span></a>
<a class="sourceLine" id="cb73-2" title="2">n2 =<span class="st"> </span><span class="dv">30</span></a>
<a class="sourceLine" id="cb73-3" title="3">m =<span class="st"> </span><span class="fl">1e4</span></a>
<a class="sourceLine" id="cb73-4" title="4">D =<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>,m)</a>
<a class="sourceLine" id="cb73-5" title="5"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</a>
<a class="sourceLine" id="cb73-6" title="6">  D[i] =<span class="st"> </span><span class="kw">per_count5test</span>(<span class="kw">rnorm</span>(n1),<span class="kw">rnorm</span>(n2))</a>
<a class="sourceLine" id="cb73-7" title="7">}</a>
<a class="sourceLine" id="cb73-8" title="8"><span class="kw">mean</span>(D)</a></code></pre></div>
<pre><code>## [1] 0.1799</code></pre>
<p>The result is bad…</p>
<p>Finally, We give an example in estimating the power of the test. Here the sample distribtion are <span class="math inline">\(N(0,1)\)</span> and <span class="math inline">\(\chi_1^2\)</span>.</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb75-1" title="1">n1 =<span class="st"> </span><span class="dv">20</span></a>
<a class="sourceLine" id="cb75-2" title="2">n2 =<span class="st"> </span><span class="dv">30</span></a>
<a class="sourceLine" id="cb75-3" title="3">m =<span class="st"> </span><span class="fl">1e4</span></a>
<a class="sourceLine" id="cb75-4" title="4">D =<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>,m)</a>
<a class="sourceLine" id="cb75-5" title="5"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</a>
<a class="sourceLine" id="cb75-6" title="6">  D[i] =<span class="st"> </span><span class="kw">per_count5test</span>(<span class="kw">rnorm</span>(n1),<span class="kw">rchisq</span>(n2, <span class="dt">df=</span><span class="dv">1</span>))</a>
<a class="sourceLine" id="cb75-7" title="7">}</a>
<a class="sourceLine" id="cb75-8" title="8"><span class="co"># estimate the power</span></a>
<a class="sourceLine" id="cb75-9" title="9"><span class="kw">mean</span>(D)</a></code></pre></div>
<pre><code>## [1] 0.0726</code></pre>
<hr />
</div>
<div id="slides-page-31" class="section level3">
<h3>slides page 31</h3>
<ul>
<li><p>Power comparison (distance correlation test versus ball covariance test)</p>
<ul>
<li>Model 1: <span class="math inline">\(Y=X/4+e\)</span></li>
<li>Model 2: <span class="math inline">\(Y=X/4\times e\)</span></li>
<li><span class="math inline">\(X\sim N(0_2,I_2)\)</span>, <span class="math inline">\(e\sim N(0_2,I_2)\)</span>, <span class="math inline">\(X\)</span> and <span class="math inline">\(e\)</span> are independent.</li>
</ul></li>
</ul>
<p><span class="math inline">\(Sol.\)</span></p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb77-1" title="1"><span class="kw">library</span>(Ball)</a>
<a class="sourceLine" id="cb77-2" title="2"><span class="kw">library</span>(energy)</a>
<a class="sourceLine" id="cb77-3" title="3"></a>
<a class="sourceLine" id="cb77-4" title="4"></a>
<a class="sourceLine" id="cb77-5" title="5">pow_comparison =<span class="st"> </span><span class="cf">function</span>(n, <span class="dt">N=</span><span class="fl">1e3</span>, <span class="dt">alpha =</span> <span class="fl">0.05</span>){</a>
<a class="sourceLine" id="cb77-6" title="6">  <span class="co"># return the estimated power of ball test and distance correlation test</span></a>
<a class="sourceLine" id="cb77-7" title="7">  <span class="co"># n is the sample size</span></a>
<a class="sourceLine" id="cb77-8" title="8">  <span class="co"># N is the replication times</span></a>
<a class="sourceLine" id="cb77-9" title="9">  <span class="co"># alpha is the significance level</span></a>
<a class="sourceLine" id="cb77-10" title="10">  </a>
<a class="sourceLine" id="cb77-11" title="11">  p_bd =<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>,n)</a>
<a class="sourceLine" id="cb77-12" title="12">  p_dcor =<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>,n)</a>
<a class="sourceLine" id="cb77-13" title="13">  </a>
<a class="sourceLine" id="cb77-14" title="14">  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N){</a>
<a class="sourceLine" id="cb77-15" title="15">    X =<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(<span class="dv">2</span><span class="op">*</span>n), <span class="dt">nrow =</span> n, <span class="dt">ncol =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb77-16" title="16">    e =<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(<span class="dv">2</span><span class="op">*</span>n), <span class="dt">nrow =</span> n, <span class="dt">ncol =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb77-17" title="17">    Y1 =<span class="st"> </span>X<span class="op">/</span><span class="dv">4</span> <span class="op">+</span><span class="st"> </span>e</a>
<a class="sourceLine" id="cb77-18" title="18">    Y2 =<span class="st"> </span>X<span class="op">/</span><span class="dv">4</span> <span class="op">*</span><span class="st"> </span>e</a>
<a class="sourceLine" id="cb77-19" title="19">    p_bd[i] =<span class="st"> </span><span class="kw">bd.test</span>(<span class="dt">x =</span> Y1, <span class="dt">y =</span> Y2, <span class="dt">seed =</span> i<span class="op">*</span>n<span class="op">^</span><span class="dv">2</span>, <span class="dt">R =</span> <span class="dv">99</span>)<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb77-20" title="20">    p_dcor[i] =<span class="st"> </span><span class="kw">dcor.test</span>(<span class="dt">x =</span> Y1, <span class="dt">y =</span> Y2, <span class="dt">R =</span> <span class="dv">99</span>)<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb77-21" title="21">  }</a>
<a class="sourceLine" id="cb77-22" title="22">  <span class="kw">return</span>(<span class="kw">c</span>(<span class="kw">mean</span>(p_bd <span class="op">&lt;</span><span class="st"> </span>alpha), <span class="kw">mean</span>(p_dcor <span class="op">&lt;</span><span class="st"> </span>alpha)))</a>
<a class="sourceLine" id="cb77-23" title="23">}</a>
<a class="sourceLine" id="cb77-24" title="24"></a>
<a class="sourceLine" id="cb77-25" title="25"></a>
<a class="sourceLine" id="cb77-26" title="26">n =<span class="st"> </span><span class="kw">seq</span>(<span class="dv">5</span>, <span class="dv">100</span>, <span class="dv">5</span>)</a>
<a class="sourceLine" id="cb77-27" title="27">pow =<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>, <span class="dt">nrow =</span> <span class="kw">length</span>(n), <span class="dt">ncol =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb77-28" title="28"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(n)){</a>
<a class="sourceLine" id="cb77-29" title="29">  pow[i,] =<span class="st"> </span><span class="kw">pow_comparison</span>(n[i])</a>
<a class="sourceLine" id="cb77-30" title="30">}</a>
<a class="sourceLine" id="cb77-31" title="31">pow =<span class="st"> </span><span class="kw">cbind</span>(n,pow)</a>
<a class="sourceLine" id="cb77-32" title="32"><span class="kw">colnames</span>(pow) =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;sample size&quot;</span>, <span class="st">&quot;ball test&quot;</span>, <span class="st">&quot;dcor test&quot;</span>)</a>
<a class="sourceLine" id="cb77-33" title="33">knitr<span class="op">::</span><span class="kw">kable</span>(pow)</a></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">sample size</th>
<th align="right">ball test</th>
<th align="right">dcor test</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">5</td>
<td align="right">0.683</td>
<td align="right">0.109</td>
</tr>
<tr class="even">
<td align="right">10</td>
<td align="right">0.995</td>
<td align="right">0.203</td>
</tr>
<tr class="odd">
<td align="right">15</td>
<td align="right">1.000</td>
<td align="right">0.294</td>
</tr>
<tr class="even">
<td align="right">20</td>
<td align="right">1.000</td>
<td align="right">0.346</td>
</tr>
<tr class="odd">
<td align="right">25</td>
<td align="right">1.000</td>
<td align="right">0.366</td>
</tr>
<tr class="even">
<td align="right">30</td>
<td align="right">1.000</td>
<td align="right">0.471</td>
</tr>
<tr class="odd">
<td align="right">35</td>
<td align="right">1.000</td>
<td align="right">0.492</td>
</tr>
<tr class="even">
<td align="right">40</td>
<td align="right">1.000</td>
<td align="right">0.549</td>
</tr>
<tr class="odd">
<td align="right">45</td>
<td align="right">1.000</td>
<td align="right">0.584</td>
</tr>
<tr class="even">
<td align="right">50</td>
<td align="right">1.000</td>
<td align="right">0.622</td>
</tr>
<tr class="odd">
<td align="right">55</td>
<td align="right">1.000</td>
<td align="right">0.713</td>
</tr>
<tr class="even">
<td align="right">60</td>
<td align="right">1.000</td>
<td align="right">0.719</td>
</tr>
<tr class="odd">
<td align="right">65</td>
<td align="right">1.000</td>
<td align="right">0.777</td>
</tr>
<tr class="even">
<td align="right">70</td>
<td align="right">1.000</td>
<td align="right">0.764</td>
</tr>
<tr class="odd">
<td align="right">75</td>
<td align="right">1.000</td>
<td align="right">0.799</td>
</tr>
<tr class="even">
<td align="right">80</td>
<td align="right">1.000</td>
<td align="right">0.855</td>
</tr>
<tr class="odd">
<td align="right">85</td>
<td align="right">1.000</td>
<td align="right">0.881</td>
</tr>
<tr class="even">
<td align="right">90</td>
<td align="right">1.000</td>
<td align="right">0.898</td>
</tr>
<tr class="odd">
<td align="right">95</td>
<td align="right">1.000</td>
<td align="right">0.937</td>
</tr>
<tr class="even">
<td align="right">100</td>
<td align="right">1.000</td>
<td align="right">0.929</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb78-1" title="1"><span class="kw">plot</span>(n, pow[,<span class="dv">2</span>], <span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>, <span class="dt">lty=</span><span class="dv">5</span>, <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="dt">ylab=</span><span class="st">&quot;power&quot;</span>)</a>
<a class="sourceLine" id="cb78-2" title="2"><span class="kw">lines</span>(n, pow[,<span class="dv">3</span>], <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">lty =</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb78-3" title="3"><span class="kw">legend</span>(<span class="st">&quot;bottomright&quot;</span>, <span class="kw">c</span>(<span class="st">&quot;ball&quot;</span>,<span class="st">&quot;dcor&quot;</span>), <span class="dt">fill =</span> <span class="kw">c</span>(<span class="st">&quot;blue&quot;</span>,<span class="st">&quot;red&quot;</span>))</a></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAXVBMVEUAAAAAADoAAGYAAP8AOjoAOpAAZrY6AAA6ADo6kNtmAABmADpmkJBmtrZmtv+QOgCQZgCQkGaQ2/+2ZgC225C2/7a2///bkDrb////AAD/tmb/25D//7b//9v///8FjZ4hAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAIH0lEQVR4nO2di1LjOBBFDSxhyOySHbyLiSfk/z9zLMkOBixdPVqWHO6pgkoFVSs+6C3Zac7ESVP6A9QOBQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCCAtqNkMpQbLh8kFBAAoCrCzIUbXv7u70L00Nr4oIsoWbfaLKqENQrXbOFASpQ1DFUBCgDkGsYiBcTYKOR/MzUoWgmvxcGCVR0JxZyZmgIEAmQW3T7N4Ow4ziySdcFYIWSo8ij6Du/nVwtDufT/tHHK68H4scRRZBb4dBS3/zfDaqULiyghxyFFkEnfZDzepvX87T77Rw+QByFDWUoDJ4yFFkboO0KhCufBPkooJerIQgv9KjKD8OqtvPNxUUQG5BHezFVhcUUHzONSzary0ozE/5Krayn0A930LQ0fLaj0yCdBc/YGmB1hsoHs3PcXodTKaBYjOOD/vGY7KakePsRZSfjFMNA5pqVN7J55ysGtBkNaeguCLzicIlqHo/2dqgsQihNiiXIM+pugfhgqwT9DmnvenFLOUnqyA5OYpwQbMGJj1fcUGichQRVczW7kbkW7+fqBLUgEGgf7jqO/kKphq1c1WC5CtYnKChkt2/th59mUS+AeTwE9VI3zwPwz/rlqBwvqWJGwep8bFtrVA439LEjYOUoLTeXlqQ7OhwRnwJaq2jZNF8SxPdBnXWLS/ZfD3IVnoUkb1Y0+iN5fDsgm+iKc3Wx0FZS49i64KyEzUX262Yr4PspUcRUYLG2WpcIxScb2miq9hpX3QctErpUcQJUoWIJciW8PdD4lpQUL5LrFV6FDGNtNyKYhzAT/m7nocilNyPZaxisqEjG+nOfrhuxu8Ha6LoqxA8l+pFll7ssmxtX7mOvQqP5qe4oBYv2o/7hcIlSPrgrmy0+Uga9/CnvVoMERQUMO4pLciTdrCYow3ClBekBkK4FHXNo5igoIFPcUGmgcELZr8f/vqWgqbDC7aDLe+8HewSr7iKTYcX6lq0zxY6ZwnSqdLHQaEzr9KCvNugxSjha9L5TjbLRgvuxYTyLR36CtekP4aOmplbo0kk1IgdJI9Y+vkk6O6dj3/5Okob+p8v5+ei98WcTbTYQfKYpbHigsabUR2NUMBBcgexy86lBb0dTAjH3nzAQXILKWvy/oL+Hnob/a9UCxRPUoJOP03RcQwUZUpQLP6C9Hx6+KjtztQI2RLkGih6HyRfJHFN3l+QHs/dvuh/uapwUm2Qvnr3QNH3IPkSqXsWYW2QaVGHi2qkBHmsp4aE+4TAjo63oB/P4+9uuJL/5EqQCJZwEjtewSVIvxCsYiJUMJIe26D7V93d9GJVTIbFcOvewKR7MeXFFJ6hO6GgD5hxkOlwhrl3e/NcvaAaQ1OQVLTsgta/R1A2Wm5BckdarlRQraEpSCqaTLa21U/JM2ObFmQJl/E+ZbQm3YPdhzoEZQzdHN+hoIXQVyBI+syqvyA1xfilBA0v9LHLvtFrsKefvy4rOeUFZX4UgENQO0jo1Q6oWW59HGf0u/H411I072yTqaCKmfUgPUc168JmKb1/fyPog16foPFhs+OC2XkyNvyeT+kLC8p/p7tdUHcR9MO000bQpzWPsoJWuNO90hJU8iFv/kuuerFssQ3KLajoQ968Q3d6yXXsxd4Ou1kvlllQTTurLqzjoNyC0vfmU9jAZHUrJUg0WmAblLI3n8gWBCXtzaeyCUFrh8sXmoKkokVmK3CQPJRtCfocJeVErm8eZaKxiq2a7bcXVM9kdbVoVzhZlY0mPdXYDDkEeUxWU3OrIUF8co8SlJpbDQkSkuPJampuNSRISQ4nq6m51ZAgKXkiNVw/BaUmSEqeSA3XT0GpCZKSJ1LD9VctaINQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgwDqC9IajXsbu7Y9JMw/msSVQT1jbuSKoA4lPIIsIVhH0dlBnTtX1qZtwLDfi9Hql25agH/6oTqpaE3Tj4wRcWcSwiqDx6PLti9k4apcefK6//u1sS2Ded0RQx331+44solixDbocfl88XNTd/zsIsiWYbiuwJrgIcmQRxYqC2tsXc51L27LDX1QbZEvQ3/6/162YNcJUxexZxLGeILXZaNqGhRZCVQwlyJagUwdK9Kl5W4SpbbYniGM1Qf3URi9++umr36yCbsZyYY2gbqNTT8bZqiCzWW0r//p9VxUzbcrQvlgjTE3PRqtYN/+6gK8taDeeSXmyJTAXPFy8NcFUcLbZSE+nHpx9cOvo5s3Jm97ezY8P5nKOJKJYaRw0HQZxjeJa10Cxm+zZEkxt0CYHimMNGu9Qck81bAn6abJiS9CiBHFwsgqgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgLULui0/2ffRH3FuxD1CxofDF2K+gU9Ln1983rUL+jp45Oy14aCABQEoCAABQEoCFC7oOJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEGAP4WJFD9bZ2ZKAAAAAElFTkSuQmCC" /><!-- --> We found that the power of ball tests is larger than the power of the distance correlation test.</p>
<hr />
</div>
</div>
</div>
<div id="homework-9" class="section level1">
<h1>Homework 9</h1>
<div id="question-8" class="section level2">
<h2>Question</h2>
<p>Exercise 9.4 (Statistical Computing with R, page 277).</p>
</div>
<div id="answer-8" class="section level2">
<h2>Answer</h2>
<div id="exercise-9.4" class="section level3">
<h3>Exercise 9.4</h3>
<p>Implement a random walk Metropolis sampler for generating the standard Laplace distribution (see Exercise 3.2). For the increment, simulate from a normal distribution. Compare the chains generated when different variances are used for the proposal distribution. Also, compute the acceptance rates of each chain.</p>
<p><span class="math inline">\(Sol.\)</span> We modify the codes from Example 9.1, following the instructions in the exercise. The proposal distribution <span class="math inline">\(g(y|x)\)</span> must be <span class="math inline">\(N(\mu =x, \sigma^2)\)</span> for some fixed <span class="math inline">\(\sigma^2\)</span>. In addition, notice that <span class="math inline">\(g(x|y)=g(y|x)\)</span>, which implies we can apply the property of the Metropolis sampler, which is stated in section 9.2.2.</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb79-1" title="1">f =<span class="st"> </span><span class="cf">function</span>(x){</a>
<a class="sourceLine" id="cb79-2" title="2">  <span class="co"># return the density of standard Laplace distribution</span></a>
<a class="sourceLine" id="cb79-3" title="3">  <span class="kw">return</span>(<span class="kw">exp</span>(<span class="op">-</span><span class="kw">abs</span>(x))<span class="op">/</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb79-4" title="4">}</a>
<a class="sourceLine" id="cb79-5" title="5"></a>
<a class="sourceLine" id="cb79-6" title="6"></a>
<a class="sourceLine" id="cb79-7" title="7">Metropolis =<span class="st"> </span><span class="cf">function</span>(<span class="dt">m =</span> <span class="dv">10000</span>, <span class="dt">sd =</span> <span class="dv">1</span>){</a>
<a class="sourceLine" id="cb79-8" title="8">  <span class="co"># m is the number of replications</span></a>
<a class="sourceLine" id="cb79-9" title="9">  <span class="co"># sd is the standard error of the normal distribution</span></a>
<a class="sourceLine" id="cb79-10" title="10">  <span class="co"># k is the number of the rejected candidate points</span></a>
<a class="sourceLine" id="cb79-11" title="11">  <span class="co"># x is the Markov Chain we obtain </span></a>
<a class="sourceLine" id="cb79-12" title="12">  </a>
<a class="sourceLine" id="cb79-13" title="13">  x =<span class="st"> </span><span class="kw">numeric</span>(m)</a>
<a class="sourceLine" id="cb79-14" title="14">  </a>
<a class="sourceLine" id="cb79-15" title="15">  <span class="co">#simulate from normal distribution</span></a>
<a class="sourceLine" id="cb79-16" title="16">  x[<span class="dv">1</span>] =<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>, <span class="dt">mean =</span> <span class="dv">0</span>, <span class="dt">sd =</span> sd) </a>
<a class="sourceLine" id="cb79-17" title="17">  k =<span class="st"> </span><span class="dv">0</span> </a>
<a class="sourceLine" id="cb79-18" title="18">  u =<span class="st"> </span><span class="kw">runif</span>(m)</a>
<a class="sourceLine" id="cb79-19" title="19">  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>m) { </a>
<a class="sourceLine" id="cb79-20" title="20">    xt =<span class="st"> </span>x[i<span class="dv">-1</span>] </a>
<a class="sourceLine" id="cb79-21" title="21">    y =<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>, <span class="dt">mean =</span> xt, <span class="dt">sd =</span> sd)</a>
<a class="sourceLine" id="cb79-22" title="22">    num =<span class="st"> </span><span class="kw">f</span>(y)    <span class="co"># here it is the Metropolis sampler, see P253</span></a>
<a class="sourceLine" id="cb79-23" title="23">    den =<span class="st"> </span><span class="kw">f</span>(xt) </a>
<a class="sourceLine" id="cb79-24" title="24">    <span class="cf">if</span> (u[i] <span class="op">&lt;=</span><span class="st"> </span>num<span class="op">/</span>den){</a>
<a class="sourceLine" id="cb79-25" title="25">      x[i] =<span class="st"> </span>y</a>
<a class="sourceLine" id="cb79-26" title="26">    } </a>
<a class="sourceLine" id="cb79-27" title="27">    <span class="cf">else</span> { </a>
<a class="sourceLine" id="cb79-28" title="28">      x[i] =<span class="st"> </span>xt </a>
<a class="sourceLine" id="cb79-29" title="29">      k =<span class="st"> </span>k<span class="op">+</span><span class="dv">1</span> <span class="co">#y is rejected </span></a>
<a class="sourceLine" id="cb79-30" title="30">    } </a>
<a class="sourceLine" id="cb79-31" title="31">  }</a>
<a class="sourceLine" id="cb79-32" title="32">  <span class="kw">return</span>(<span class="kw">list</span>(<span class="dt">x =</span> x, <span class="dt">k =</span> k, <span class="dt">sd =</span> sd, <span class="dt">m=</span>m))</a>
<a class="sourceLine" id="cb79-33" title="33">}</a>
<a class="sourceLine" id="cb79-34" title="34"></a>
<a class="sourceLine" id="cb79-35" title="35"><span class="kw">set.seed</span>(<span class="dv">1129</span>)</a>
<a class="sourceLine" id="cb79-36" title="36"><span class="co">#sd = 1</span></a>
<a class="sourceLine" id="cb79-37" title="37">result =<span class="st"> </span><span class="kw">Metropolis</span>(<span class="dt">m =</span> <span class="dv">10000</span>, <span class="dt">sd =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb79-38" title="38"><span class="dv">1</span> <span class="op">-</span><span class="st"> </span>result<span class="op">$</span>k <span class="op">/</span><span class="st"> </span>result<span class="op">$</span>m <span class="co"># acceptance rate</span></a></code></pre></div>
<pre><code>## [1] 0.6862</code></pre>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb81-1" title="1">index =<span class="st"> </span><span class="dv">5000</span><span class="op">:</span><span class="dv">5500</span> </a>
<a class="sourceLine" id="cb81-2" title="2">y1 =<span class="st"> </span>result<span class="op">$</span>x[index] </a>
<a class="sourceLine" id="cb81-3" title="3"><span class="kw">plot</span>(index, y1, <span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">main=</span><span class="st">&quot;sd=1&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;x&quot;</span>) </a></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAnFBMVEUAAAAAADoAAGYAOjoAOmYAOpAAZrY6AAA6ADo6OgA6Ojo6OmY6ZpA6ZrY6kLY6kNtmAABmADpmOgBmOpBmZmZmkLZmtrZmtttmtv+QOgCQOmaQZgCQkGaQttuQtv+Q2/+2ZgC2Zjq2kDq229u22/+2/7a2///bkDrbkGbbtmbbtpDb2//b/9vb////tmb/25D/27b//7b//9v///938UGgAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAJJElEQVR4nO3dC3ubNhgF4C9t06y7Jbs2WbvVXbd5tySL9f//2xBCQuJ2JBBEts/Z0wxjJMFrEDiRsShmMvLcK1B6CARCIBACgRAIhEAgBAIhEAiBQAgEQiAQAoEQCIRAIAQCIRAIgUAIBEIgEAKBEAiEQCAEAiEQCIFACARCIBACgRAIhEAgBAIhEEjpQDt58Ud/3uX9ZitwfECHj0KgNj2gv7+Vcwb6843IxZe/6cnDxyt59bMGerwSk4sPal/9vDpfoL2B0DvN4U7sgxDo1ae7swV6upHX9+ovkWulHqSa1v1NCPTnV/eH8wWqJF59aqZN51OR9c5iZwxkDquXP9zXk6/1rIHT/BkDqf++NYfSL/XRpud0O2l13kAV0fs39WncKhCon8M7fVh5fRCBbKoz19f3+jirAMxZbCfsg/x89PaUnbsO6ix0zkDqL90DfWGupH+9kpdveRYrPQQCIRAIgUAIBEIgEAKBEAiEQCAEAiEQCIFACARCIBACgRAIhEAgBAIhEAiBQAgEQiAQAoEQCIRAIAQCIRAIgUAIBEIgEAKBZAaSo8lzAeWtbr0QCIRAIOcDNLNFAuUqRqB16t+ouvVaJFCuYgRap/6NqluvRQLlKkagderfqLqI9gjUaSBsgUC9BiRo5qSBZjVNIFSobCB964jbeqJ/05rk6k4QaH/xQT3d6M+zE2goh7vr+uflfTlAU79cnmpgFaCnm/rwUrvL+w5Q+u/Ck5r2lgyBplvcHMjsQVV2r7fdg7IBycRz0ZVMxLIM3ZMlpTpJbDoVSIZXRlYHqs5i5iA73C0BajYyAUjCSZkFJBsApVQ3DkAgM5kJSPxFzTa644xACgAN13LkQJIK1O4mohYByWkCSQgkJwtk9/A5QO0m+0Di7139tSgdqLeCysIkA6lcQNJZJKL52AWTq1sNSOYDqaMCir3sHgBy/w3XQqA+UFAXgRDQwLzSgSQBSDqPxoAEAwWrUDKQPDuQlArUXvTYtwkIqP9bVfE3WSxOB0i6NXTfWxQE5AE01x7iNhMCyTCQm7kMSNzDpC3Kli5QAxMAqdlA7SFqZvlAgoCkTCAVAslyIHUCQOZQSAdq9pBoIL+tPpDf58hGQPZG8yO/cB0BcuvmVtE93++0AiC78fOAVB9IrQu0l+bPGg92YqQ6CCQTQO0i00BqHpDXYkxSgNyffSqqkdvNjgPZXiMCKNjTbE/fvvxdILHb367FIJBaHcj+4bDKw/QfDjtAKgaoPf0rt0tMA7WbUAhQ8h4kPlB7sI0BSR+oe63QPDcM1M5pd0W3jHeVkbTdiX1QswtF9kF2JwqA7BZ4QA1aMKfd8ZKB/GPVA2+7tZTtTgLSf1KtM3rD60ggZYGkA9Qu0O54wVGmYoEs7bZAsdVBILu/+EBqAZAcOVCzqkE/YRdRdou8rbBAdrHlQLIY6PBPCgSozm7WDKB2+UmgoM3gtO83mxPIjByroH4au0pOqU6Ggbz2AJAKgZQPJOo5gKozk/62hv3424iU6jygZobrcLwlO0Bdws5V1SSQCoHEAUk2oOaN1sj5O7E6b4PbJyKAgrpGgFQXSEIgUe6Bd13hzMIVjd4iHS10O7pkUnXPBuQupgIgaYE6Kxq9Rar+KpS3S7/TowsUPLEUyCsabl9byRiQWg5UXQPqo+shZx80tB3+AwQ0sKhXeafiEMi/WsgE9J3ZdXKexaZWw+75Ztp/m9FbNbfIyHNTQO4itNezRyZ6wbTqZgKNr1oHaKLKDpBdD+kvG5VnA6qX8oD6i84EEr+7I1C3gDutd9ejTCC0tFv/fEAqAFKnDDSwMG7c9mWlA8Vs8VZAgy8WgYLZRw4kBBpbWuzqE2h46SSgqMbPGCiqcYdRGJC4eHNiip0LUL+6uC12B0UWoOYX9eGKHDeQKUIgUCQb0PBF4UkA5Wp+qCoCeXURCNRFIFAXgUBdBAJ1HRFQdM2ZzvBNXUMzCeTVNTSzSKD4mgmEihAIFMkINNwAgUADhQJFF1kfaKABAnkNEAg0cOxAudchqoFVgR6vRgfqlQg0ePJfBch+EEEnw13wXJGTAbKfYcm9B62d7YCqfUiP8cwLtH42BFJqd/GBQJPZy/XRAUXOiy48ncerlz2g/l9WS8rGQHpAPvegqXgfXc1R3fohEAiBQAgEQiCQrYE2rC5PCARCIBACgRBoRggEQiAQAoE8G9DR5JmA4ioFzy97emnxZYvnqZRAy54nEIGWPU8gAi17nkAEWvb86QOdUggEQiAQAoEQCIRAIAQCIRAIgUAIBEIgEAKBEAgkB5D5iIK+ofmD1HftHpqIKF7f0Pp6dnGdXX0z45TiKDmAHj9rVuKhWhv9b2Aiovjhrlpwrzd1VvF6Beq7PScVR8kBZL/Hxgw9270emIgpbsan71/8Ma+4qnemCiitOEoOoH2zCm4L+xMxxU2qV3x28f3luwoorThKDqDd56bvMDt79Yr2J2KKN4/mF68W131QWnGUDEDmI0C76+Zwr372J2KK19GfuJpZXB9RGiipOEy203z1Qs0DcsXr/9k+ekZx/Y1VBQNVB/zMQ8wWV/YTe/OK1wsXeYiZVGszs5O2xd1XBM4rvm/GtdwW10k3L/7Q6TnmROuKu68vm1lcZ1fkab5eBd1NzrtQtMUfr+ypbFZx86DIC0X9lSXmxd/bS/v+BC7eHCPmG4bSi5vp+q1GUnEQvlkFIRAIgUAIBEIgEAKBEAiEQCAEAiEQCIFACARCIBACgRAIhEAgBAIhEAiBQAgEQiAQAoEQCIRAIAQCIRAIgUCKA3q66d4odunwg2UpDqgfAoEQKIg+xJ5ufrwxQ1r0+JX3zYAYPfxMDxd7uhm/E2j+FAqkx9xX/3aVx4M0D/QAKz1obF+PAdoqhQJdm3GZ9fC63cUHs9PocXYPL37/ZtMjrlCg23rCjDx0A3prr50sG3OYmqKB9g7IjmDVI4VH7xe/SooG6uxBOoe775cN601N0UDNQGfdB9ndZn/578TtrFdI0UD1ycudxUxvfbt06HxiygYKr4MqGDNQfMtuujig0kIgEAKBEAiEQCAEAiEQCIFACARCIBACgRAIhEAgBAIhEAiBQAgEQiAQAoEQCIRAIAQCIRAIgUD+B3FcrWTavZOqAAAAAElFTkSuQmCC" /><!-- --></p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb82-1" title="1"><span class="co">#sd = 10</span></a>
<a class="sourceLine" id="cb82-2" title="2">result =<span class="st"> </span><span class="kw">Metropolis</span>(<span class="dt">m =</span> <span class="dv">10000</span>, <span class="dt">sd =</span> <span class="dv">10</span>)</a>
<a class="sourceLine" id="cb82-3" title="3"><span class="dv">1</span> <span class="op">-</span><span class="st"> </span>result<span class="op">$</span>k <span class="op">/</span><span class="st"> </span>result<span class="op">$</span>m <span class="co"># acceptance rate</span></a></code></pre></div>
<pre><code>## [1] 0.161</code></pre>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb84-1" title="1">index =<span class="st"> </span><span class="dv">5000</span><span class="op">:</span><span class="dv">5500</span> </a>
<a class="sourceLine" id="cb84-2" title="2">y1 =<span class="st"> </span>result<span class="op">$</span>x[index] </a>
<a class="sourceLine" id="cb84-3" title="3"><span class="kw">plot</span>(index, y1, <span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">main=</span><span class="st">&quot;sd=10&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;x&quot;</span>) </a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb85-1" title="1"><span class="co">#sd = 0.1</span></a>
<a class="sourceLine" id="cb85-2" title="2">result =<span class="st"> </span><span class="kw">Metropolis</span>(<span class="dt">m =</span> <span class="dv">10000</span>, <span class="dt">sd =</span> <span class="fl">0.1</span>)</a>
<a class="sourceLine" id="cb85-3" title="3"><span class="dv">1</span> <span class="op">-</span><span class="st"> </span>result<span class="op">$</span>k <span class="op">/</span><span class="st"> </span>result<span class="op">$</span>m <span class="co"># acceptance rate</span></a></code></pre></div>
<pre><code>## [1] 0.9649</code></pre>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb87-1" title="1">index =<span class="st"> </span><span class="dv">5000</span><span class="op">:</span><span class="dv">5500</span> </a>
<a class="sourceLine" id="cb87-2" title="2">y1 =<span class="st"> </span>result<span class="op">$</span>x[index] </a>
<a class="sourceLine" id="cb87-3" title="3"><span class="kw">plot</span>(index, y1, <span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">main=</span><span class="st">&quot;sd=0.1&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;x&quot;</span>) </a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>We find that when <span class="math inline">\(\sigma^2\)</span> increases, the Markov Chain changes less rapidly, and the acceptance rate increases.</p>
<hr />
</div>
</div>
</div>
<div id="homework-10" class="section level1">
<h1>Homework 10</h1>
<div id="question-9" class="section level2">
<h2>Question</h2>
<ul>
<li><p>Exercise 11.1 and 11.5 (Statistical Computing wtih R, pages 353-354)</p></li>
<li><p>A-B-O blood type probelm</p></li>
</ul>
</div>
<div id="answer-9" class="section level2">
<h2>Answer</h2>
<div id="exercise-11.1" class="section level3">
<h3>Exercise 11.1</h3>
<p>The natural logarithm and exponential functions are inverses of each other, so that mathematically log(exp<span class="math inline">\(x\)</span>) <span class="math inline">\(=\)</span> exp(log<span class="math inline">\(x\)</span>)<span class="math inline">\(=\)</span> <span class="math inline">\(x\)</span>. Show by example that this property does not hold exactly in computer arithmetic. Does the identity hold with near equality? (See all.equal.)</p>
<p><span class="math inline">\(Sol.\)</span></p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb88-1" title="1">x =<span class="st"> </span><span class="kw">rep</span>(T,<span class="dv">10</span>)</a>
<a class="sourceLine" id="cb88-2" title="2"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>){</a>
<a class="sourceLine" id="cb88-3" title="3">  x[i] =<span class="st"> </span><span class="kw">log</span>(<span class="kw">exp</span>(i))<span class="op">-</span><span class="kw">exp</span>(<span class="kw">log</span>(i))<span class="op">==</span><span class="dv">0</span></a>
<a class="sourceLine" id="cb88-4" title="4">}</a>
<a class="sourceLine" id="cb88-5" title="5">x</a></code></pre></div>
<pre><code>##  [1]  TRUE  TRUE FALSE  TRUE FALSE  TRUE FALSE FALSE FALSE FALSE</code></pre>
<p>Notice that the result is not always ‘TRUE’. So this property does not always hold in computer arithmetic.</p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb90-1" title="1">x =<span class="st"> </span><span class="kw">rep</span>(T,<span class="dv">10</span>)</a>
<a class="sourceLine" id="cb90-2" title="2"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>){</a>
<a class="sourceLine" id="cb90-3" title="3">  x[i] =<span class="st"> </span><span class="kw">all.equal</span>(<span class="kw">log</span>(<span class="kw">exp</span>(i))<span class="op">-</span><span class="kw">exp</span>(<span class="kw">log</span>(i)), <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb90-4" title="4">}</a>
<a class="sourceLine" id="cb90-5" title="5">x</a></code></pre></div>
<pre><code>##  [1] TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE TRUE</code></pre>
<p>The result is always ‘TRUE’, which means the identity holds with near equality.</p>
</div>
<div id="exercise-11.5" class="section level3">
<h3>Exercise 11.5</h3>
<p>Write a function to solve the equation <span class="math display">\[
\frac{2\Gamma(\frac{k}{2})}{\sqrt{\pi(k-1)}\Gamma(\frac{k-1}{2})}\int_0^{c_{k-1}}(1+\frac{u^2}{k-1})^{-k/2}du 
= 
\frac{2\Gamma(\frac{k+1}{2})}{\sqrt{\pi k}\Gamma(\frac{k}{2})}\int_0^{c_{k}}(1+\frac{u^2}{k})^{-(k+1)/2}du
\]</span> for <span class="math inline">\(a\)</span>, where <span class="math display">\[
c_k = \sqrt{\frac{a^2 k}{k+1-a^2}}
\]</span></p>
<p>Compare the solutions with the points <span class="math inline">\(A(k)\)</span> in Exercise 11.4.</p>
<p><span class="math inline">\(Sol.\)</span> First of all we give a function to calculate the points <span class="math inline">\(A(k)\)</span> in Exercise 11.4.</p>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb92-1" title="1">SS =<span class="st"> </span><span class="cf">function</span>(a, k){</a>
<a class="sourceLine" id="cb92-2" title="2">  <span class="co"># the function S_k in Exercise 11.4</span></a>
<a class="sourceLine" id="cb92-3" title="3">  <span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">pt</span>(<span class="kw">sqrt</span>((a<span class="op">^</span><span class="dv">2</span> <span class="op">*</span>k)<span class="op">/</span>(k<span class="op">+</span><span class="dv">1</span><span class="op">-</span>a<span class="op">^</span><span class="dv">2</span>)), <span class="dt">df =</span> k)</a>
<a class="sourceLine" id="cb92-4" title="4">}</a>
<a class="sourceLine" id="cb92-5" title="5"></a>
<a class="sourceLine" id="cb92-6" title="6"></a>
<a class="sourceLine" id="cb92-7" title="7">AA =<span class="st"> </span><span class="cf">function</span>(k){</a>
<a class="sourceLine" id="cb92-8" title="8">  <span class="co"># calculate the points A(k) in Exercise 11.4</span></a>
<a class="sourceLine" id="cb92-9" title="9">  <span class="co"># k CANNOT be a vector</span></a>
<a class="sourceLine" id="cb92-10" title="10">  </a>
<a class="sourceLine" id="cb92-11" title="11">  <span class="co"># I found that the point is usually between 1 and 2... </span></a>
<a class="sourceLine" id="cb92-12" title="12">  <span class="kw">uniroot</span>(<span class="cf">function</span>(x) <span class="kw">SS</span>(x,k<span class="dv">-1</span>)<span class="op">-</span><span class="kw">SS</span>(x,k) , <span class="kw">c</span>(<span class="dv">1</span>,<span class="kw">min</span>(<span class="kw">sqrt</span>(k)<span class="op">-</span><span class="fl">0.01</span>,<span class="dv">2</span>)))<span class="op">$</span>root    </a>
<a class="sourceLine" id="cb92-13" title="13">}</a></code></pre></div>
<p>Then we write a function to solve the equation in Exercise 11.5, without taking advantage of the truth that the integrands in the equation are similar to <span class="math inline">\(dt(u, df = k-1)\)</span> and <span class="math inline">\(dt(u, df = k-1)\)</span> respectively.</p>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb93-1" title="1">dt_new =<span class="st"> </span><span class="cf">function</span>(x, df){</a>
<a class="sourceLine" id="cb93-2" title="2">  <span class="co"># return the integrand in RHS of the equation in Exercise 11.5</span></a>
<a class="sourceLine" id="cb93-3" title="3">  <span class="co"># return the same value as 2*dt(x, df)</span></a>
<a class="sourceLine" id="cb93-4" title="4"></a>
<a class="sourceLine" id="cb93-5" title="5">  <span class="dv">2</span><span class="op">*</span>(<span class="dv">1</span><span class="op">+</span>x<span class="op">^</span><span class="dv">2</span> <span class="op">/</span>df)<span class="op">^</span>(<span class="op">-</span>(df<span class="op">+</span><span class="dv">1</span>)<span class="op">/</span><span class="dv">2</span>) <span class="op">/</span><span class="kw">sqrt</span>(pi<span class="op">*</span>df) <span class="op">*</span><span class="kw">exp</span>(<span class="kw">lgamma</span>((df<span class="op">+</span><span class="dv">1</span>)<span class="op">/</span><span class="dv">2</span>)<span class="op">-</span><span class="kw">lgamma</span>(df<span class="op">/</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb93-6" title="6">}</a>
<a class="sourceLine" id="cb93-7" title="7"></a>
<a class="sourceLine" id="cb93-8" title="8">III =<span class="st"> </span><span class="cf">function</span>(a,k){</a>
<a class="sourceLine" id="cb93-9" title="9">  <span class="co"># calculate the integral in the equation in Exercise 11.5</span></a>
<a class="sourceLine" id="cb93-10" title="10">  </a>
<a class="sourceLine" id="cb93-11" title="11">  c =<span class="st"> </span><span class="kw">sqrt</span>(a<span class="op">^</span><span class="dv">2</span> <span class="op">*</span>k<span class="op">/</span>(k<span class="op">+</span><span class="dv">1</span><span class="op">-</span>a<span class="op">^</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb93-12" title="12">  res =<span class="st"> </span><span class="kw">integrate</span>(<span class="cf">function</span>(x) <span class="kw">dt_new</span>(x,k), <span class="dt">lower =</span> <span class="dv">0</span>, <span class="dt">upper =</span> c)<span class="op">$</span>value</a>
<a class="sourceLine" id="cb93-13" title="13">  <span class="kw">return</span>(res)         </a>
<a class="sourceLine" id="cb93-14" title="14">}</a>
<a class="sourceLine" id="cb93-15" title="15"></a>
<a class="sourceLine" id="cb93-16" title="16">BB =<span class="st"> </span><span class="cf">function</span>(k){</a>
<a class="sourceLine" id="cb93-17" title="17">  <span class="co"># calculate the solution in Exercise 11.5</span></a>
<a class="sourceLine" id="cb93-18" title="18">  <span class="co"># k CANNOT be a vector</span></a>
<a class="sourceLine" id="cb93-19" title="19">  </a>
<a class="sourceLine" id="cb93-20" title="20">  <span class="kw">uniroot</span>(<span class="cf">function</span>(x) <span class="kw">III</span>(x,k<span class="dv">-1</span>)<span class="op">-</span><span class="kw">III</span>(x,k) , <span class="kw">c</span>(<span class="dv">1</span>,<span class="kw">min</span>(<span class="kw">sqrt</span>(k)<span class="op">-</span><span class="fl">0.01</span>,<span class="dv">2</span>) ))<span class="op">$</span>root</a>
<a class="sourceLine" id="cb93-21" title="21">}</a></code></pre></div>
<p>Finally, we can give a comparison.</p>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb94-1" title="1">K =<span class="st"> </span><span class="kw">c</span>(<span class="kw">c</span>(<span class="dv">4</span><span class="op">:</span><span class="dv">25</span>))</a>
<a class="sourceLine" id="cb94-2" title="2">compare =<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>,<span class="kw">length</span>(K))</a>
<a class="sourceLine" id="cb94-3" title="3"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(K)){</a>
<a class="sourceLine" id="cb94-4" title="4">  compare[i] =<span class="st"> </span><span class="kw">all.equal</span>(<span class="kw">AA</span>(K[i]),<span class="kw">BB</span>(K[i]))</a>
<a class="sourceLine" id="cb94-5" title="5">}</a>
<a class="sourceLine" id="cb94-6" title="6"><span class="kw">max</span>(compare) <span class="op">==</span><span class="st"> </span><span class="dv">1</span> <span class="co">#return T iff A(k)=B(k) for all the k above</span></a></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
</div>
<div id="a-b-o-blood-type-probelm" class="section level3">
<h3>A-B-O blood type probelm</h3>
<ul>
<li>Let the three alleles be A, B, and O with allele frequencies <span class="math inline">\(p\)</span>, <span class="math inline">\(q\)</span>, and <span class="math inline">\(r\)</span>. The 6 genotype frequencies under HWE and complete counts are as follows. (Open the pdf to find the table)</li>
</ul>

<ul>
<li>Observed data:</li>
</ul>
<p><span class="math display">\[\begin{align}
n_A =&amp; \ n_{AA} +n_{AO}=28\quad \text{(A-type)} \notag \\
n_B =&amp; \ n_{BB} +n_{BO}=24\quad \text{(B-type)} \notag \\
n_{OO} =&amp; \ 41\quad \text{(O-type)} \notag \\
n_{AB} =&amp; \ 70\quad \text{(AB-type)} \notag 
\end{align}\]</span></p>
<ul>
<li><p>Use EM algorithm to solve MLE of <span class="math inline">\(p\)</span> and <span class="math inline">\(q\)</span> (consider missing data <span class="math inline">\(n_{AA}\)</span> and <span class="math inline">\(n_{BB}\)</span>)</p></li>
<li><p>Show that the log-maximum likelihood values in M-steps are increasing via line plot.</p></li>
</ul>
<p><span class="math inline">\(Sol.\)</span></p>
<ul>
<li>Observed data likelihood <span class="math display">\[\begin{align}
L(p,q|n_A,n_B,n_{OO},n_{AB}) =&amp; \ (p^2+2pr)^{28} (q^2+2qr)^{24} (r^2)^{41} (2pq)^{70} \notag \\
=&amp; \ (2p-p^2-2pq)^{28} (2q-q^2-2pq)^{24} (1-p-q)^{82} (2pq)^{70} \notag \\
=&amp; \ (2-p-2q)^{28} (2-q-2p)^{24} (1-p-q)^{82} p^{98} q^{94} \notag
\end{align}\]</span></li>
</ul>
<p>When the observed data likelihood attains its maximum, we have</p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb96-1" title="1">ll =<span class="st"> </span><span class="cf">function</span>(theta){</a>
<a class="sourceLine" id="cb96-2" title="2">  p =<span class="st"> </span>theta[<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb96-3" title="3">  q =<span class="st"> </span>theta[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb96-4" title="4">  <span class="op">-</span>(<span class="dv">28</span><span class="op">*</span><span class="kw">log</span>(<span class="dv">2</span><span class="op">-</span>p<span class="dv">-2</span><span class="op">*</span>q) <span class="op">+</span><span class="dv">24</span><span class="op">*</span><span class="kw">log</span>(<span class="dv">2</span><span class="op">-</span>q<span class="dv">-2</span><span class="op">*</span>p) <span class="op">+</span><span class="st"> </span><span class="dv">92</span><span class="op">*</span><span class="kw">log</span>(<span class="dv">1</span><span class="op">-</span>p<span class="op">-</span>q) <span class="op">+</span><span class="st"> </span><span class="dv">98</span><span class="op">*</span><span class="kw">log</span>(p) <span class="op">+</span><span class="st"> </span><span class="dv">94</span><span class="op">*</span><span class="kw">log</span>(q))</a>
<a class="sourceLine" id="cb96-5" title="5">}</a>
<a class="sourceLine" id="cb96-6" title="6"></a>
<a class="sourceLine" id="cb96-7" title="7"><span class="kw">optim</span>(<span class="kw">c</span>(<span class="fl">0.3</span>,<span class="fl">0.3</span>), ll)</a></code></pre></div>
<pre><code>## $par
## [1] 0.3159743 0.2997502
## 
## $value
## [1] 310.2877
## 
## $counts
## function gradient 
##       39       NA 
## 
## $convergence
## [1] 0
## 
## $message
## NULL</code></pre>
<p>To perform the EM algorithm, we need to do more calculations.</p>
<ul>
<li>Observed data likelihood <span class="math display">\[
L(p,q|n_{AA},n_{BB},n_A,n_B,n_{OO},n_{AB}) = (p^2)^{n_{AA}} (2pr)^{28-n_{AA}} (q^2)^{n_{BB}} (2qr)^{24-n_{BB}} (r^2)^{41} (2pq)^{70}
\]</span> <span class="math display">\[
l(p,q|n_{AA},n_{BB},n_A,n_B,n_{OO},n_{AB}) = (98+n_{AA}) \log p + (94+n_{BB}) \log q + (134-n_{AA}-n_{BB}) \log (1-p-q) + C
\]</span></li>
</ul>
<p><span class="math display">\[\begin{align}
E_{p_n} l
= &amp; \ (98-\frac{28p_n}{2-p_n-2q_n}) \log p + (94-\frac{24q_n}{2-q_n-2p_n}) \log q \notag \\
&amp; + (134-\frac{28p_n}{2-p_n-2q_n}-\frac{24q_n}{2-q_n-2p_n}) \log (1-p-q) + C \notag \notag 
\end{align}\]</span></p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb98-1" title="1">l =<span class="st"> </span><span class="cf">function</span>(theta, p_<span class="dv">0</span>,q_<span class="dv">0</span>){</a>
<a class="sourceLine" id="cb98-2" title="2">  p =<span class="st"> </span>theta[<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb98-3" title="3">  q =<span class="st"> </span>theta[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb98-4" title="4">  r =<span class="st"> </span><span class="dv">1</span><span class="op">-</span>p<span class="op">-</span>q</a>
<a class="sourceLine" id="cb98-5" title="5">  nAA =<span class="st"> </span><span class="dv">28</span><span class="op">*</span>p_<span class="dv">0</span><span class="op">/</span>(<span class="dv">2</span><span class="op">-</span>p_<span class="dv">0-2</span><span class="op">*</span>q_<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb98-6" title="6">  nBB =<span class="st"> </span><span class="dv">24</span><span class="op">*</span>q_<span class="dv">0</span><span class="op">/</span>(<span class="dv">2</span><span class="op">-</span>q_<span class="dv">0-2</span><span class="op">*</span>p_<span class="dv">0</span>)</a>
<a class="sourceLine" id="cb98-7" title="7">  <span class="op">-</span>((<span class="dv">98</span><span class="op">+</span>nAA)<span class="op">*</span><span class="kw">log</span>(p) <span class="op">+</span><span class="st"> </span>(<span class="dv">94</span><span class="op">+</span>nBB)<span class="op">*</span><span class="kw">log</span>(q) <span class="op">+</span><span class="st"> </span>(<span class="dv">134</span><span class="op">-</span>nAA<span class="op">-</span>nBB)<span class="op">*</span><span class="kw">log</span>(r) )</a>
<a class="sourceLine" id="cb98-8" title="8">}</a>
<a class="sourceLine" id="cb98-9" title="9"></a>
<a class="sourceLine" id="cb98-10" title="10"><span class="co"># initialization</span></a>
<a class="sourceLine" id="cb98-11" title="11">N =<span class="st"> </span><span class="dv">10</span></a>
<a class="sourceLine" id="cb98-12" title="12">Theta =<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>, <span class="dt">ncol =</span> <span class="dv">2</span>, <span class="dt">nrow =</span> N<span class="op">+</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb98-13" title="13">Theta[<span class="dv">1</span>,] =<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.3</span>,<span class="fl">0.3</span>)</a>
<a class="sourceLine" id="cb98-14" title="14"></a>
<a class="sourceLine" id="cb98-15" title="15"><span class="co"># EM algorithm</span></a>
<a class="sourceLine" id="cb98-16" title="16"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N){</a>
<a class="sourceLine" id="cb98-17" title="17">  Theta[i<span class="op">+</span><span class="dv">1</span>,] =<span class="st"> </span><span class="kw">optim</span>(<span class="kw">c</span>(<span class="fl">0.4</span>,<span class="fl">0.4</span>), <span class="cf">function</span>(theta) <span class="kw">l</span>(theta, <span class="dt">p_0 =</span> Theta[i,<span class="dv">1</span>], <span class="dt">q_0 =</span> Theta[i,<span class="dv">2</span>]))<span class="op">$</span>par</a>
<a class="sourceLine" id="cb98-18" title="18">}</a>
<a class="sourceLine" id="cb98-19" title="19"></a>
<a class="sourceLine" id="cb98-20" title="20"><span class="co"># result</span></a>
<a class="sourceLine" id="cb98-21" title="21">Theta[N<span class="op">+</span><span class="dv">1</span>,]</a></code></pre></div>
<pre><code>## [1] 0.3272979 0.3104951</code></pre>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb100-1" title="1"><span class="kw">ll</span>(Theta[N<span class="op">+</span><span class="dv">1</span>,])</a></code></pre></div>
<pre><code>## [1] 310.5902</code></pre>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb102-1" title="1">x =<span class="st"> </span><span class="dv">1</span><span class="op">:</span>N</a>
<a class="sourceLine" id="cb102-2" title="2">y =<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>,N)</a>
<a class="sourceLine" id="cb102-3" title="3"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N){</a>
<a class="sourceLine" id="cb102-4" title="4">  y[i] =<span class="st"> </span><span class="op">-</span><span class="kw">ll</span>(Theta[i,])</a>
<a class="sourceLine" id="cb102-5" title="5">}</a>
<a class="sourceLine" id="cb102-6" title="6"><span class="kw">plot</span>(x,y, <span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">col=</span><span class="st">&quot;red&quot;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>The result is strange…</p>
<hr />
</div>
</div>
</div>
<div id="homework-12" class="section level1">
<h1>Homework 12</h1>
<div id="question-10" class="section level2">
<h2>Question</h2>
<p>You have already written an R function for Exercise 9.4 (page 277, Statistical Computing with R). Rewrite an Rcpp function for the same task.</p>
<ol style="list-style-type: decimal">
<li><p>Compare the generated random numbers by the two functions using qqplot.</p></li>
<li><p>Campare the computation time of the two functions with microbenchmark.</p></li>
<li><p>Comments your results.</p></li>
</ol>
</div>
<div id="answer-10" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb103-1" title="1"><span class="co">#include &lt;cmath&gt;</span></a>
<a class="sourceLine" id="cb103-2" title="2"><span class="co">#include &lt;Rcpp.h&gt;</span></a>
<a class="sourceLine" id="cb103-3" title="3">using namespace Rcpp;</a>
<a class="sourceLine" id="cb103-4" title="4"></a>
<a class="sourceLine" id="cb103-5" title="5"><span class="op">/</span><span class="er">/</span>[[Rcpp<span class="op">::</span>export]]</a>
<a class="sourceLine" id="cb103-6" title="6">double <span class="kw">f</span>(double x) {</a>
<a class="sourceLine" id="cb103-7" title="7">  return <span class="kw">exp</span>(<span class="op">-</span><span class="kw">abs</span>(x));</a>
<a class="sourceLine" id="cb103-8" title="8">}</a>
<a class="sourceLine" id="cb103-9" title="9"></a>
<a class="sourceLine" id="cb103-10" title="10"><span class="op">/</span><span class="er">/</span>[[Rcpp<span class="op">::</span>export]]</a>
<a class="sourceLine" id="cb103-11" title="11">NumericVector <span class="kw">Metropolis_C</span> (int N, double sd) {</a>
<a class="sourceLine" id="cb103-12" title="12">  NumericVector <span class="kw">x</span>(N);</a>
<a class="sourceLine" id="cb103-13" title="13">  NumericVector initial =<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>,<span class="dv">0</span>,sd);</a>
<a class="sourceLine" id="cb103-14" title="14">  x[<span class="dv">0</span>] =<span class="st"> </span>initial[<span class="dv">0</span>];</a>
<a class="sourceLine" id="cb103-15" title="15">  NumericVector u =<span class="st"> </span><span class="kw">runif</span>(N);</a>
<a class="sourceLine" id="cb103-16" title="16">  <span class="cf">for</span> (int <span class="dt">i =</span> <span class="dv">1</span>; i <span class="op">&lt;</span><span class="st"> </span>N;i<span class="op">++</span><span class="st"> </span>) {</a>
<a class="sourceLine" id="cb103-17" title="17">    NumericVector y =<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>, x[i<span class="dv">-1</span>], sd);</a>
<a class="sourceLine" id="cb103-18" title="18">    <span class="cf">if</span> (u[i] <span class="op">&lt;=</span><span class="st"> </span>(<span class="kw">f</span>(y[<span class="dv">0</span>]) <span class="op">/</span><span class="st"> </span><span class="kw">f</span>(x[i<span class="dv">-1</span>]))){</a>
<a class="sourceLine" id="cb103-19" title="19">      x[i] =<span class="st"> </span>y[<span class="dv">0</span>];</a>
<a class="sourceLine" id="cb103-20" title="20">    }</a>
<a class="sourceLine" id="cb103-21" title="21">    <span class="cf">else</span> {</a>
<a class="sourceLine" id="cb103-22" title="22">      x[i] =<span class="st"> </span>x[i<span class="dv">-1</span>];</a>
<a class="sourceLine" id="cb103-23" title="23">    }</a>
<a class="sourceLine" id="cb103-24" title="24">  }</a>
<a class="sourceLine" id="cb103-25" title="25">  <span class="kw">return</span>(x);</a>
<a class="sourceLine" id="cb103-26" title="26">}</a></code></pre></div>
</div>
<div id="comparison-of-the-computation-time" class="section level2">
<h2>comparison of the computation time</h2>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb104-1" title="1"><span class="kw">library</span>(Rcpp)</a>
<a class="sourceLine" id="cb104-2" title="2"><span class="kw">library</span>(microbenchmark)</a>
<a class="sourceLine" id="cb104-3" title="3"></a>
<a class="sourceLine" id="cb104-4" title="4"><span class="co"># R</span></a>
<a class="sourceLine" id="cb104-5" title="5">f_R =<span class="st"> </span><span class="cf">function</span>(x){</a>
<a class="sourceLine" id="cb104-6" title="6">    <span class="co"># return the density of standard Laplace distribution</span></a>
<a class="sourceLine" id="cb104-7" title="7">    <span class="kw">return</span>(<span class="kw">exp</span>(<span class="op">-</span><span class="kw">abs</span>(x))<span class="op">/</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb104-8" title="8">}</a>
<a class="sourceLine" id="cb104-9" title="9"></a>
<a class="sourceLine" id="cb104-10" title="10"></a>
<a class="sourceLine" id="cb104-11" title="11">Metropolis_R =<span class="st"> </span><span class="cf">function</span>(<span class="dt">m =</span> <span class="dv">10000</span>, <span class="dt">sd =</span> <span class="dv">1</span>){</a>
<a class="sourceLine" id="cb104-12" title="12">  <span class="co"># m is the number of replications</span></a>
<a class="sourceLine" id="cb104-13" title="13">  <span class="co"># sd is the standard error of the normal distribution</span></a>
<a class="sourceLine" id="cb104-14" title="14">  <span class="co"># k is the number of the rejected candidate points</span></a>
<a class="sourceLine" id="cb104-15" title="15">  <span class="co"># x is the Markov Chain we obtain </span></a>
<a class="sourceLine" id="cb104-16" title="16">  </a>
<a class="sourceLine" id="cb104-17" title="17">  x =<span class="st"> </span><span class="kw">numeric</span>(m)</a>
<a class="sourceLine" id="cb104-18" title="18">  </a>
<a class="sourceLine" id="cb104-19" title="19">  <span class="co">#simulate from normal distribution</span></a>
<a class="sourceLine" id="cb104-20" title="20">  x[<span class="dv">1</span>] =<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>, <span class="dt">mean =</span> <span class="dv">0</span>, <span class="dt">sd =</span> sd) </a>
<a class="sourceLine" id="cb104-21" title="21">  k =<span class="st"> </span><span class="dv">0</span> </a>
<a class="sourceLine" id="cb104-22" title="22">  u =<span class="st"> </span><span class="kw">runif</span>(m)</a>
<a class="sourceLine" id="cb104-23" title="23">  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>m) { </a>
<a class="sourceLine" id="cb104-24" title="24">    xt =<span class="st"> </span>x[i<span class="dv">-1</span>] </a>
<a class="sourceLine" id="cb104-25" title="25">    y =<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>, <span class="dt">mean =</span> xt, <span class="dt">sd =</span> sd)</a>
<a class="sourceLine" id="cb104-26" title="26">    num =<span class="st"> </span><span class="kw">f_R</span>(y)    <span class="co"># here it is the Metropolis sampler, see P253</span></a>
<a class="sourceLine" id="cb104-27" title="27">    den =<span class="st"> </span><span class="kw">f_R</span>(xt) </a>
<a class="sourceLine" id="cb104-28" title="28">    <span class="cf">if</span> (u[i] <span class="op">&lt;=</span><span class="st"> </span>num<span class="op">/</span>den){</a>
<a class="sourceLine" id="cb104-29" title="29">      x[i] =<span class="st"> </span>y</a>
<a class="sourceLine" id="cb104-30" title="30">    } </a>
<a class="sourceLine" id="cb104-31" title="31">    <span class="cf">else</span> { </a>
<a class="sourceLine" id="cb104-32" title="32">      x[i] =<span class="st"> </span>xt </a>
<a class="sourceLine" id="cb104-33" title="33">      k =<span class="st"> </span>k<span class="op">+</span><span class="dv">1</span> <span class="co">#y is rejected </span></a>
<a class="sourceLine" id="cb104-34" title="34">    } </a>
<a class="sourceLine" id="cb104-35" title="35">  }</a>
<a class="sourceLine" id="cb104-36" title="36">  <span class="kw">return</span>(<span class="kw">list</span>(<span class="dt">x =</span> x, <span class="dt">k =</span> k, <span class="dt">sd =</span> sd, <span class="dt">m=</span>m))</a>
<a class="sourceLine" id="cb104-37" title="37">}</a>
<a class="sourceLine" id="cb104-38" title="38"></a>
<a class="sourceLine" id="cb104-39" title="39">    dir_cpp =<span class="st"> &#39;D:/Statistical_Computing/Homework/Homework_12/&#39;</span></a>
<a class="sourceLine" id="cb104-40" title="40">    <span class="kw">sourceCpp</span>(<span class="kw">paste0</span>(dir_cpp,<span class="st">&quot;Metropolis_C.cpp&quot;</span>))</a></code></pre></div>
<pre><code>## Warning in normalizePath(path.expand(path), winslash, mustWork):
## path[1]=&quot;D:/Statistical_Computing/Homework/Homework_12/../inst/include&quot;: 系
## 统找不到指定的路径。</code></pre>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb106-1" title="1">    N =<span class="st"> </span><span class="dv">10000</span></a>
<a class="sourceLine" id="cb106-2" title="2">    sd =<span class="st"> </span><span class="dv">2</span></a>
<a class="sourceLine" id="cb106-3" title="3">    (<span class="dt">time =</span> <span class="kw">microbenchmark</span>(<span class="dt">rwR=</span><span class="kw">Metropolis_R</span>(N,sd),<span class="dt">rwC=</span><span class="kw">Metropolis_C</span>(N,sd)))</a></code></pre></div>
<pre><code>## Unit: milliseconds
##  expr     min      lq      mean   median       uq      max neval
##   rwR 31.3651 37.2976 39.319898 38.50630 40.06525 142.2099   100
##   rwC  1.5109  1.6394  1.852894  1.69655  1.85750   3.1836   100</code></pre>
<p>We can see that the running time of using Cpp functionis much shorter than using R function. So using Rcpp method can improve computing efficiency.</p>
</div>
<div id="qqplot" class="section level2">
<h2>qqplot</h2>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb108-1" title="1"><span class="kw">set.seed</span>(<span class="dv">12345</span>)</a>
<a class="sourceLine" id="cb108-2" title="2">rwR =<span class="st"> </span><span class="kw">Metropolis_R</span>(N,sd)<span class="op">$</span>x[<span class="op">-</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">1000</span>)]</a>
<a class="sourceLine" id="cb108-3" title="3">rwC =<span class="st"> </span><span class="kw">Metropolis_C</span>(N,sd)[<span class="op">-</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">1000</span>)]</a>
<a class="sourceLine" id="cb108-4" title="4"><span class="kw">qqplot</span>(rwR,rwC)</a>
<a class="sourceLine" id="cb108-5" title="5"><span class="kw">abline</span>(<span class="dt">a=</span><span class="dv">0</span>,<span class="dt">b=</span><span class="dv">1</span>,<span class="dt">col=</span><span class="st">&#39;black&#39;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>The dots of qqplot are located close to the diagonal lines. The random numbers generated by the two functions are similar.</p>
</div>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
